<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bifurcation Diagrams · Catalyst.jl</title><meta name="title" content="Bifurcation Diagrams · Catalyst.jl"/><meta property="og:title" content="Bifurcation Diagrams · Catalyst.jl"/><meta property="twitter:title" content="Bifurcation Diagrams · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/bifurcation_diagrams/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/bifurcation_diagrams/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/bifurcation_diagrams/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with conservation laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing model properties</a></li><li><a class="tocitem" href="../../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for performant SDE simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Model simulation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a periodic event during ODE and jump simulations</a></li></ul></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../steady_state_stability_computation/">Steady state stability computation</a></li><li class="is-active"><a class="tocitem" href>Bifurcation Diagrams</a><ul class="internal"><li><a class="tocitem" href="#Basic-example"><span>Basic example</span></a></li><li><a class="tocitem" href="#Additional-ContinuationPar-options"><span>Additional <code>ContinuationPar</code> options</span></a></li><li><a class="tocitem" href="#Bifurcation-diagrams-with-disjoint-branches"><span>Bifurcation diagrams with disjoint branches</span></a></li><li><a class="tocitem" href="#Systems-with-conservation-laws"><span>Systems with conservation laws</span></a></li><li><a class="tocitem" href="#bifurcation_kit_citation"><span>Citation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><span class="tocitem">Spatial Modelling</span><ul><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Steady state analysis</a></li><li class="is-active"><a href>Bifurcation Diagrams</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bifurcation Diagrams</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/steady_state_functionality/bifurcation_diagrams.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="bifurcation_diagrams"><a class="docs-heading-anchor" href="#bifurcation_diagrams">Bifurcation Diagrams</a><a id="bifurcation_diagrams-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams" title="Permalink"></a></h1><p>Bifurcation diagrams describe how, for a dynamical system, the quantity and type of its steady states change as a parameter is varied<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. When using Catalyst-generated models, these can be computed with the <a href="https://github.com/bifurcationkit/BifurcationKit.jl">BifurcationKit.jl</a> package. Catalyst provides a simple interface for creating BifurcationKit compatible <code>BifurcationProblem</code>s from <code>ReactionSystem</code>s.</p><p>This tutorial briefly introduces how to use Catalyst with BifurcationKit through basic examples, with BifurcationKit.jl providing <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/">a more extensive documentation</a>. Especially for more complicated systems, where careful tuning of algorithm options might be required, reading the BifurcationKit documentation is recommended. Finally, BifurcationKit provides many additional features not described here, including <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/periodicOrbit/">computation of periodic orbits</a>, <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/branchswitching/">tracking of bifurcation points along secondary parameters</a>, and <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/tutorials/tutorials/#PDEs:-bifurcations-of-equilibria">bifurcation computations for PDEs</a>.</p><h2 id="Basic-example"><a class="docs-heading-anchor" href="#Basic-example">Basic example</a><a id="Basic-example-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-example" title="Permalink"></a></h2><p>For this example, we will use a modified version of the model from Wilhelm (2009)<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> (which demonstrates a bistable switch as the parameter <span>$k1$</span> is varied). We declare the model using Catalyst:</p><pre><code class="language-julia hljs">using Catalyst
wilhelm_2009_model = @reaction_network begin
    k1, Y --&gt; 2X
    k2, 2X --&gt; X + Y
    k3, X + Y --&gt; Y
    k4, X --&gt; 0
    k5, 0 --&gt; X
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{Y} &amp;\xrightarrow{k1} 2 \mathrm{X} \\
2 \mathrm{X} &amp;\xrightarrow{k2} \mathrm{X} + \mathrm{Y} \\
\mathrm{X} + \mathrm{Y} &amp;\xrightarrow{k3} \mathrm{Y} \\
\mathrm{X} &amp;\xrightleftharpoons[k5]{k4} \varnothing  
 \end{align*}
 \]</p><p>Next we will create a <code>BifurcationProblem</code>. In addition to the <code>ReactionSystem</code>, we need to provide:</p><ul><li>The bifurcation parameter (the parameter which is varied in the bifurcation diagram).</li><li>A full model parameter set. This includes the values of all non-bifurcation parameters, but also a value for the bifurcation parameter (which corresponds to the point in parameter space from which the computation of the bifurcation diagram starts).</li><li>An initial guess of the steady state values of the system at the provided parameter set. Using this point as a starting guess for root finding, BifurcationKit calculates an initial steady state from which to compute the bifurcation diagram. Hence, this guess does not need to be very exact (but may be important if the system exhibits multistability for the initial parameter set).</li><li>The species or statistic we wish to plot on the y-axis of the bifurcation diagram (a custom value can be provided by using the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/periodicOrbit/#.-record*from*solution"><code>record_from_solution</code> argument</a>).</li></ul><p>We combine all this information to form a <code>BifurcationProblem</code>:</p><pre><code class="language-julia hljs">using BifurcationKit
bif_par = :k1
u_guess = [:X =&gt; 5.0, :Y =&gt; 2.0]
p_start = [:k1 =&gt; 4.0, :k2 =&gt; 1.0, :k3 =&gt; 1.0, :k4 =&gt; 1.5, :k5 =&gt; 1.25]
plot_var = :X
bprob = BifurcationProblem(wilhelm_2009_model, u_guess, p_start, bif_par; plot_var=plot_var)</code></pre><p>BifurcationKit computes bifurcation diagrams using the <code>bifurcationdiagram</code> function. From an initial point in the diagram, it tracks the solution (using a continuation algorithm) until the entire diagram is computed (BifurcationKit&#39;s continuation can be used for other purposes, however, this tutorial focuses on bifurcation diagram computation). The continuation settings are provided in a <code>ContinuationPar</code> structure. In this example, we will only specify three settings, <code>p_min</code> and <code>p_max</code> (which sets the minimum and maximum values over which the bifurcation parameter is varied) and <code>max_steps</code> (the maximum number of continuation steps to take as the bifurcation diagram is tracked). We wish to compute a bifurcation diagram over the interval <span>$(2.0,20.0)$</span>, and will use the following settings:</p><pre><code class="language-julia hljs">p_span = (2.0, 20.0)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2], max_steps = 1000)</code></pre><p>Finally, we compute our bifurcation diagram using:</p><pre><code class="language-julia hljs">bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: The zero eigenvalue is not that small λ = 0.0003058989598159201, this can alter the computation of the normal form. You can either refine the point using Newton or use a more precise bisection by increasing `n_inversion`
└ @ BifurcationKit ~/.julia/packages/BifurcationKit/2LYxR/src/NormalForms.jl:82
┌ Warning: The zero eigenvalue is not that small λ = -0.0004419833772875137, this can alter the computation of the normal form. You can either refine the point using Newton or use a more precise bisection by increasing `n_inversion`
└ @ BifurcationKit ~/.julia/packages/BifurcationKit/2LYxR/src/NormalForms.jl:82</code></pre><p>Where <code>PALC()</code> designates that we wish to use the pseudo arclength continuation method to track our solution. The third argument (<code>2</code>) designates the maximum number of recursions when branches of branches are computed (branches appear as continuation encounters certain bifurcation points). For diagrams with highly branched structures (rare for many common small chemical reaction networks) this input is important. Finally, <code>bothside = true</code> designates that we wish to perform continuation on both sides of the initial point (which is typically the case). </p><p>We can plot our bifurcation diagram using the Plots.jl package:</p><pre><code class="language-julia hljs">using Plots
plot(bif_dia; xguide = &quot;k1&quot;, yguide = &quot;X&quot;)</code></pre><img src="6c6a3c32.svg" alt="Example block output"/><p>Here, the steady state concentration of <span>$X$</span> is shown as a function of <span>$k1$</span>&#39;s value. Stable steady states are shown with thick lines, unstable ones with thin lines. The two <a href="https://en.wikipedia.org/wiki/Saddle-node_bifurcation">fold bifurcation points</a> are marked with &quot;bp&quot;.</p><h2 id="Additional-ContinuationPar-options"><a class="docs-heading-anchor" href="#Additional-ContinuationPar-options">Additional <code>ContinuationPar</code> options</a><a id="Additional-ContinuationPar-options-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-ContinuationPar-options" title="Permalink"></a></h2><p>Most of the options required by the <code>bifurcationdiagram</code> function are provided through the <code>ContinuationPar</code> structure. For full details, please read the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/library/#BifurcationKit.ContinuationPar">BifurcationKit documentation</a>. However, a few common options, and how they affect the continuation computation, are described here:</p><ul><li><code>p_min</code> and <code>p_max</code>: Set the interval over which the bifurcation diagram is computed (with the continuation stopping if it reaches these bounds).</li><li><code>dsmin</code> and <code>dsmax</code>: The minimum and maximum length of the continuation steps (in the bifurcation parameter&#39;s value).</li><li><code>max_steps</code>: The maximum number of continuation steps. If a bifurcation diagram looks incomplete, try increasing this value.</li><li><code>newton_options</code>: Options for the Newton&#39;s method that BifurcationKit uses to find steady states. This can be created using <code>NewtonPar(tol = 1e-9, max_iterations = 100)</code> which here sets the tolerance (to <code>1e-9</code>) and the maximum number of newton iterations (to <code>100</code>).</li></ul><p>The previous bifurcation diagram can be computed, with these various options specified, in the following way:</p><pre><code class="language-julia hljs">p_span = (2.0, 20.0)
opt_newton = NewtonPar(tol = 1e-9, max_iterations = 1000)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2],
                          dsmin = 0.001, dsmax = 0.01, max_steps = 1000,
                          newton_options = opt_newton)
bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: The zero eigenvalue is not that small λ = 0.0014295322015436263, this can alter the computation of the normal form. You can either refine the point using Newton or use a more precise bisection by increasing `n_inversion`
└ @ BifurcationKit ~/.julia/packages/BifurcationKit/2LYxR/src/NormalForms.jl:82</code></pre><p>(however, in this case these additional settings have no significant effect on the result)</p><h2 id="Bifurcation-diagrams-with-disjoint-branches"><a class="docs-heading-anchor" href="#Bifurcation-diagrams-with-disjoint-branches">Bifurcation diagrams with disjoint branches</a><a id="Bifurcation-diagrams-with-disjoint-branches-1"></a><a class="docs-heading-anchor-permalink" href="#Bifurcation-diagrams-with-disjoint-branches" title="Permalink"></a></h2><p>Let&#39;s consider the previous case, but instead compute the bifurcation diagram over the interval <span>$(2.0,15.0)$</span>:</p><pre><code class="language-julia hljs">p_span = (2.0, 15.0)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2], max_steps = 1000)
bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)
plot(bif_dia; xguide = &quot;k1&quot;, yguide = &quot;X&quot;)</code></pre><img src="dae63afe.svg" alt="Example block output"/><p>Here, in the bistable region, we only see a single branch. The reason is that the continuation algorithm starts at our initial guess (here made at <span>$k1 = 4.0$</span> for <span>$(X,Y) = (5.0,2.0)$</span>) and tracks the diagram from there. However, with the upper bound set at <span>$k1=15.0$</span> the bifurcation diagram has a disjoint branch structure, preventing the full diagram from being computed by continuation alone. In this case it could be solved by increasing the bound from <span>$k1=15.0$</span>, however, this is not possible in all cases. In these cases, <em>deflation</em> can be used. This is described in the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/tutorials/tutorials2/#Snaking-computed-with-deflation">BifurcationKit documentation</a>.</p><h2 id="Systems-with-conservation-laws"><a class="docs-heading-anchor" href="#Systems-with-conservation-laws">Systems with conservation laws</a><a id="Systems-with-conservation-laws-1"></a><a class="docs-heading-anchor-permalink" href="#Systems-with-conservation-laws" title="Permalink"></a></h2><p>Some systems are under-determined at steady state, so that for a given parameter set they have an infinite number of possible steady state solutions, preventing bifurcation diagrams from being computed. Similar to when we <a href="../homotopy_continuation/#homotopy_continuation_conservation_laws">compute steady states for fixed parameter values</a>, we can utilise Catalyst&#39;s ability to detect and eliminate conservation laws to resolve this issue. This requires us to provide information of the species concentrations at which we wish to compute the bifurcation diagram (to determine the values of conserved quantities). These are provided to the <code>BifurcationProblem</code> using the <code>u0</code> argument.</p><p>To illustrate this, we will create a simple model of a kinase that is produced and degraded (at rates <span>$p$</span> and <span>$d$</span>). The kinase facilitates the phosphorylation of a protein (<span>$X$</span>), which is dephosphorylated at a constant rate. For this system, we will compute a bifurcation diagram, showing how the concentration of the phosphorylated protein (<span>$Xp$</span>) depends on the degradation rate of the kinase (<span>$d$</span>). We will set the total amount of protein (<span>$X+Xp$</span>) to <span>$1.0$</span>.</p><pre><code class="language-julia hljs">using BifurcationKit, Catalyst, Plots
kinase_model = @reaction_network begin
    (p, d), 0 &lt;--&gt; K
    (K*kP,kD), X &lt;--&gt; Xp
end

u_guess = [:K =&gt; 1.0, :X =&gt; 1.0, :Xp =&gt; 1.0]
p_start = [:p =&gt; 1.0, :d =&gt; 0.5, :kP =&gt; 2.0, :kD =&gt; 5.0]
u0 = [:X =&gt; 1.0, :Xp =&gt; 0.0]
bprob = BifurcationProblem(kinase_model, u_guess, p_start, :d; plot_var = :Xp, u0)

p_span = (0.1, 10.0)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2], max_steps = 1000)
bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)
plot(bif_dia; xguide = &quot;d&quot;, yguide = &quot;Xp&quot;)</code></pre><img src="357735cd.svg" alt="Example block output"/><p>This bifurcation diagram does not contain any interesting features (such as bifurcation points), and only shows how the steady state concentration of <span>$Xp$</span> is reduced as <span>$d$</span> increases. </p><p>Finally, for additional clarity, we reiterate the purpose of the two <code>u</code> arguments used:</p><ul><li><code>u_guess</code>: A guess of the initial steady states (which BifurcationKit uses to find its starting point). Typically, most trivial guesses work (e.g. setting all species concentrations to <code>1.0</code>). <code>u_guess</code> <em>does not</em> have to fulfill the conserved concentrations provided in <code>u0</code>.</li><li><code>u0</code>: Used to compute the concentrations of any conserved quantities (e.g. in our example <span>$X + Xp = 1.0$</span>). Technically, values are only required for species that are involved in conservation laws (in our case we do not need to provide a value for <span>$K$</span>). However, sometimes determining which species are actually involved in conservation laws can be difficult, and it might be easier to simply provide concentrations for all species.</li></ul><hr/><h2 id="bifurcation_kit_citation"><a class="docs-heading-anchor" href="#bifurcation_kit_citation">Citation</a><a id="bifurcation_kit_citation-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_kit_citation" title="Permalink"></a></h2><p>If you use this functionality in your research, please cite the following paper to support the author of the BifurcationKit package:</p><pre><code class="nohighlight hljs">@misc{veltz:hal-02902346,
  title = {{BifurcationKit.jl}},
  author = {Veltz, Romain},
  url = {https://hal.archives-ouvertes.fr/hal-02902346},
  institution = {{Inria Sophia-Antipolis}},
  year = {2020},
  month = Jul,
  keywords = {pseudo-arclength-continuation ; periodic-orbits ; floquet ; gpu ; bifurcation-diagram ; deflation ; newton-krylov},
  pdf = {https://hal.archives-ouvertes.fr/hal-02902346/file/354c9fb0d148262405609eed2cb7927818706f1f.tar.gz},
  hal_id = {hal-02902346},
  hal_version = {v1},
}</code></pre><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://link.springer.com/book/10.1007/978-3-031-22007-4">Yuri A. Kuznetsov, <em>Elements of Applied Bifurcation Theory</em>, Springer (2023).</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://bmcsystbiol.biomedcentral.com/articles/10.1186/1752-0509-3-90">Thomas Wilhelm, <em>The smallest chemical reaction system with bistability</em>, BMC Systems Biology (2009).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../steady_state_stability_computation/">« Steady state stability computation</a><a class="docs-footer-nextpage" href="../dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 22 July 2024 23:27">Monday 22 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
