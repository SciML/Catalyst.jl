<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Chemical Reaction Network Theory · Catalyst.jl</title><meta name="title" content="Chemical Reaction Network Theory · Catalyst.jl"/><meta property="og:title" content="Chemical Reaction Network Theory · Catalyst.jl"/><meta property="twitter:title" content="Chemical Reaction Network Theory · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/network_analysis/crn_theory/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/network_analysis/crn_theory/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/network_analysis/crn_theory/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Coupled ODEs, Algebraic Equations, and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with Conservation Laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stoichiometries</a></li><li><a class="tocitem" href="../../model_creation/functional_parameters/">Inputs and time-dependent (or functional) parameters</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing Model Properties</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related Functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, Generative, Modelling of a Linear Pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/noise_modelling_approaches/">Approaches for modelling system noise</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation Plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for Performant ODE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for Performant SDE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/finite_state_projection_simulation/">Solving the chemical master equation using FiniteStateProjection.jl</a></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a Periodic Event During ODE and Jump Simulations</a></li><li><a class="tocitem" href="../../model_simulation/examples/activation_time_distribution_measurement/">Measuring the Distribution of System Activation Times</a></li><li><a class="tocitem" href="../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Network Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../odes/">Decomposing the Reaction Network ODEs</a></li><li class="is-active"><a class="tocitem" href>Chemical Reaction Network Theory</a><ul class="internal"><li><a class="tocitem" href="#network_analysis_structural_aspects_linkage"><span>Linkage classes and sub-networks of the reaction network</span></a></li><li><a class="tocitem" href="#network_analysis_structural_aspects_deficiency"><span>Deficiency of the network</span></a></li><li><a class="tocitem" href="#network_analysis_structural_aspects_reversibility"><span>Reversibility of the network</span></a></li><li><a class="tocitem" href="#network_analysis_structural_aspects_deficiency_zero_theorem"><span>Deficiency Zero Theorem</span></a></li><li><a class="tocitem" href="#Deficiency-One-Theorem"><span>Deficiency One Theorem</span></a></li><li><a class="tocitem" href="#network_analysis_complex_and_detailed_balance"><span>Complex and Detailed Balance</span></a></li><li><a class="tocitem" href="#network_analysis_concentration_robustness"><span>Concentration Robustness</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../network_properties/">Caching of Network Properties in <code>ReactionSystems</code></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing Model Steady State Properties with DynamicalSystems.jl</a></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/examples/nullcline_plotting/">Plotting Nullclines and Steady States in Phase Space</a></li><li><a class="tocitem" href="../../steady_state_functionality/examples/bifurcationkit_periodic_orbits/">Computing Periodic Orbits (Oscillations) Using BifurcationKit.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/examples/bifurcationkit_codim2/">Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for Non-data Fitting Purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial Jump Simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/core_api/">Catalyst.jl API</a></li><li><a class="tocitem" href="../../api/network_analysis_api/">Network analysis and representations</a></li></ul></li><li><a class="tocitem" href="../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Network Analysis</a></li><li class="is-active"><a href>Chemical Reaction Network Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Chemical Reaction Network Theory</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/network_analysis/crn_theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="network_analysis_structural_aspects"><a class="docs-heading-anchor" href="#network_analysis_structural_aspects">Chemical Reaction Network Theory</a><a id="network_analysis_structural_aspects-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_structural_aspects" title="Permalink"></a></h1><p>The systems of ODEs or stochastic chemical kinetics models that arise from chemical reaction networks can often have their steady-state properties (number of steady states, etc.) known in advance, simply by analyzing the graph structure of the network. The subfield of chemistry and math studying this relationship is called <a href="https://en.wikipedia.org/wiki/Chemical_reaction_network_theory">Chemical Reaction Network Theory</a>.</p><p>In this tutorial we give a broad overview of chemical reaction network theory, building on the discussion of the structure of  the reaction network ODEs in the previous section. We also introduce several of the Catalyst API functions for network analysis. A complete summary of the exported functions is given in the API section <a href="../../api/network_analysis_api/#api_network_analysis">Network Analysis and Representations</a>.</p><p>Broadly, results from chemical reaction network theory relate a purely graph-structural property (e.g. <a href="#network_analysis_structural_aspects_deficiency">deficiency</a>) to dynamical properties of the reaction system (e.g. <a href="#network_analysis_complex_and_detailed_balance">complex balance</a>). The relevant graph here is the one corresponding to the <a href="../odes/#network_analysis_reaction_complexes">reaction complex representation</a> of the network, where the nodes represent the reaction complexes and the edges represent reactions. Let us illustrate some of the types of network properties that  Catalyst can determine.</p><p>To begin, consider the following reaction network:</p><pre><code class="language-julia hljs">using Catalyst
rn = @reaction_network begin
    (k1,k2), A + B &lt;--&gt; C
    k3, C --&gt; D+E
    (k4,k5), D+E &lt;--&gt; F
    (k6,k7), 2A &lt;--&gt; B+G
    k8, B+G --&gt; H
    k9, H --&gt; 2A
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{A} + \mathrm{B} &amp;\xrightleftharpoons[\mathtt{k2}]{\mathtt{k1}} \mathrm{C} \\
\mathrm{C} &amp;\xrightarrow{\mathtt{k3}} \mathrm{D} + \mathrm{E} \\
\mathrm{D} + \mathrm{E} &amp;\xrightleftharpoons[\mathtt{k5}]{\mathtt{k4}} \mathrm{F} \\
2 \mathrm{A} &amp;\xrightleftharpoons[\mathtt{k7}]{\mathtt{k6}} \mathrm{B} + \mathrm{G} \\
\mathrm{B} + \mathrm{G} &amp;\xrightarrow{\mathtt{k8}} \mathrm{H} \\
\mathrm{H} &amp;\xrightarrow{\mathtt{k9}} 2 \mathrm{A}  
 \end{align*}
 \]</p><p>with graph</p><pre><code class="language-julia hljs">using CairoMakie, GraphMakie, NetworkLayout
plot_complexes(rn)</code></pre><img src="7c79080b.png" alt="Example block output"/><h2 id="network_analysis_structural_aspects_linkage"><a class="docs-heading-anchor" href="#network_analysis_structural_aspects_linkage">Linkage classes and sub-networks of the reaction network</a><a id="network_analysis_structural_aspects_linkage-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_structural_aspects_linkage" title="Permalink"></a></h2><p>The preceding reaction complex graph shows that <code>rn</code> is composed of two disconnected sub-graphs, one containing the complexes <span>$A+B$</span>, <span>$C$</span>, <span>$D+E$</span>, and <span>$F$</span>, the other containing the complexes <span>$2A$</span>, <span>$B + G$</span>, and <span>$H$</span>. These sets, <span>$\{A+B, C, D+E, F\}$</span> and <span>$\{2A, B + G,H\}$</span> are called the &quot;linkage classes&quot; of the reaction network. The function <a href="../../api/network_analysis_api/#Catalyst.linkageclasses"><code>linkageclasses</code></a> will calculate these for a given network, returning a vector of the integer indices of reaction complexes participating in each set of linkage-classes. Note, indices of reaction complexes can be determined from the ordering returned by <a href="../../api/network_analysis_api/#Catalyst.reactioncomplexes"><code>reactioncomplexes</code></a>.</p><pre><code class="language-julia hljs"># we must first calculate the reaction complexes -- they are cached in rn
reactioncomplexes(rn)

# now we can calculate the linkage classes
lcs = linkageclasses(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Vector{Int64}}:
 [1, 2, 3, 4]
 [5, 6, 7]</code></pre><p>It can often be convenient to obtain the disconnected sub-networks as distinct <code>ReactionSystem</code>s, which are returned by the <a href="../../api/network_analysis_api/#Catalyst.subnetworks"><code>subnetworks</code></a> function:</p><pre><code class="language-julia hljs">subnets = subnetworks(rn)

# check the reactions in each subnetwork
reactions.(subnets)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Vector{Reaction}}:
 [k1, A + B --&gt; C, k2, C --&gt; A + B, k3, C --&gt; D + E, k4, D + E --&gt; F, k5, F --&gt; D + E]
 [k6, 2*A --&gt; B + G, k7, B + G --&gt; 2*A, k8, B + G --&gt; H, k9, H --&gt; 2*A]</code></pre><p>The graphs of the reaction complexes in the two sub-networks are then</p><pre><code class="language-julia hljs">  plot_complexes(subnets[1])</code></pre><img src="76443182.png" alt="Example block output"/><p>and,</p><pre><code class="language-julia hljs"> plot_complexes(subnets[2])</code></pre><img src="7967de17.png" alt="Example block output"/><h2 id="network_analysis_structural_aspects_deficiency"><a class="docs-heading-anchor" href="#network_analysis_structural_aspects_deficiency">Deficiency of the network</a><a id="network_analysis_structural_aspects_deficiency-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_structural_aspects_deficiency" title="Permalink"></a></h2><p>A famous theorem in Chemical Reaction Network Theory, the Deficiency Zero Theorem<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup>, allows us to use knowledge of the net stoichiometry matrix and the linkage classes of a <em>mass action</em> <a href="../odes/#network_analysis_matrix_vector_representation">RRE ODE system</a> to draw conclusions about the system&#39;s possible steady states. In this section we&#39;ll see how Catalyst can calculate a network&#39;s deficiency.</p><p>The rank, <span>$r$</span>, of a reaction network is defined as the dimension of the subspace spanned by the net stoichiometry vectors of the reaction-network<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup>, i.e. the span of the columns of the net stoichiometry matrix <code>N</code>. It corresponds to the number of independent species in a chemical reaction network. That is, if we calculate the linear conservation laws of a network, and use them to eliminate the dependent species of the network, we will have <span>$r$</span> independent species remaining. For our current example the conservation laws are given by</p><pre><code class="language-julia hljs"># first we calculate the conservation laws -- they are cached in rn
conservationlaws(rn)

# then we display them as equations for the dependent variables
conservedequations(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Equation}:
 E(t) ~ D(t) + Γ[1]
 G(t) ~ B(t) + D(t) + C(t) + F(t) + Γ[2]
 H(t) ~ -B(t) - 1.5D(t) - 0.5A(t) - 1.5C(t) - 1.5F(t) + Γ[3]</code></pre><p>Here the parameters <code>Γ[i]</code> represent the constants of the three conservation laws, and we see that there are three dependent species that could be eliminated. As</p><pre><code class="language-julia hljs">numspecies(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8</code></pre><p>we find that there are five independent species. Let&#39;s check this is correct:</p><pre><code class="language-julia hljs">using LinearAlgebra
rank(netstoichmat(rn)) == 5</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>So we know that the rank of our reaction network is five. An extended section discussing how to utilise conservation law elimination during chemical reaction network modelling can be found <a href="../../model_creation/conservation_laws/#conservation_laws">here</a>.</p><p>The deficiency, <span>$\delta$</span>, of a reaction network is defined as</p><p class="math-container">\[\delta = \textrm{(number of complexes)} - \textrm{(number of linkage classes)} - \textrm{(rank)}.\]</p><p>For our network this is <span>$7 - 2 - 5 = 0$</span>, which we can calculate in Catalyst as</p><pre><code class="language-julia hljs"># first we calculate the reaction complexes of rn and cache them in rn
reactioncomplexes(rn)

# then we can calculate the deficiency
δ = deficiency(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0</code></pre><p>Quoting Feinberg <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup></p><blockquote><p>Deficiency zero networks are ones for which the reaction vectors [i.e. net stoichiometry vectors] are as independent as the partition of complexes into linkage classes will allow.</p></blockquote><h2 id="network_analysis_structural_aspects_reversibility"><a class="docs-heading-anchor" href="#network_analysis_structural_aspects_reversibility">Reversibility of the network</a><a id="network_analysis_structural_aspects_reversibility-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_structural_aspects_reversibility" title="Permalink"></a></h2><p>A reaction network is <em>reversible</em> if the &quot;arrows&quot; of the reactions are symmetric so that every reaction is accompanied by its reverse reaction. Catalyst&#39;s API provides the <a href="../../api/network_analysis_api/#Catalyst.isreversible"><code>isreversible</code></a> function to determine whether a reaction network is reversible. As an example, consider</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  (k1,k2),A &lt;--&gt; B
  (k3,k4),A + C &lt;--&gt; D
  (k5,k6),D &lt;--&gt; B+E
  (k7,k8),B+E &lt;--&gt; A+C
end

# calculate the set of reaction complexes
reactioncomplexes(rn)

# test if the system is reversible
isreversible(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Consider another example,</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  (k1,k2),A &lt;--&gt; B
  k3, A + C --&gt; D
  k4, D --&gt; B+E
  k5, B+E --&gt; A+C
end
reactioncomplexes(rn)
isreversible(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><pre><code class="language-julia hljs">plot_complexes(rn)</code></pre><img src="d21005ee.png" alt="Example block output"/><p>It is evident from the preceding graph that the network is not reversible. However, it satisfies a weaker property in that there is a path from each reaction complex back to itself within its associated subgraph. This is known as <em>weak reversibility</em>. One can test a network for weak reversibility by using the <a href="../../api/network_analysis_api/#Catalyst.isweaklyreversible"><code>isweaklyreversible</code></a> function:</p><pre><code class="language-julia hljs"># need subnetworks from the reaction network first
subnets = subnetworks(rn)
isweaklyreversible(rn, subnets)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Every reversible network is also weakly reversible, but not every weakly reversible network is reversible.</p><h2 id="network_analysis_structural_aspects_deficiency_zero_theorem"><a class="docs-heading-anchor" href="#network_analysis_structural_aspects_deficiency_zero_theorem">Deficiency Zero Theorem</a><a id="network_analysis_structural_aspects_deficiency_zero_theorem-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_structural_aspects_deficiency_zero_theorem" title="Permalink"></a></h2><p>Knowing the deficiency and weak reversibility of a mass action chemical reaction network ODE model allows us to make inferences about the corresponding steady state behavior. Before illustrating how this works for one example, we need one last definition.</p><p>Recall that in the matrix-vector representation for the RRE ODEs, the entries, <span>$N_{m k}$</span>, of the stoichiometry matrix, <span>$N$</span>, give the net change in species <span>$m$</span> due to reaction <span>$k$</span>. If we let <span>$\mathbf{N}_k$</span> denote the <span>$k$</span>th column of this matrix, this vector corresponds to the change in the species state vector, <span>$\mathbf{x}(t)$</span>, due to reaction <span>$k$</span>, i.e. when reaction <span>$k$</span> occurs <span>$\mathbf{x}(t) \to \mathbf{x}(t) + \mathbf{N}_k$</span>. Moreover, by integrating the ODE</p><p class="math-container">\[\frac{d\mathbf{x}}{dt} = N \mathbf{v}(\mathbf{x}(t)) = \sum_{k=1}^{K} v_k(\mathbf{x}(t)) \, \mathbf{N}_k\]</p><p>we find</p><p class="math-container">\[\mathbf{x}(t) = \mathbf{x}(0) + \sum_{k=1}^K \left(\int_0^t v_k(\mathbf{x})(s) \, ds\right) \mathbf{N}_k,\]</p><p>which demonstrates that <span>$\mathbf{x}(t) - \mathbf{x}(0)$</span> is always given by a linear combination of the stoichiometry vectors, i.e.</p><p class="math-container">\[\mathbf{x}(t) - \mathbf{x}(0) \in \operatorname{span}\{\mathbf{N}_k \}.\]</p><p>In particular, this says that <span>$\mathbf{x}(t)$</span> lives in the translation of the <span>$\operatorname{span}\{\mathbf{N}_k \}$</span> by <span>$\mathbf{x}(0)$</span> which we write as <span>$(\mathbf{x}(0) + \operatorname{span}\{\mathbf{N}_k\})$</span>. In fact, since the solution should stay non-negative, if we let <span>$\bar{\mathbb{R}}_+^{M}$</span> denote the subset of vectors in <span>$\mathbb{R}^{M}$</span> with non-negative components, the possible physical values for the solution, <span>$\mathbf{x}(t)$</span>, must be in the set</p><p class="math-container">\[(\mathbf{x}(0) + \operatorname{span}\{\mathbf{N}_k\}) \cap \bar{\mathbb{R}}_+^{M}.\]</p><p>This set is called the stoichiometric compatibility class of <span>$\mathbf{x}(t)$</span>. The key property of stoichiometric compatibility classes is that they are invariant under the RRE ODE&#39;s dynamics, i.e. a solution will always remain within the subspace given by the stoichiometric compatibility class. Finally, we note that the <em>positive</em> stoichiometric compatibility class generated by <span>$\mathbf{x}(0)$</span> is just <span>$(\mathbf{x}(0) + \operatorname{span}\{\mathbf{N}_k\}) \cap \mathbb{R}_+^{M}$</span>, where <span>$\mathbb{R}_+^{M}$</span> denotes the vectors in <span>$\mathbb{R}^M$</span> with strictly positive components.</p><p>With these definitions we can now see how knowing the deficiency and weak reversibility of the network can tell us about its steady state behavior. Consider the previous example, which we know is weakly reversible. Its deficiency is</p><pre><code class="language-julia hljs">deficiency(rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0</code></pre><p>We also verify that the system is purely mass action (though it is apparent from the network&#39;s definition):</p><pre><code class="language-julia hljs">all(rx -&gt; ismassaction(rx, rn), reactions(rn))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>We can therefore apply the Deficiency Zero Theorem to draw conclusions about the system&#39;s steady state behavior. The Deficiency Zero Theorem (roughly) says that a mass action network with deficiency zero satisfies</p><ol><li>If the network is weakly reversible, then independent of the reaction rate constants the RRE ODEs have exactly one equilibrium solution within each positive stoichiometric compatibility class. That equilibrium is locally asymptotically stable.</li><li>If the network is not weakly reversible, then the RRE ODEs cannot admit a positive equilibrium solution.</li></ol><p>See <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup> for a more precise statement, proof, and additional examples.</p><p>We can therefore conclude that for any initial condition that is positive, and hence in some positive stoichiometric compatibility class, <code>rn</code> will have exactly one equilibrium solution which will be positive and locally asymptotically stable.</p><p>As a final example, consider the following network from <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup></p><pre><code class="language-julia hljs">def0_rn = @reaction_network begin
  (k1,k2),A &lt;--&gt; 2B
  (k3,k4), A + C &lt;--&gt; D
  k5, B+E --&gt; C + D
end
reactioncomplexes(def0_rn)
subnets = subnetworks(def0_rn)
isma = all(rx -&gt; ismassaction(rx,def0_rn), reactions(def0_rn))
def = deficiency(def0_rn)
iswr = isweaklyreversible(def0_rn, subnets)
isma,def,iswr</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(true, 0, false)</code></pre><p>which we see is mass action and has deficiency zero, but is not weakly reversible. As such, we can conclude that for any choice of rate constants the RRE ODEs cannot have a positive equilibrium solution.</p><p>There is an API function <a href="../../api/network_analysis_api/#Catalyst.satisfiesdeficiencyzero"><code>satisfiesdeficiencyzero</code></a> that will let us check all these conditions easily:</p><pre><code class="language-julia hljs">satisfiesdeficiencyzero(def0_rn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><h2 id="Deficiency-One-Theorem"><a class="docs-heading-anchor" href="#Deficiency-One-Theorem">Deficiency One Theorem</a><a id="Deficiency-One-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Deficiency-One-Theorem" title="Permalink"></a></h2><p>Very analogous to the deficiency zero theorem is the deficiency one theorem. The deficiency one theorem applies to a network with the following properties: </p><ol><li>The deficiency of each <em>linkage class</em> of the network is at most 1, </li><li>The sum of the linkage class deficiencies is the total deficiency of the network, and</li><li>Each linkage class has at most one terminal linkage class, which is a linkage class that is 1) strongly connected, and 2) has no outgoing reactions.</li></ol><p>For the set of reactions <span>$A \to B, B \to A, B \to C$</span>, <span>$\{A, B, C\}$</span> is a linkage class, and <span>$\{A, B\}$</span> is a strong linkage class (since A is reachable from B and vice versa). However, <span>$\{A, B\}$</span> is not a terminal linkage class, because the reaction <span>$B \to C$</span> goes to a complex outside the linkage class. </p><p>If these conditions are met, then the network will have at most one steady state in each  stoichiometric compatibility class for any choice of rate constants and parameters. Unlike  the deficiency zero theorem, networks obeying the deficiency one theorem are not guaranteed  to have stable solutions.</p><p>Let&#39;s look at an example network.</p><pre><code class="language-julia hljs">def1_network = @reaction_network begin
    (k1, k2), A &lt;--&gt; 2B
    k3, C --&gt; 2D
    k4, 2D --&gt; C + E
    (k5, k6), C + E &lt;--&gt; E + 2D
end
plot_complexes(def1_network)</code></pre><img src="cab67e8e.png" alt="Example block output"/><p>We can see from the complex graph that there are two linkage classes, the deficiency of the bottom one is zero and the deficiency of the top one is one. The total deficiency is one:</p><pre><code class="language-julia hljs">deficiency(def1_network)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><p>And there is only one terminal linkage class in each, so our network satisfies all three conditions. As in the deficiency zero case, there is the API function <a href="../../api/network_analysis_api/#Catalyst.satisfiesdeficiencyone"><code>satisfiesdeficiencyone</code></a> for quickly checking these conditions:</p><pre><code class="language-julia hljs">satisfiesdeficiencyone(def1_network)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="network_analysis_complex_and_detailed_balance"><a class="docs-heading-anchor" href="#network_analysis_complex_and_detailed_balance">Complex and Detailed Balance</a><a id="network_analysis_complex_and_detailed_balance-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_complex_and_detailed_balance" title="Permalink"></a></h2><p>A reaction network&#39;s steady state is <strong>complex-balanced</strong> if the total production of each  <em>complex</em> is zero at the steady state. A reaction network&#39;s steady state is <strong>detailed balanced</strong>  if every reaction is balanced by its reverse reaction at the steady-state (this corresponds to  the usual notion of chemical equilibrium; note that this requires every reaction be reversible). </p><p>Note that detailed balance at a given steady state implies complex balance for that steady state, i.e. detailed balance is a stronger property than complex balance.</p><p>Remarkably, having just one positive steady state that is complex (detailed) balance implies that  complex (detailed) balance holds for <em>every</em> positive steady state, so we say that a network  is complex (detailed) balanced if any one of its steady states are complex (detailed) balanced.  Additionally, there will be exactly one steady state in every positive stoichiometric  compatibility class, and this steady state is asymptotically stable. (For proofs of these results, please consult Martin Feinberg&#39;s <em>Foundations of Chemical Reaction Network Theory</em><sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup>). So  knowing that a network is complex balanced is really quite powerful.</p><p>Let&#39;s check whether the deficiency 0 reaction network that we defined above is complex balanced by providing a set of rates:</p><pre><code class="language-julia hljs">rates = Dict([:k1 =&gt; 2.4, :k2 =&gt; 4., :k3 =&gt; 10., :k4 =&gt; 5.5, :k5 =&gt; 0.4])
iscomplexbalanced(rn, rates)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>We can do a similar check for detailed balance.</p><pre><code class="language-julia hljs">isdetailedbalanced(rn, rates)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>The reason that the deficiency zero theorem puts such strong restrictions on the steady state  properties of the reaction network is because it implies that the reaction network will be  complex balanced for any set of rate constants and parameters. The fact that this holds  from a purely structural property of the graph, regardless of kinetics, is what makes it so  useful. But in some cases it might be desirable to check complex balance on its own, as for  higher deficiency networks.</p><article><details class="docstring" open="true"><summary id="Catalyst.iscomplexbalanced-network_analysis-crn_theory"><a class="docstring-binding" href="#Catalyst.iscomplexbalanced-network_analysis-crn_theory"><code>Catalyst.iscomplexbalanced</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">iscomplexbalanced(rs::ReactionSystem, parametermap; sparse = false)</code></pre><p>Constructively compute whether a network will have complex-balanced equilibrium solutions, following the method in van der Schaft et al., <a href="https://link.springer.com/article/10.1007/s10910-015-0498-2#Sec3">2015</a>.</p><p>Requires the specification of values for the parameters/rate constants. Accepts a dictionary, vector, or tuple of parameter-to-value mappings, e.g. [k1 =&gt; 1.0, k2 =&gt; 2.0,...].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/Catalyst.jl/blob/59bde519c41fcbb38862944d2b141ed6125b87d1/src/network_analysis.jl#L1013-L1020">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Catalyst.isdetailedbalanced-network_analysis-crn_theory"><a class="docstring-binding" href="#Catalyst.isdetailedbalanced-network_analysis-crn_theory"><code>Catalyst.isdetailedbalanced</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">isdetailedbalanced(rs::ReactionSystem, parametermap; reltol=1e-9, abstol)</code></pre><p>Constructively compute whether a kinetic system (a reaction network with a set of rate constants) will admit detailed-balanced equilibrium solutions, using the Wegscheider conditions, <a href="https://www.sciencedirect.com/science/article/pii/0009250989851243">Feinberg, 1989</a>. A detailed-balanced solution is one for which the rate of every forward reaction exactly equals its reverse reaction. Accepts a dictionary, vector, or tuple of variable-to-value mappings, e.g. [k1 =&gt; 1.0, k2 =&gt; 2.0,...].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/Catalyst.jl/blob/59bde519c41fcbb38862944d2b141ed6125b87d1/src/network_analysis.jl#L933-L938">source</a></section></details></article><h2 id="network_analysis_concentration_robustness"><a class="docs-heading-anchor" href="#network_analysis_concentration_robustness">Concentration Robustness</a><a id="network_analysis_concentration_robustness-1"></a><a class="docs-heading-anchor-permalink" href="#network_analysis_concentration_robustness" title="Permalink"></a></h2><p>Certain reaction networks have species that do not change their concentration, regardless of whether the system is perturbed to a different stoichiometric compatibility class. This is a very useful property to have in biological contexts, where it might be important to keep the concentration of a critical species relatively stable in the face of changes in its environment. </p><p>Determining every species with concentration-robustness in a network is in general very difficult. However, there are certain cases where there are sufficient conditions that can be checked relatively easily. One example is for deficiency one networks.</p><p><strong>Theorem (a sufficient condition for concentration robustness for deficiency one networks)</strong>: If there are two <em>non-terminal</em> reaction complexes that differ only in species <span>$s$</span>, then the system is absolutely concentration robust with respect to <span>$s$</span>. </p><p>This is the check provided by the API function <code>robustspecies(rn)</code>. More general concentration robustness analysis can be done using the forthcoming CatalystNetworkAnalysis package.</p><article><details class="docstring" open="true"><summary id="Catalyst.robustspecies-network_analysis-crn_theory"><a class="docstring-binding" href="#Catalyst.robustspecies-network_analysis-crn_theory"><code>Catalyst.robustspecies</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">robustspecies(rn::ReactionSystem)

Return a vector of indices corresponding to species that are concentration robust, i.e. for every positive equilbrium, the concentration of species s will be the same.

Note: This function currently only works for networks of deficiency one, and is not currently guaranteed to return *all* the concentration-robust species in the network. Any species returned by the function will be robust, but this may not include all of them. Use with caution. Support for higher deficiency networks and necessary conditions for robustness will be coming in the future.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/Catalyst.jl/blob/59bde519c41fcbb38862944d2b141ed6125b87d1/src/network_analysis.jl#L1269-L1275">source</a></section></details></article><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://link.springer.com/book/10.1007/978-3-030-03858-8?noAccess=true">Feinberg, M. <em>Foundations of Chemical Reaction Network Theory</em>, Applied Mathematical Sciences 202, Springer (2019).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../odes/">« Decomposing the Reaction Network ODEs</a><a class="docs-footer-nextpage" href="../network_properties/">Caching of Network Properties in <code>ReactionSystems</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 1 December 2025 23:43">Monday 1 December 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
