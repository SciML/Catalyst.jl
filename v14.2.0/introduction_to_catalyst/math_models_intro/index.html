<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mathematical Models Catalyst can Generate · Catalyst.jl</title><meta name="title" content="Mathematical Models Catalyst can Generate · Catalyst.jl"/><meta property="og:title" content="Mathematical Models Catalyst can Generate · Catalyst.jl"/><meta property="twitter:title" content="Mathematical Models Catalyst can Generate · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/introduction_to_catalyst/math_models_intro/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/introduction_to_catalyst/math_models_intro/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/introduction_to_catalyst/math_models_intro/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../introduction_to_catalyst/">Introduction to Catalyst</a></li><li class="is-active"><a class="tocitem" href>Mathematical Models Catalyst can Generate</a><ul class="internal"><li><a class="tocitem" href="#General-Chemical-Reaction-Notation"><span>General Chemical Reaction Notation</span></a></li><li><a class="tocitem" href="#Reaction-Rate-Equation-(RRE)-ODE-Models"><span>Reaction Rate Equation (RRE) ODE Models</span></a></li><li><a class="tocitem" href="#Chemical-Langevin-Equation-(CLE)-SDE-Models"><span>Chemical Langevin Equation (CLE) SDE Models</span></a></li><li><a class="tocitem" href="#Stochastic-Chemical-Kinetics-Jump-Process-Models"><span>Stochastic Chemical Kinetics Jump Process Models</span></a></li></ul></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with conservation laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing model properties</a></li><li><a class="tocitem" href="../../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for performant SDE simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Model simulation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a periodic event during ODE and jump simulations</a></li></ul></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><span class="tocitem">Spatial Modelling</span><ul><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Introduction to Catalyst</a></li><li class="is-active"><a href>Mathematical Models Catalyst can Generate</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mathematical Models Catalyst can Generate</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/introduction_to_catalyst/math_models_intro.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="math_models_in_catalyst"><a class="docs-heading-anchor" href="#math_models_in_catalyst">Mathematical Models Catalyst can Generate</a><a id="math_models_in_catalyst-1"></a><a class="docs-heading-anchor-permalink" href="#math_models_in_catalyst" title="Permalink"></a></h1><p>We now describe the types of mathematical models that Catalyst can generate from chemical reaction networks (CRNs), corresponding to reaction rate equation (RRE) ordinary differential equation (ODE) models, Chemical Langevin equation (CLE) stochastic differential equation (SDE) models, and stochastic chemical kinetics (jump process) models. For each we show the abstract representations for the models that Catalyst can support, along with concrete examples. Note that we restrict ourselves to models involving only chemical reactions, and do not consider more general models that Catalyst can support such as coupling in non-reaction ODEs, algebraic equations, or events. Please see the broader documentation for more details on how Catalyst supports such functionality.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This documentation assumes you have already read the <a href="../introduction_to_catalyst/#introduction_to_catalyst">Introduction to Catalyst</a> tutorial.</p></div></div><h2 id="General-Chemical-Reaction-Notation"><a class="docs-heading-anchor" href="#General-Chemical-Reaction-Notation">General Chemical Reaction Notation</a><a id="General-Chemical-Reaction-Notation-1"></a><a class="docs-heading-anchor-permalink" href="#General-Chemical-Reaction-Notation" title="Permalink"></a></h2><p>Suppose we have a reaction network with <span>$K$</span> reactions and <span>$M$</span> species, with the species labeled by <span>$S_1$</span>, <span>$S_2$</span>, <span>$\dots$</span>, <span>$S_M$</span>. We denote by</p><p class="math-container">\[\mathbf{X}(t) = \begin{pmatrix} X_1(t) \\ \vdots \\ X_M(t)) \end{pmatrix}\]</p><p>the state vector for the amount of each species, i.e. <span>$X_m(t)$</span> represents the amount of species <span>$S_m$</span> at time <span>$t$</span>. This could be either a concentration or a count (i.e. &quot;number of molecules&quot; units), but for consistency between modeling representations we will assume the latter in the remainder of this introduction.</p><p>The <span>$k$</span>th chemical reaction is given by</p><p class="math-container">\[\alpha_1^k S_1 + \alpha_2^k S_2 + \dots \alpha_M^k S_M \to \beta_1^k S_1 + \beta_2^k S_2 + \dots \beta_M^k S_M\]</p><p>with <span>$\alpha^k = (\alpha_1^k,\dots,\alpha_M^k)$</span> its substrate stoichiometry vector, <span>$\beta^k = (\beta_1^k,\dots,\beta_M^k)$</span> its product stoichiometry vector, and <span>$\nu^k = \beta^k - \alpha^k$</span> its net stoichiometry vector. <span>$\nu^k$</span> corresponds to the change in <span>$\mathbf{X}(t)$</span> when reaction <span>$k$</span> occurs, i.e. <span>$\mathbf{X}(t) \to \mathbf{X}(t) + \nu^k$</span>. Along with the stoichiometry vectors, we assume each reaction has a reaction rate law (ODEs/SDEs) or propensity (jump process) function, <span>$a_k(\mathbf{X}(t),t)$</span>.</p><p>As explained in <a href="../introduction_to_catalyst/#introduction_to_catalyst">the Catalyst introduction</a>, for a mass action reaction where the preceding reaction has a fixed rate constant, <span>$k$</span>, this function would be the rate law</p><p class="math-container">\[a_k(\mathbf{X}(t)) = k \prod_{m=1}^M \frac{(X_m(t))^{\sigma_m^k}}{\sigma_m^k!},\]</p><p>for RRE ODE and CLE SDE models, and the propensity function</p><p class="math-container">\[a_k(\mathbf{X}(t)) = k \prod_{m=1}^M \frac{X_m(t) (X_m(t)-1) \dots (X_m(t)-\sigma_m^k+1)}{\sigma_m^k!},\]</p><p>for stochastic chemical kinetics jump process models.</p><h3 id="Rate-Law-vs.-Propensity-Example:"><a class="docs-heading-anchor" href="#Rate-Law-vs.-Propensity-Example:">Rate Law vs. Propensity Example:</a><a id="Rate-Law-vs.-Propensity-Example:-1"></a><a class="docs-heading-anchor-permalink" href="#Rate-Law-vs.-Propensity-Example:" title="Permalink"></a></h3><p>For the reaction <span>$2A + B \overset{k}{\to} 3 C$</span> we would have</p><p class="math-container">\[\mathbf{X}(t) = (A(t), B(t), C(t))\]</p><p>with <span>$\sigma_1 = 2$</span>, <span>$\sigma_2 = 1$</span>, <span>$\sigma_3 = 0$</span>, <span>$\beta_1 = 0$</span>, <span>$\beta_2 = 0$</span>, <span>$\beta_3 = 3$</span>, <span>$\nu_1 = -2$</span>, <span>$\nu_2 = -1$</span>, and <span>$\nu_3 = 3$</span>. For an ODE/SDE model we would have the rate law</p><p class="math-container">\[a(\mathbf{X}(t)) = \frac{k}{2} A^2 B\]</p><p>while for a jump process model we would have the propensity function</p><p class="math-container">\[a(\mathbf{X}(t)) = \frac{k}{2} A (A-1) B.\]</p><p>Note, if the combinatoric factors are already included in one&#39;s rate constants, the implicit rescaling of rate constants can be disabled through use of the <code>combinatoric_ratelaws = false</code> argument to <a href="../../api/#Base.convert"><code>Base.convert</code></a> or whatever Problem is being generated, i.e.</p><pre><code class="language-julia hljs">rn = @reaction_network ...
osys = convert(ODESystem, rn; combinatoric_ratelaws = false)
oprob = ODEProblem(osys, ...)

# or
oprob = ODEProblem(rn, ...; combinatoric_ratelaws = false)</code></pre><p>In this case our ODE/SDE rate law would be</p><p class="math-container">\[a(\mathbf{X}(t)) = k A^2 B\]</p><p>while the jump process propensity function is</p><p class="math-container">\[a(\mathbf{X}(t)) = k A (A-1) B.\]</p><h2 id="Reaction-Rate-Equation-(RRE)-ODE-Models"><a class="docs-heading-anchor" href="#Reaction-Rate-Equation-(RRE)-ODE-Models">Reaction Rate Equation (RRE) ODE Models</a><a id="Reaction-Rate-Equation-(RRE)-ODE-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Reaction-Rate-Equation-(RRE)-ODE-Models" title="Permalink"></a></h2><p>The RRE ODE models Catalyst creates for a general system correspond to the coupled system of ODEs given by</p><p class="math-container">\[\frac{d X_m}{dt} =\sum_{k=1}^K \nu_m^k a_k(\mathbf{X}(t),t), \quad m = 1,\dots,M.\]</p><p>These models can be generated by creating <code>ODEProblem</code>s from Catalyst <code>ReactionSystem</code>s, and solved using the solvers in <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a>. Similarly, creating <code>NonlinearProblem</code>s or <code>SteadyStateProblem</code>s will generate the coupled algebraic system of steady-state equations associated with a RRE ODE model, i.e.</p><p class="math-container">\[0 =\sum_{k=1}^K \nu_m^k a_k(\bar{\mathbf{X}}), \quad m = 1,\dots,M\]</p><p>for a steady-state <span>$\bar{\mathbf{X}}$</span>. Note, here we have assumed the rate laws are <a href="https://en.wikipedia.org/wiki/Autonomous_system_(mathematics)">autonomous</a> so that the equations are well-defined.</p><h3 id="RRE-ODE-Example"><a class="docs-heading-anchor" href="#RRE-ODE-Example">RRE ODE Example</a><a id="RRE-ODE-Example-1"></a><a class="docs-heading-anchor-permalink" href="#RRE-ODE-Example" title="Permalink"></a></h3><p>Let&#39;s see the generated ODEs for the following network</p><pre><code class="language-julia hljs">using Catalyst, ModelingToolkit, Latexify
rn = @reaction_network begin
    k₁, 2A + B --&gt; 3C
    k₂, A --&gt; 0
    k₃, 0 --&gt; A
end
osys = convert(ODESystem, rn)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} A\left( t \right)}{\mathrm{d}t} &amp;= k_3 - k_2 A\left( t \right) - \left( A\left( t \right) \right)^{2} k_1 B\left( t \right) \\
\frac{\mathrm{d} B\left( t \right)}{\mathrm{d}t} &amp;=  - \frac{1}{2} \left( A\left( t \right) \right)^{2} k_1 B\left( t \right) \\
\frac{\mathrm{d} C\left( t \right)}{\mathrm{d}t} &amp;= \frac{3}{2} \left( A\left( t \right) \right)^{2} k_1 B\left( t \right)
\end{align}
 \]</p><p>Likewise, the following drops the combinatoric scaling factors, giving unscaled ODEs</p><pre><code class="language-julia hljs">osys = convert(ODESystem, rn; combinatoric_ratelaws = false)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} A\left( t \right)}{\mathrm{d}t} &amp;= k_3 - k_2 A\left( t \right) - 2 \left( A\left( t \right) \right)^{2} k_1 B\left( t \right) \\
\frac{\mathrm{d} B\left( t \right)}{\mathrm{d}t} &amp;=  - \left( A\left( t \right) \right)^{2} k_1 B\left( t \right) \\
\frac{\mathrm{d} C\left( t \right)}{\mathrm{d}t} &amp;= 3 \left( A\left( t \right) \right)^{2} k_1 B\left( t \right)
\end{align}
 \]</p><h2 id="Chemical-Langevin-Equation-(CLE)-SDE-Models"><a class="docs-heading-anchor" href="#Chemical-Langevin-Equation-(CLE)-SDE-Models">Chemical Langevin Equation (CLE) SDE Models</a><a id="Chemical-Langevin-Equation-(CLE)-SDE-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Chemical-Langevin-Equation-(CLE)-SDE-Models" title="Permalink"></a></h2><p>The CLE SDE models Catalyst creates for a general system correspond to the coupled system of SDEs given by</p><p class="math-container">\[d X_m = \sum_{k=1}^K \nu_m^k a_k(\mathbf{X}(t),t) dt + \sum_{k=1}^K \nu_m^k \sqrt{a_k(\mathbf{X}(t),t)} dW_k(t), \quad m = 1,\dots,M,\]</p><p>where each <span>$W_k(t)$</span> represents an independent, standard Brownian Motion. Realizations of these processes can be generated by creating <code>SDEProblem</code>s from Catalyst <code>ReactionSystem</code>s, and sampling the processes using the solvers in <a href="https://github.com/SciML/StochasticDiffEq.jl">StochasticDiffEq.jl</a>.</p><h3 id="CLE-SDE-Example"><a class="docs-heading-anchor" href="#CLE-SDE-Example">CLE SDE Example</a><a id="CLE-SDE-Example-1"></a><a class="docs-heading-anchor-permalink" href="#CLE-SDE-Example" title="Permalink"></a></h3><p>Consider the same network as above,</p><pre><code class="language-julia hljs">rn = @reaction_network begin
    k₁, 2A + B --&gt; 3C
    k₂, A --&gt; 0
    k₃, 0 --&gt; A
end</code></pre><p>We obtain the CLE SDEs</p><p class="math-container">\[\begin{align}
dA(t) &amp;= \left(- k_1 A^{2} B - k_2 A + k_3 \right) dt
 - 2 \sqrt{\tfrac{k_1}{2} A^{2} B} \, dW_1(t)  - \sqrt{k_2 A} \, dW_2(t) + \sqrt{k_3} \, dW_3(t)
\\
dB(t) &amp;= - \frac{k_1}{2} A^{2} B \, dt - \sqrt{\frac{k_1}{2} A^{2} B} \, dW_1(t) \\
dC(t) &amp;= \frac{3}{2} k_1 A^{2} B \, dt + 3 \sqrt{\frac{k_1}{2} A^{2} B} \, dW_1(t).
\end{align}\]</p><h2 id="Stochastic-Chemical-Kinetics-Jump-Process-Models"><a class="docs-heading-anchor" href="#Stochastic-Chemical-Kinetics-Jump-Process-Models">Stochastic Chemical Kinetics Jump Process Models</a><a id="Stochastic-Chemical-Kinetics-Jump-Process-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-Chemical-Kinetics-Jump-Process-Models" title="Permalink"></a></h2><p>The stochastic chemical kinetics jump process models Catalyst creates for a general system correspond to the coupled system of jump processes, in the time change representation, given by</p><p class="math-container">\[X_m(t) = X_m(0) + \sum_{k=1}^K \nu_m^k Y_k\left( \int_{0}^t a_k(\mathbf{X}(s^-),s) \, ds \right), \quad m = 1,\dots,M.\]</p><p>Here each <span>$Y_k(t)$</span> denotes an independent unit rate Poisson counting process with <span>$Y_k(0) = 0$</span>, which counts the number of times the <span>$k$</span>th reaction has occurred up to time <span>$t$</span>. Realizations of these processes can be generated by creating <code>JumpProblem</code>s from Catalyst <code>ReactionSystem</code>s, and sampling the processes using the solvers in <a href="https://github.com/SciML/JumpProcesses.jl">JumpProcesses.jl</a>.</p><p>Let <span>$P(\mathbf{x},t) = \operatorname{Prob}[\mathbf{X}(t) = \mathbf{x}]$</span> represent the probability the state of the system, <span>$\mathbf{X}(t)$</span>, has the concrete value <span>$\mathbf{x}$</span> at time <span>$t$</span>. The forward equation, i.e. Chemical Master Equation (CME), associated with <span>$\mathbf{X}(t)$</span> is then the coupled system of ODEs over all possible values for <span>$\mathbf{x}$</span> given by</p><p class="math-container">\[\frac{dP}{dt}(\mathbf{x},t) = \sum_{k=1}^k \left[ a_k(\mathbf{x} - \nu^k,t) P(\mathbf{x} - \nu^k,t) - a_k(\mathbf{x},t) P(\mathbf{x},t) \right].\]</p><p>While Catalyst does not currently support generating and solving for <span>$P(\mathbf{x},t)$</span>, for sufficiently small models the <a href="https://github.com/SciML/FiniteStateProjection.jl">FiniteStateProjection.jl</a> package can be used to generate and solve such models directly from Catalyst <a href="../../api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a>s.</p><h3 id="Stochastic-Chemical-Kinetics-Jump-Process-Example"><a class="docs-heading-anchor" href="#Stochastic-Chemical-Kinetics-Jump-Process-Example">Stochastic Chemical Kinetics Jump Process Example</a><a id="Stochastic-Chemical-Kinetics-Jump-Process-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-Chemical-Kinetics-Jump-Process-Example" title="Permalink"></a></h3><p>Consider the same network as above,</p><pre><code class="language-julia hljs">rn = @reaction_network begin
    k₁, 2A + B --&gt; 3C
    k₂, A --&gt; 0
    k₃, 0 --&gt; A
end</code></pre><p>The time change process representation would be</p><p class="math-container">\[\begin{align*}
A(t) &amp;= A(0) - 2 Y_1\left( \frac{k_1}{2} \int_0^t A(s^-)(A(s^-)-1) B(s^-) \, ds \right) - Y_2 \left( k_2 \int_0^t A(s^-) \, ds \right) + Y_3 \left( k_3 t \right) \\
B(t) &amp;= B(0) - Y_1\left( \frac{k_1}{2} \int_0^t A(s^-)(A(s^-)-1) B(s^-) \, ds \right) \\
C(t) &amp;= C(0) + 3 Y_1\left( \frac{k_1}{2} \int_0^t A(s^-)(A(s^-)-1) B(s^-) \, ds \right),
\end{align*}\]</p><p>while the CME would be the coupled (infinite) system of ODEs over all realizable values of the non-negative integers <span>$a$</span>, <span>$b$</span>, and <span>$c$</span> given by</p><p class="math-container">\[\begin{align*}
\frac{dP}{dt}(a,b,c,t) &amp;= \left[\tfrac{k_1}{2} (a+2) (a+1) (b+1) P(a+2,b+1,c-3,t) - \tfrac{k_1}{2} a (a-1) b P(a,b,c,t)\right] \\
&amp;\phantom{=} + \left[k_2 (a+1) P(a+1,b,c,t) - k_2 a P(a,b,c,t)\right] \\
&amp;\phantom{=} + \left[k_3 P(a-1,b,c,t) - k_3 P(a,b,c,t)\right].
\end{align*}\]</p><p>If we initially have <span>$A(0) = a_0$</span>, <span>$B(0) = b_0$</span>, and <span>$C(0) = c_0$</span> then we would have one ODE for each of possible state <span>$(a,b,c)$</span> where <span>$a \in \{0,1,\dots\}$</span> (i.e. <span>$a$</span> can be any non-negative integer), <span>$b \in \{0,1,\dots,b_0\}$</span>, and <span>$c \in \{c_0, c_0 + 1,\dots, c_0 + 3 b_0\}$</span>. Other initial conditions would lead to different possible ranges for <span>$a$</span>, <span>$b$</span>, and <span>$c$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../introduction_to_catalyst/">« Introduction to Catalyst</a><a class="docs-footer-nextpage" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 8 August 2024 22:33">Thursday 8 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
