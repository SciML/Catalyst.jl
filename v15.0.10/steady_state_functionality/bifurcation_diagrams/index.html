<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bifurcation Diagrams · Catalyst.jl</title><meta name="title" content="Bifurcation Diagrams · Catalyst.jl"/><meta property="og:title" content="Bifurcation Diagrams · Catalyst.jl"/><meta property="twitter:title" content="Bifurcation Diagrams · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/bifurcation_diagrams/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/bifurcation_diagrams/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/bifurcation_diagrams/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Coupled ODEs, Algebraic Equations, and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with Conservation Laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stoichiometries</a></li><li><a class="tocitem" href="../../model_creation/functional_parameters/">Inputs and time-dependent (or functional) parameters</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing Model Properties</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related Functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, Generative, Modelling of a Linear Pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/noise_modelling_approaches/">Approaches for modelling system noise</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation Plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for Performant ODE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for Performant SDE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/finite_state_projection_simulation/">Solving the chemical master equation using FiniteStateProjection.jl</a></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a Periodic Event During ODE and Jump Simulations</a></li><li><a class="tocitem" href="../../model_simulation/examples/activation_time_distribution_measurement/">Measuring the Distribution of System Activation Times</a></li><li><a class="tocitem" href="../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Network Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../network_analysis/odes/">Decomposing the Reaction Network ODEs</a></li><li><a class="tocitem" href="../../network_analysis/crn_theory/">Chemical Reaction Network Theory</a></li><li><a class="tocitem" href="../../network_analysis/network_properties/">Caching of Network Properties in <code>ReactionSystems</code></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../steady_state_stability_computation/">Steady state stability computation</a></li><li class="is-active"><a class="tocitem" href>Bifurcation Diagrams</a><ul class="internal"><li><a class="tocitem" href="#bifurcation_diagrams_basic_example"><span>Basic example</span></a></li><li><a class="tocitem" href="#bifurcation_diagrams_continuationpar"><span>Additional <code>ContinuationPar</code> options</span></a></li><li><a class="tocitem" href="#bifurcation_diagrams_disjoint_branches"><span>Bifurcation diagrams with disjoint branches</span></a></li><li><a class="tocitem" href="#bifurcation_diagrams_cons_laws"><span>Systems with conservation laws</span></a></li><li><a class="tocitem" href="#bifurcationkit_periodic_orbits_citation"><span>Citation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../dynamical_systems/">Analysing Model Steady State Properties with DynamicalSystems.jl</a></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/nullcline_plotting/">Plotting Nullclines and Steady States in Phase Space</a></li><li><a class="tocitem" href="../examples/bifurcationkit_periodic_orbits/">Computing Periodic Orbits (Oscillations) Using BifurcationKit.jl</a></li><li><a class="tocitem" href="../examples/bifurcationkit_codim2/">Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for Non-data Fitting Purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial Jump Simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/core_api/">Catalyst.jl API</a></li><li><a class="tocitem" href="../../api/network_analysis_api/">Network analysis and representations</a></li></ul></li><li><a class="tocitem" href="../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Steady state analysis</a></li><li class="is-active"><a href>Bifurcation Diagrams</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bifurcation Diagrams</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/steady_state_functionality/bifurcation_diagrams.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="bifurcation_diagrams"><a class="docs-heading-anchor" href="#bifurcation_diagrams">Bifurcation Diagrams</a><a id="bifurcation_diagrams-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams" title="Permalink"></a></h1><p>Bifurcation diagrams describe how, for a dynamical system, the quantity and type of its steady states change as a parameter is varied<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1" class="footnote-ref">[1]</a><span class="footnote-preview" id="fn-1"></span></sup>. When using Catalyst-generated models, these can be computed with the <a href="https://github.com/bifurcationkit/BifurcationKit.jl">BifurcationKit.jl</a> package. Catalyst provides a simple interface for creating BifurcationKit compatible <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/library/#BifurcationKit.BifurcationProblem"><code>BifurcationProblem</code></a>s from <a href="../../api/core_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a>s.</p><p>This tutorial briefly introduces how to use Catalyst with BifurcationKit through basic examples, with BifurcationKit.jl providing <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/">a more extensive documentation</a>. Especially for more complicated systems, where careful tuning of algorithm options might be required, reading the BifurcationKit documentation is recommended. Finally, BifurcationKit provides many additional features not described here, including <a href="../examples/bifurcationkit_periodic_orbits/#bifurcationkit_periodic_orbits">computation of periodic orbits</a>, <a href="../examples/bifurcationkit_codim2/#bifurcationkit_codim2">tracking of bifurcation points along secondary parameters</a>, and <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/tutorials/tutorials/#PDEs:-bifurcations-of-equilibria">bifurcation computations for PDEs</a>.</p><h2 id="bifurcation_diagrams_basic_example"><a class="docs-heading-anchor" href="#bifurcation_diagrams_basic_example">Basic example</a><a id="bifurcation_diagrams_basic_example-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams_basic_example" title="Permalink"></a></h2><p>For this example, we will use a modified version of the <a href="../../model_creation/examples/basic_CRN_library/#basic_CRN_library_wilhelm">Wilhelm model</a> (which demonstrates a bistable switch as the parameter <span>$k1$</span> is varied). We declare the model using Catalyst:</p><pre><code class="language-julia hljs">using Catalyst
wilhelm_model = @reaction_network begin
    k1, Y --&gt; 2X
    k2, 2X --&gt; X + Y
    k3, X + Y --&gt; Y
    k4, X --&gt; 0
    k5, 0 --&gt; X
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{Y} &amp;\xrightarrow{\mathtt{k1}} 2 \mathrm{X} \\
2 \mathrm{X} &amp;\xrightarrow{\mathtt{k2}} \mathrm{X} + \mathrm{Y} \\
\mathrm{X} + \mathrm{Y} &amp;\xrightarrow{\mathtt{k3}} \mathrm{Y} \\
\mathrm{X} &amp;\xrightleftharpoons[\mathtt{k5}]{\mathtt{k4}} \varnothing  
 \end{align*}
 \]</p><p>Next we will create a <code>BifurcationProblem</code>. In addition to the <code>ReactionSystem</code>, we need to provide:</p><ul><li>The bifurcation parameter (the parameter which is varied in the bifurcation diagram).</li><li>A full model parameter set. This includes the values of all non-bifurcation parameters, but also a value for the bifurcation parameter (which corresponds to the point in parameter space from which the computation of the bifurcation diagram starts).</li><li>An initial guess of the steady state values of the system at the provided parameter set. Using this point as a starting guess for root finding, BifurcationKit calculates an initial steady state from which to compute the bifurcation diagram. Hence, this guess does not need to be very exact (but may be important if the system exhibits multistability for the initial parameter set).</li><li>The species or statistic we wish to plot on the y-axis of the bifurcation diagram (customised properties can be recorded and plotted using the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/periodicOrbit/#.-record*from*solution"><code>record_from_solution</code> argument</a>).</li></ul><p>We combine all this information to form a <code>BifurcationProblem</code>:</p><pre><code class="language-julia hljs">using BifurcationKit
bif_par = :k1
u_guess = [:X =&gt; 5.0, :Y =&gt; 2.0]
p_start = [:k1 =&gt; 8.0, :k2 =&gt; 1.0, :k3 =&gt; 1.0, :k4 =&gt; 1.5, :k5 =&gt; 1.25]
plot_var = :X
bprob = BifurcationProblem(wilhelm_model, u_guess, p_start, bif_par; plot_var)</code></pre><p>BifurcationKit computes bifurcation diagrams using the <code>bifurcationdiagram</code> function. From an initial point in the diagram, it tracks the solution (using a continuation algorithm) until the entire diagram is computed (BifurcationKit&#39;s continuation can be used for other purposes, however, this tutorial focuses on bifurcation diagram computation). The continuation settings are provided in a <code>ContinuationPar</code> structure. In this example, we will only specify two settings (<code>p_min</code> and <code>p_max</code>), which sets the minimum and maximum values over which the bifurcation parameter is varied, respectively. We wish to compute a bifurcation diagram over the interval <span>$(2.0,20.0)$</span>, and will use the following settings:</p><pre><code class="language-julia hljs">p_span = (2.0, 20.0)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2])</code></pre><p>Finally, we compute our bifurcation diagram using:</p><pre><code class="language-julia hljs">bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)</code></pre><p>Where <code>PALC()</code> designates that we wish to use the pseudo-arclength continuation method to track our solution. The third argument (<code>2</code>) designates the maximum number of recursions when branches of branches are computed (branches appear as continuation encounters certain bifurcation points). For diagrams with highly branched structures (rare for many common small chemical reaction networks) this input is important. Finally, <code>bothside = true</code> designates that we wish to perform continuation on both sides of the initial point (which is typically the case). </p><p>We can plot our bifurcation diagram using the Plots.jl package:</p><pre><code class="language-julia hljs">using Plots
plot(bif_dia; xguide = bif_par, yguide = plot_var, branchlabel = &quot;Steady state concentration&quot;)</code></pre><img src="a988140b.svg" alt="Example block output"/><p>Here, the steady state concentration of <span>$X$</span> is shown as a function of <span>$k1$</span>&#39;s value. Stable steady states are shown with thick lines, unstable ones with thin lines. The two <a href="https://en.wikipedia.org/wiki/Saddle-node_bifurcation">fold bifurcation points</a> are marked with &quot;bp&quot;.</p><h2 id="bifurcation_diagrams_continuationpar"><a class="docs-heading-anchor" href="#bifurcation_diagrams_continuationpar">Additional <code>ContinuationPar</code> options</a><a id="bifurcation_diagrams_continuationpar-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams_continuationpar" title="Permalink"></a></h2><p>Most of the options required by the <code>bifurcationdiagram</code> function are provided through the <code>ContinuationPar</code> structure. For full details, please read the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/library/#BifurcationKit.ContinuationPar">BifurcationKit documentation</a>. However, a few common options, and how they affect the continuation computation, are described here:</p><ul><li><code>p_min</code> and <code>p_max</code>: Set the interval over which the bifurcation diagram is computed (with the continuation stopping if it reaches these bounds).</li><li><code>dsmin</code> and <code>dsmax</code>: The minimum and maximum length of the continuation steps (in the bifurcation parameter&#39;s value).</li><li><code>ds</code>: The initial length of the continuation steps. This is especially important when <code>bothside = true</code> <em>is not</em> used, as the sign of <code>ds</code> determines the direction from the initial point in which the continuation will proceed.</li><li><code>max_steps</code>: The maximum number of continuation steps. If a bifurcation diagram looks incomplete, try increasing this value.</li><li><code>newton_options</code>: Options for the Newton&#39;s method that BifurcationKit uses to find steady states. This can be created using <code>NewtonPar(tol = 1e-9, max_iterations = 100)</code> which here sets the tolerance (to <code>1e-9</code>) and the maximum number of newton iterations (to <code>100</code>).</li></ul><p>The previous bifurcation diagram can be computed, with these various options specified, in the following way:</p><pre><code class="language-julia hljs">p_span = (2.0, 20.0)
newton_options = NewtonPar(tol = 1e-9, max_iterations = 20)
opts_br = ContinuationPar(; p_min = p_span[1], p_max = p_span[2], ds = 0.005,
                          dsmin = 0.001, dsmax = 0.01, max_steps = 1000, newton_options)
bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)</code></pre><p>(In this case, however, these additional settings have no significant effect on the result)</p><h2 id="bifurcation_diagrams_disjoint_branches"><a class="docs-heading-anchor" href="#bifurcation_diagrams_disjoint_branches">Bifurcation diagrams with disjoint branches</a><a id="bifurcation_diagrams_disjoint_branches-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams_disjoint_branches" title="Permalink"></a></h2><p>Let&#39;s consider the previous case, but instead compute the bifurcation diagram over the interval <span>$(8.0,15.0)$</span>:</p><pre><code class="language-julia hljs">p_span = (8.0, 15.0)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2])
bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)
plot(bif_dia; ylimit = (0.0, 17.0), xguide = bif_par, yguide = plot_var, branchlabel = &quot;Steady state concentration&quot;)</code></pre><img src="d64ed181.svg" alt="Example block output"/><p>Here, in the bistable region, we only see a single branch. The reason is that the continuation algorithm starts at our initial guess (here made at <span>$k1 = 8.0$</span> for <span>$(X,Y) = (5.0,2.0)$</span>) and tracks the diagram from there. However, with the upper bound set at <span>$k1 = 15.0$</span> the bifurcation diagram has a disjoint branch structure, preventing the full diagram from being computed by continuation alone. In this case it could be solved by increasing the bound from <span>$k1 = 15.0$</span>, however, this is not possible in all cases. Here we will describe a more general solution, the use of <em>deflation</em> to find multiple steady states.</p><p>We will not describe the details of how deflation works here (instead, please read <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/DeflatedContinuation/">BifurcationKit&#39;s documentation</a>). In practise, in involves first creating a deflation continuation algorithm (<code>defalg</code>). This one, in turn, requires us to create <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/library/#BifurcationKit.DeflationOperator">a deflation operator</a> and a perturbation function.</p><pre><code class="language-julia hljs">deflation_operator = DeflationOperator(2, 0.001, [zeros(numspecies(wilhelm_model))])
perturb_solution(x, _, _) = (x  .+ 0.1 .* rand(length(x)))
defalg = DefCont(; deflation_operator, perturb_solution)</code></pre><p>Next we compute our bifurcation diagram using <code>defalg</code> (instead of <code>PALC()</code> as previous) as our method. We also use a range of additional continuation parameter options to ensure a smooth tracking of the solution. Here we have </p><pre><code class="language-julia hljs">newton_options = NewtonPar(max_iterations = 10)
cont_par = ContinuationPar(; p_min = p_span[1], p_max = p_span[2], ds = 0.001, max_steps = 10000, newton_options)
bif_dia = continuation(bprob, defalg, cont_par; plot = false, verbosity = 0)</code></pre><p>Finally we can plot the diagram, noting that (unlike previously) we are able to compute the full diagram.</p><pre><code class="language-julia hljs">plot(bif_dia; xguide = bif_par, yguide = plot_var, ylimit = (0.0, 17.0), color = 1)</code></pre><img src="c5e90996.svg" alt="Example block output"/><h2 id="bifurcation_diagrams_cons_laws"><a class="docs-heading-anchor" href="#bifurcation_diagrams_cons_laws">Systems with conservation laws</a><a id="bifurcation_diagrams_cons_laws-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams_cons_laws" title="Permalink"></a></h2><p>Some systems are under-determined at steady state, so that for a given parameter set they have an infinite number of possible steady state solutions, preventing bifurcation diagrams from being computed. Similar to when we <a href="../homotopy_continuation/#homotopy_continuation_conservation_laws">compute steady states for fixed parameter values</a>, we can utilise Catalyst&#39;s ability to <a href="../../model_creation/conservation_laws/#conservation_laws">detect and eliminate conservation laws</a> to resolve this issue. This requires us to provide information of the species concentrations at which we wish to compute the bifurcation diagram (to determine the values of conserved quantities). These are provided to the <code>BifurcationProblem</code> using the <code>u0</code> argument.</p><p>To illustrate this, we will create a simple model of a kinase that is produced and degraded (at rates <span>$p$</span> and <span>$d$</span>). The kinase facilitates the phosphorylation of a protein (<span>$X$</span>), which is dephosphorylated at a constant rate. For this system, we will compute a bifurcation diagram, showing how the concentration of the phosphorylated protein (<span>$Xp$</span>) depends on the degradation rate of the kinase (<span>$d$</span>). We will set the total amount of protein (<span>$X + Xp$</span>) to <span>$1.0$</span>.</p><pre><code class="language-julia hljs">using BifurcationKit, Catalyst, Plots
kinase_model = @reaction_network begin
    (p, d), 0 &lt;--&gt; K
    (K*kP,kD), X &lt;--&gt; Xp
end

u_guess = [:K =&gt; 1.0, :X =&gt; 1.0, :Xp =&gt; 1.0]
p_start = [:p =&gt; 1.0, :d =&gt; 0.5, :kP =&gt; 2.0, :kD =&gt; 5.0]
u0 = [:X =&gt; 1.0, :Xp =&gt; 0.0]
bprob = BifurcationProblem(kinase_model, u_guess, p_start, :d; plot_var = :Xp, u0)

p_span = (0.1, 10.0)
opts_br = ContinuationPar(p_min = p_span[1], p_max = p_span[2])
bif_dia = bifurcationdiagram(bprob, PALC(), 2, opts_br; bothside = true)
plot(bif_dia; xguide = &quot;d&quot;, yguide = &quot;Xp&quot;)</code></pre><img src="afbe6ad3.svg" alt="Example block output"/><p>This bifurcation diagram does not contain any interesting features (such as bifurcation points), and only shows how the steady state concentration of <span>$Xp$</span> is reduced as <span>$d$</span> increases. </p><p>Finally, for additional clarity, we reiterate the purpose of the two <code>u</code> arguments used:</p><ul><li><code>u_guess</code>: A guess of the initial steady states (which BifurcationKit uses to find its starting point). Typically, most trivial guesses work (e.g. setting all species concentrations to <code>1.0</code>). <code>u_guess</code> <em>does not</em> have to fulfil the conserved concentrations provided in <code>u0</code>.</li><li><code>u0</code>: Used to compute the concentrations of any conserved quantities (e.g. in our example <span>$X + Xp = 1.0$</span>). Technically, values are only required for species that are involved in conservation laws (in our case we do not need to provide a value for <span>$K$</span>). However, sometimes determining which species are actually involved in conservation laws can be difficult, and it might be easier to simply provide concentrations for all species.</li></ul><hr/><h2 id="bifurcationkit_periodic_orbits_citation"><a class="docs-heading-anchor" href="#bifurcationkit_periodic_orbits_citation">Citation</a><a id="bifurcationkit_periodic_orbits_citation-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcationkit_periodic_orbits_citation" title="Permalink"></a></h2><p>If you use BifurcationKit.jl for your work, we ask that you <strong>cite</strong> the following paper!! Open source development strongly depends on this. It is referenced on <a href="https://hal.archives-ouvertes.fr/hal-02902346">HAL-Inria</a> with <em>bibtex</em> entry <a href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/master/CITATION.bib">CITATION.bib</a>.</p><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://link.springer.com/book/10.1007/978-3-031-22007-4">Yuri A. Kuznetsov, <em>Elements of Applied Bifurcation Theory</em>, Springer (2023).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../steady_state_stability_computation/">« Steady state stability computation</a><a class="docs-footer-nextpage" href="../dynamical_systems/">Analysing Model Steady State Properties with DynamicalSystems.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 1 December 2025 20:46">Monday 1 December 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
