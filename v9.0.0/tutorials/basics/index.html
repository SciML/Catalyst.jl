<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The Reaction DSL · Catalyst.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../using_catalyst/">Using Catalyst</a></li><li class="is-active"><a class="tocitem" href>The Reaction DSL</a></li><li><a class="tocitem" href="../models/">Model Simulation</a></li><li><a class="tocitem" href="../basic_examples/">Basic Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../advanced/">The Reaction DSL - Advanced</a></li><li><a class="tocitem" href="../generated_systems/">The generated <code>ReactionSystem</code> and <code>Reaction</code>s</a></li><li><a class="tocitem" href="../advanced_examples/">Advanced Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../bifurcation_diagram/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../parameter_estimation/">Parameter Estimation</a></li><li><a class="tocitem" href="../generating_reactions_programmatically/">Generating ReactionSystems Programmatically</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/catalyst_api/">Catalyst.jl API</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>The Reaction DSL</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The Reaction DSL</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/tutorials/basics.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-Reaction-DSL"><a class="docs-heading-anchor" href="#The-Reaction-DSL">The Reaction DSL</a><a id="The-Reaction-DSL-1"></a><a class="docs-heading-anchor-permalink" href="#The-Reaction-DSL" title="Permalink"></a></h1><p>This tutorial covers some of the basic syntax for building chemical reaction network models. Examples showing how to both construct and solve ODE, SDE, and jump models are provided in <a href="../basic_examples/#Basic-Chemical-Reaction-Network-Examples">Basic Chemical Reaction Network Examples</a>.</p><h4 id="Basic-syntax"><a class="docs-heading-anchor" href="#Basic-syntax">Basic syntax</a><a id="Basic-syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-syntax" title="Permalink"></a></h4><p>The <code>@reaction_network</code> macro allows the (symbolic) specification of reaction networks with a simple format. Its input is a set of chemical reactions, and from them it generates a <a href="../../api/catalyst_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a> reaction network object. The <code>ReactionSystem</code> can be used as input to <code>ODEProblem</code>, <code>SteadyStateProblem</code>, <code>SDEProblem</code>, <code>JumpProblem</code>, and more. <code>ReactionSystem</code>s can also be incrementally extended as needed, allowing for programmatic construction of networks and network composition.</p><p>The basic syntax is:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  2.0, X + Y --&gt; XY               
  1.0, XY --&gt; Z1 + Z2            
end</code></pre><p>where each line corresponds to a chemical reaction. Each reaction consists of a reaction rate (the expression on the left hand side of  <code>,</code>), a set of substrates (the expression in-between <code>,</code> and <code>--&gt;</code>), and a set of products (the expression on the right hand side of <code>--&gt;</code>). The substrates and the products may contain one or more reactants, separated by <code>+</code>. The naming convention for these are the same as for normal variables in Julia.</p><p>The chemical reaction model is generated by the <code>@reaction_network</code> macro and stored in the <code>rn</code> variable (a normal Julia variable, which does not need to be called <code>rn</code>). The generated <code>ReactionSystem</code> can be converted to a differential equation model via</p><pre><code class="language-julia hljs">osys = convert(ODESystem, rn)
oprob = ODEProblem(osys, Pair.(species(rn),u0), tspan, Pair.(params(rn),p))</code></pre><p>or more directly via</p><pre><code class="language-julia hljs">oprob = ODEProblem(rn, u0, tspan, p)</code></pre><p>For more detailed examples, see the <a href="../basic_examples/#Basic-Chemical-Reaction-Network-Examples">Basic Chemical Reaction Network Examples</a>. The generated differential equations use the law of mass action. For the above example, the ODEs are then</p><p class="math-container">\[\frac{d[X]}{dt} = -2 [X] [Y]\\
\frac{d[Y]}{dt} = -2 [X] [Y]\\
\frac{d[XY]}{dt} = 2 [X] [Y] - [XY]\\
\frac{d[Z1]}{dt}= [XY]\\
\frac{d[Z2]}{dt} = [XY]\]</p><h4 id="Arrow-variants"><a class="docs-heading-anchor" href="#Arrow-variants">Arrow variants</a><a id="Arrow-variants-1"></a><a class="docs-heading-anchor-permalink" href="#Arrow-variants" title="Permalink"></a></h4><p>A variety of unicode arrows are accepted by the DSL in addition to <code>--&gt;</code>. All of these work:  <code>&gt;</code>, <code>→</code> <code>↣</code>, <code>↦</code>, <code>⇾</code>, <code>⟶</code>, <code>⟼</code>, <code>⥟</code>, <code>⥟</code>, <code>⇀</code>, <code>⇁</code>. Backwards arrows can also be used to write the reaction in the opposite direction. For example, these three reactions are equivalent:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  1.0, X + Y --&gt; XY               
  1.0, X + Y → XY      
  1.0, XY ← X + Y      
end</code></pre><p><em>On Julia 1.6 and up the plain text arrows <code>&lt;--</code> (for backward reactions) and <code>&lt;--&gt;</code> (for reversible reactions) also work. Note, these are not available on earlier Julia versions.</em></p><h4 id="Using-bi-directional-arrows"><a class="docs-heading-anchor" href="#Using-bi-directional-arrows">Using bi-directional arrows</a><a id="Using-bi-directional-arrows-1"></a><a class="docs-heading-anchor-permalink" href="#Using-bi-directional-arrows" title="Permalink"></a></h4><p>Bi-directional unicode arrows can be used to designate a reaction that goes two ways. These three models are equivalent:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  2.0, X + Y → XY             
  2.0, X + Y ← XY          
end
rn = @reaction_network begin
  2.0, X + Y ↔ XY               
end</code></pre><p>If the reaction rates in the backward and forward directions are different, they can be designated in the following way:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  (2.0,1.0) X + Y ↔ XY               
end</code></pre><p>which is identical to</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  2.0, X + Y → XY             
  1.0, X + Y ← XY          
end</code></pre><h4 id="Combining-several-reactions-in-one-line"><a class="docs-heading-anchor" href="#Combining-several-reactions-in-one-line">Combining several reactions in one line</a><a id="Combining-several-reactions-in-one-line-1"></a><a class="docs-heading-anchor-permalink" href="#Combining-several-reactions-in-one-line" title="Permalink"></a></h4><p>Several similar reactions can be combined in one line by providing a tuple of reaction rates and/or substrates and/or products. If several tuples are provided, they must all be of identical length. These pairs of reaction networks are all identical:</p><pre><code class="language-julia hljs">rn1 = @reaction_network begin
  1.0, S → (P1,P2)               
end
rn2 = @reaction_network begin
  1.0, S → P1     
  1.0, S → P2
end</code></pre><pre><code class="language-julia hljs">rn1 = @reaction_network begin
  (1.0,2.0), (S1,S2) → P             
end
rn2 = @reaction_network begin
  1.0, S1 → P     
  2.0, S2 → P
end</code></pre><pre><code class="language-julia hljs">rn1 = @reaction_network begin
  (1.0,2.0,3.0), (S1,S2,S3) → (P1,P2,P3)        
end
rn2 = @reaction_network begin
  1.0, S1 → P1
  2.0, S2 → P2   
  3.0, S3 → P3  
end</code></pre><p>This can also be combined with bi-directional arrows, in which case separate tuples can be provided for the backward and forward reaction rates. These reaction networks are identical</p><pre><code class="language-julia hljs">rn1 = @reaction_network begin
 (1.0,(1.0,2.0)), S ↔ (P1,P2)  
end
rn2 = @reaction_network begin
  1.0, S → P1
  1.0, S → P2
  1.0, P1 → S   
  2.0, P2 → S
end</code></pre><h4 id="Production-and-Destruction-and-Stoichiometry"><a class="docs-heading-anchor" href="#Production-and-Destruction-and-Stoichiometry">Production and Destruction and Stoichiometry</a><a id="Production-and-Destruction-and-Stoichiometry-1"></a><a class="docs-heading-anchor-permalink" href="#Production-and-Destruction-and-Stoichiometry" title="Permalink"></a></h4><p>Sometimes reactants are produced/destroyed from/to nothing. This can be designated using either <code>0</code> or <code>∅</code>:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  2.0, 0 → X
  1.0, X → ∅
end</code></pre><p>If several molecules of the same reactant are involved in a reaction, the stoichiometry of a reactant in a reaction can be set using a number. Here, two molecules of species <code>X</code> form the dimer <code>X2</code>:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  1.0, 2X → X2
end</code></pre><p>this corresponds to the differential equation:</p><p class="math-container">\[\frac{d[X]}{dt} = -[X]^2\\
\frac{d[X2]}{dt} = \frac{1}{2!} [X]^2\]</p><p>Other numbers than 2 can be used, and parenthesis can be used to reuse the same stoichiometry for several reactants:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  1.0, X + 2(Y + Z) → XY2Z2
end</code></pre><h4 id="Variable-reaction-rates"><a class="docs-heading-anchor" href="#Variable-reaction-rates">Variable reaction rates</a><a id="Variable-reaction-rates-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-reaction-rates" title="Permalink"></a></h4><p>Reaction rates do not need to be constant, but can also depend on the current concentration of the various reactants (when, for example, one reactant can activate the production of another). For instance, this is a valid notation:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  X, Y → ∅
end</code></pre><p>and will have <code>Y</code> degraded at rate</p><p class="math-container">\[\frac{d[Y]}{dt} = -[X][Y]\]</p><p>Note that this is actually equivalent to the reaction</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  1.0, X + Y → X
end</code></pre><p><em>except</em> that the latter will be classified as <a href="../../api/catalyst_api/#Catalyst.ismassaction"><code>ismassaction</code></a> and the former will not, which can impact optimizations used in generating <code>JumpSystem</code>s. For this reason, it is recommended to use the latter representation when possible.</p><p>Most expressions and functions are valid reaction rates, e.g.:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  2.0*X^2, 0 → X + Y
  gamma(Y)/5, X → ∅
  pi*X/Y, Y → ∅
end</code></pre><p>but please note that user-defined functions cannot be called directly (see later section <a href="../advanced/#User-defined-functions-in-reaction-rates">User defined functions in reaction rates</a>).</p><h4 id="Defining-parameters"><a class="docs-heading-anchor" href="#Defining-parameters">Defining parameters</a><a id="Defining-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-parameters" title="Permalink"></a></h4><p>Parameter values do not need to be set when the model is created. Components can be designated as symbolic parameters by declaring them at the end:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  p, ∅ → X
  d, X → ∅
end p d</code></pre><p>Parameters can only exist in the reaction rates (where they can be mixed with reactants). All variables not declared after <code>end</code> will be treated as a chemical species, and may lead to undefined behavior if unchanged by <em>all</em> reactions.</p><h4 id="Naming-the-generated-ReactionSystem"><a class="docs-heading-anchor" href="#Naming-the-generated-ReactionSystem">Naming the generated <code>ReactionSystem</code></a><a id="Naming-the-generated-ReactionSystem-1"></a><a class="docs-heading-anchor-permalink" href="#Naming-the-generated-ReactionSystem" title="Permalink"></a></h4><p>ModelingToolkit uses system names to allow for compositional and hierarchical models. To specify a name for the generated <code>ReactionSystem</code> via the <code>reaction_network</code> macro, just place the name before <code>begin</code>:</p><pre><code class="language-julia hljs">rn = @reaction_network production_degradation begin
  p, ∅ → X
  d, X → ∅
end p d
ModelingToolkit.nameof(rn) == :production_degradation</code></pre><h4 id="Pre-defined-functions"><a class="docs-heading-anchor" href="#Pre-defined-functions">Pre-defined functions</a><a id="Pre-defined-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Pre-defined-functions" title="Permalink"></a></h4><p>Hill functions and a Michaelis-Menten function are pre-defined and can be used as rate laws. Below, the pair of reactions within <code>rn1</code> are equivalent, as are the pair of reactions within <code>rn2</code>:</p><pre><code class="language-julia hljs">rn1 = @reaction_network begin
  hill(X,v,K,n), ∅ → X
  v*X^n/(X^n+K^n), ∅ → X
end v K n
rn2 = @reaction_network begin
  mm(X,v,K), ∅ → X
  v*X/(X+K), ∅ → X
end v K</code></pre><p>Repressor Hill (<code>hillr</code>) and Michaelis-Menten (<code>mmr</code>) functions are also provided:</p><pre><code class="language-julia hljs">rn1 = @reaction_network begin
  hillr(X,v,K,n), ∅ → X
  v*K^n/(X^n+K^n), ∅ → X
end v K n
rn2 = @reaction_network begin
  mmr(X,v,K), ∅ → X
  v*K/(X+K), ∅ → X
end v K</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../using_catalyst/">« Using Catalyst</a><a class="docs-footer-nextpage" href="../models/">Model Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Tuesday 31 August 2021 19:11">Tuesday 31 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
