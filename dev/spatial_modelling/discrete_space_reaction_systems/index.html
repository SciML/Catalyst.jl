<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to Spatial Modelling with Catalyst · Catalyst.jl</title><meta name="title" content="Introduction to Spatial Modelling with Catalyst · Catalyst.jl"/><meta property="og:title" content="Introduction to Spatial Modelling with Catalyst · Catalyst.jl"/><meta property="twitter:title" content="Introduction to Spatial Modelling with Catalyst · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/spatial_modelling/discrete_space_reaction_systems/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/spatial_modelling/discrete_space_reaction_systems/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/spatial_modelling/discrete_space_reaction_systems/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/coupled_non_crn_models/">Coupled non-reaction network equations to models</a></li><li><a class="tocitem" href="../../model_creation/events/">Modelling Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with Conservation Laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stoichiometries</a></li><li><a class="tocitem" href="../../model_creation/functional_parameters/">Inputs and time-dependent (or functional) parameters</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing Model Properties</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related Functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-14" type="checkbox"/><label class="tocitem" for="menuitem-3-14"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, Generative, Modelling of a Linear Pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/noise_modelling_approaches/">Approaches for modelling system noise</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation Plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for Performant ODE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for Performant SDE Simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a Periodic Event During ODE and Jump Simulations</a></li><li><a class="tocitem" href="../../model_simulation/examples/activation_time_distribution_measurement/">Measuring the Distribution of System Activation Times</a></li><li><a class="tocitem" href="../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Network Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../network_analysis/odes/">Decomposing the Reaction Network ODEs</a></li><li><a class="tocitem" href="../../network_analysis/crn_theory/">Chemical Reaction Network Theory</a></li><li><a class="tocitem" href="../../network_analysis/network_properties/">Caching of Network Properties in <code>ReactionSystems</code></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing Model Steady State Properties with DynamicalSystems.jl</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/examples/nullcline_plotting/">Plotting Nullclines and Steady States in Phase Space</a></li><li><a class="tocitem" href="../../steady_state_functionality/examples/bifurcationkit_periodic_orbits/">Computing Periodic Orbits (Oscillations) Using BifurcationKit.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/examples/bifurcationkit_codim2/">Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for Non-data Fitting Purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox" checked/><label class="tocitem" for="menuitem-8"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Introduction to Spatial Modelling with Catalyst</a><ul class="internal"><li><a class="tocitem" href="#spatial_dspace_modelling_intro_example"><span>Basic example of a spatial simulation on a discrete domain</span></a></li><li><a class="tocitem" href="#spatial_dspace_modelling_intro_spatial_reactions"><span>Spatial reactions</span></a></li><li><a class="tocitem" href="#spatial_dspace_modelling_intro_dspaces"><span>Defining discrete spatial domains</span></a></li><li><a class="tocitem" href="#spatial_dspace_modelling_intro_simulation_inputs"><span>Non-uniform initial conditions and parameter values</span></a></li><li><a class="tocitem" href="#spatial_dspace_modelling_intro_simulation_edge_parameters"><span>Edge parameters and compartment parameters</span></a></li><li><a class="tocitem" href="#spatial_dspace_modelling_intro_limitations"><span>Spatial modelling limitations</span></a></li></ul></li><li><a class="tocitem" href="../discrete_space_simulation_structure_interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../discrete_space_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../spatial_jump_simulations/">Spatial Jump Simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/core_api/">Catalyst.jl API</a></li><li><a class="tocitem" href="../../api/network_analysis_api/">Network analysis and representations</a></li></ul></li><li><a class="tocitem" href="../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Spatial modelling</a></li><li class="is-active"><a href>Introduction to Spatial Modelling with Catalyst</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction to Spatial Modelling with Catalyst</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/spatial_modelling/discrete_space_reaction_systems.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="spatial_dspace_modelling_intro"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro">Introduction to Spatial Modelling with Catalyst</a><a id="spatial_dspace_modelling_intro-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro" title="Permalink"></a></h1><p>Catalyst supports the expansion of non-spatial <a href="../../api/core_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a>s (created using e.g. the <code>@reaction_network</code> DSL) to spatial domains. Spatial simulation of Catalyst models is a work in progress. Currently, the following is supported:</p><ul><li>Spatial ODE and Jump simulations.</li><li>Discrete spatial domains.</li><li>Constant-rate transportation reactions (species moving spatially at constant rates). </li></ul><p>Features for which support is planned in future updates include:</p><ul><li>Models on continuous domains with automatic discretisation (these models can already be simulated if the user provides a discretisation).</li><li>SDE simulations.</li><li>Transport reactions with non-constant rates as well as more general spatial reactions.</li></ul><p>This tutorial introduces spatial modelling on discrete domains. It describes the basics of creating and simulating such models. To do so, it uses ODE simulations as examples. Additional tutorials provide further details on how to interact with <a href="../discrete_space_simulation_plotting/#dspace_simulation_plotting">spatial simulation structures</a> and <a href="../discrete_space_simulation_plotting/#dspace_simulation_plotting">plot spatial simulations</a>, and also provide further details on <a href="../spatial_ode_simulations/#spatial_dspace_ode_simulations">ODE</a> and <a href="../spatial_jump_simulations/#spatial_dspace_jump_simulations">jump</a> simulations, respectively.</p><h2 id="spatial_dspace_modelling_intro_example"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_example">Basic example of a spatial simulation on a discrete domain</a><a id="spatial_dspace_modelling_intro_example-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_example" title="Permalink"></a></h2><p>To perform discrete-space spatial simulations, the user must first define a <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a>. These combine:</p><ul><li>A (non-spatial) <code>ReactionSystem</code>(@ref) model (created using standard Catalyst syntax).</li><li>A vector of spatial reactions, describing how species can move spatially across the domain.</li><li>A space defining the spatial domain&#39;s compartments and how they are connected.</li></ul><p>Here, as an example, we will simulate a spatial <a href="../../model_creation/examples/basic_CRN_library/#basic_CRN_library_two_states">two-state model</a>. To do so, we first define our (non-spatial) model, the spatial reactions, and the space. These are then bundled into a <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a>.</p><pre><code class="language-julia hljs">using Catalyst
two_state_model = @reaction_network begin
    (k1,k2), X1 &lt;--&gt; X2
end
diffusion_rx = @transport_reaction D X1
space = CartesianGrid((5,5))
dsrs = DiscreteSpaceReactionSystem(two_state_model, [diffusion_rx], space)</code></pre><p>This model contains:</p><ul><li>A single spatial reaction, a transport reaction where <span>$X1$</span> moves at constant rate <span>$D$</span> between adjacent compartments.</li><li>A 2d Cartesian grid of 5x5 compartments to simulate our model on.</li></ul><p>More details on spatial reactions are available <a href="#spatial_dspace_modelling_intro_spatial_reactions">here</a>. In addition to Cartesian grid spaces (in 1, 2, and 3 dimensions), masked and unstructured (graph) spaces are also supported. The different discrete space types described in more detail <a href="#spatial_dspace_modelling_intro_dspaces">here</a>.</p><p>Once created, <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a>s can be used as input to various problem types, which then can be simulated using the same syntax as non-spatial models. Here, we prepare an ODE simulation by creating an <code>ODEProblem</code>:</p><pre><code class="language-julia hljs">u0 = [:X1 =&gt; rand(5, 5), :X2 =&gt; 2.0]
tspan = (0.0, 10.0)
ps = [:k1 =&gt; 1.0, :k2 =&gt; 2.0, :D =&gt; 0.2]
oprob = ODEProblem(dsrs, u0, tspan, ps)</code></pre><p>In this example we used non-uniform values for <span>$X1$</span>&#39;s initial condition, but uniform values for the remaining initial condition and parameter values. More details of uniform and non-uniform initial conditions and parameter values are provided <a href="#spatial_dspace_modelling_intro_simulation_inputs">here</a>. We also note that the diffusion reaction introduces a new parameter, <span>$D$</span> (determining <span>$X1$</span>&#39;s diffusion rate), whose value must be designated in the parameter vector. </p><p>We can now simulate our model:</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault
sol = solve(oprob)</code></pre><p>We note that simulations of spatial models are often computationally expensive. Advice on the performance of spatial ODE simulations is provided <a href="../spatial_ode_simulations/#spatial_dspace_ode_simulations_solvers">here</a>. </p><p>Finally, we can access &quot;<span>$X1$</span>&#39;s value across the simulation using</p><pre><code class="language-julia hljs">spat_getu(sol, :X1, dsrs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">20-element Vector{Matrix{Float64}}:
 [0.3246219579423528 0.27871065141986917 … 0.4032600027146279 0.580455760691639; 0.563287025962657 0.2465272997495419 … 0.4527781869196049 0.37096368662900103; … ; 0.7417037705492674 0.8801306544712032 … 0.3657973342465436 0.09734282590668963; 0.8107259388363596 0.2744059439977691 … 0.9274572389985133 0.5577023537368517]
 [0.4826181075556594 0.4382373024007739 … 0.5581622578722858 0.7225870001422873; 0.7061222479211409 0.4185508573356389 … 0.6020558999948389 0.5252448128240902; … ; 0.8818550309679649 1.0065991016817875 … 0.5253721387230759 0.2694137089680128; 0.9412236310799331 0.4438266608660677 … 1.0457466745886843 0.7033193438352633]
 [0.7145287850588893 0.6726981241513353 … 0.7854996053589585 0.9309433660370549; 0.9158025211296913 0.67092162819625 … 0.8210429406229602 0.7515795556356129; … ; 1.0873434208156105 1.1918144215222868 … 0.7594834795452217 0.5223381696345546; 1.1325928389939588 0.6929060276262359 … 1.2189350455834307 0.9168070142603626]
 [0.9411031031941726 0.9022321476958316 … 1.0075390753042912 1.1339455418417914; 1.1205700062616608 0.9175074057214999 … 1.0347122945145888 0.972460624123247; … ; 1.2877053225662618 1.3719163733448154 … 0.988088071783341 0.7701056345905836; 1.319115067233769 0.9370852522619731 … 1.3871034473212278 1.1249041532449546]
 [1.1457381847294201 1.110159620081537 … 1.207955459286415 1.3162885408825513; 1.3051760255267408 1.1406268158968453 … 1.227175540241859 1.1715297067076476; … ; 1.4680541878331357 1.5330884456202956 … 1.1944992148373619 0.9949614728975857; 1.4866943965074337 1.1590915028792053 … 1.536994438722646 1.3120596680734782]
 [1.3063608861140181 1.2741215887909725 … 1.3650606263692036 1.457842737241203; 1.4493870342179094 1.3167320933362743 … 1.377420391840143 1.3271351478715945; … ; 1.608738819862819 1.6573011712391044 … 1.3565653463352432 1.1730338378295542; 1.6167719253600552 1.3356086983841775 … 1.6514068769313248 1.4577805352996016]
 [1.4208318459068283 1.391875084273643 … 1.4766953282015363 1.5564697344352363; 1.5510435272892062 1.443837682047514 … 1.4833071739032135 1.4371142784189221; … ; 1.7077804377655346 1.7425820029596004 … 1.472221863742192 1.3020904551711434; 1.7073352918596423 1.4645496855266833 … 1.72824538768369 1.5599743110399975]
 [1.494070760354904 1.4682831971042252 … 1.5476167286562563 1.6165823847901577; 1.614534548049873 1.5272868464718123 … 1.5494868503556574 1.5062756708502656; … ; 1.7694897647042738 1.7929154677836756 … 1.5464295801124646 1.3873949341280443; 1.762447699344425 1.5510254998796034 … 1.7712302583740729 1.6231685042352009]
 [1.5370663681924548 1.5144009798003202 … 1.5885064171261452 1.6481172022037065; 1.6498598910128042 1.578713526308262 … 1.5863963664378655 1.5453745172644895; … ; 1.8034972351948695 1.8172491367991916 … 1.590160106081929 1.4407727977616769; 1.7913127018230768 1.6064716854022718 … 1.788893244388777 1.657487714284915]
 [1.5606021166709036 1.5410950615375405 … 1.6098223374054954 1.6609001276609852; 1.6669277070247068 1.6092801474512657 … 1.6043303360054597 1.5649938073159178; … ; 1.8192149780231994 1.8244863420270157 … 1.6140901214317127 1.4737504458845248; 1.8030795319746784 1.6419074783158856 … 1.789868708834103 1.6728920968768617]
 [1.5734122476035326 1.5571743899967596 … 1.619974393384485 1.662871086858925; 1.6737846065720123 1.6278443819679516 … 1.6116295479781924 1.5737023995616322; … ; 1.8241636046136067 1.8218423052980726 … 1.626785231264497 1.4956324074790601; 1.8051808129210383 1.6661151871858717 … 1.7812321321461406 1.6774095341366944]
 [1.5813262782403281 1.5684807616295457 … 1.6244854596674112 1.6593114065083692; 1.6758010427855183 1.6401054761199128 … 1.613862351348061 1.577225048359467; … ; 1.8232317188045097 1.8141491589775902 … 1.6338671356401948 1.5125498815184857; 1.8025935121259018 1.6847171150952787 … 1.767820375748668 1.6763604370491205]
 [1.5877428752195202 1.578350537597459 … 1.626438743324439 1.6532238855500692; 1.6760504700291672 1.649171019351591 … 1.6142415131995704 1.5788937221494295; … ; 1.8190650845904943 1.804160879852545 … 1.6385017380122497 1.5279953017267107; 1.798162670737417 1.7007035435414803 … 1.7524848362720826 1.672768092040353]
 [1.5944079414917514 1.5883684372461393 … 1.6272351611309803 1.6460603620611491; 1.6760067858682688 1.6563775740959483 … 1.6143657059737584 1.58042683615743; … ; 1.81275068923163 1.7931890606332075 … 1.6421779845212303 1.543627007073905; 1.7932345221277133 1.7151765397473333 … 1.7367274585762835 1.6681006139903058]
 [1.6022005371052987 1.5991341343442764 … 1.6273579991415863 1.638453929054534; 1.6762404023254205 1.6621095046917527 … 1.614963487548786 1.5827183804943472; … ; 1.8044809881422303 1.781707628645322 … 1.6454878905636623 1.5600906818013016; 1.7882580231519012 1.7280821496532761 … 1.7213253541037559 1.6630181395152883]
 [1.6116040104297147 1.6106938863201155 … 1.6269410334540786 1.630843983180414; 1.6768911193748695 1.6663437491642479 … 1.6164151843844223 1.586386321365788; … ; 1.7940889921803922 1.7698393085989184 … 1.6486549839827356 1.5774400795886572; 1.7831766618019858 1.738564296868198 … 1.7069081892406217 1.6579809668007914]
 [1.6224035458129964 1.622290856821343 … 1.6262005887457567 1.624131473049824; 1.6778418168793872 1.6689559762291857 … 1.6188931258890893 1.5917715431689725; … ; 1.7818927017099797 1.7580028836321149 … 1.651710802122648 1.5946630587357655; 1.7777070459705817 1.7450275159856379 … 1.694642697055446 1.653770946524015]
 [1.6325117489872563 1.631854291052064 … 1.6256462458229317 1.6197405617952854; 1.6787047479855892 1.6700256816104377 … 1.6218952344415025 1.5979266099239249; … ; 1.7700668892682636 1.7477078025092059 … 1.654296314006538 1.6088424625225628; 1.7719812597318825 1.7464746740491108 … 1.6862207893950418 1.6513542083247017]
 [1.6399687581016686 1.6386268487351037 … 1.6255149675076879 1.6176455800210965; 1.6793974426581026 1.669374703988517 … 1.6243839353034664 1.603289480869139; … ; 1.7603845051380194 1.7395175688294626 … 1.655692591337498 1.6186415426525131; 1.7665019156145538 1.7445375773727578 … 1.6815527091814269 1.6503794331757258]
 [1.6417774604527866 1.639870158454008 … 1.6257714509012937 1.6176159385843623; 1.6794592368201007 1.6702722607842926 … 1.6253366684276236 1.6046696135929819; … ; 1.7586935030555362 1.7383028766974855 … 1.6566319187718694 1.620701771406652; 1.7654223540391794 1.7442073232862096 … 1.6806550759975414 1.6506302859783557]</code></pre><p>and plot the simulation using</p><pre><code class="language-julia hljs">import CairoMakie
dspace_animation(sol, :X1, dsrs, &quot;dspace_simulation.mp4&quot;)</code></pre><p><video src="../dspace_simulation.mp4" controls="true" title><a href="../dspace_simulation.mp4"></a></video> More information on how to retrieve values from spatial simulations can be found <a href="../discrete_space_simulation_structure_interaction/#dspace_simulation_structure_interaction_simulation_species">here</a>, and for plotting them, <a href="../discrete_space_simulation_plotting/#dspace_simulation_plotting">here</a>. Finally, a list of functions for querying <code>DiscreteSpaceReactionSystems</code> for various properties can be found <a href="../../api/core_api/#api_dspace_simulations">here</a>.</p><h2 id="spatial_dspace_modelling_intro_spatial_reactions"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_spatial_reactions">Spatial reactions</a><a id="spatial_dspace_modelling_intro_spatial_reactions-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_spatial_reactions" title="Permalink"></a></h2><p>Spatial reactions describe reaction events which involve species across two connected compartments. Currently, only so-called <em>transportation reactions</em> are supported. These consist of:</p><ul><li>A rate at which the reaction occurs. As for non-spatial reactions, this can be any expression. However, currently, it may only consist of parameters and other constants. </li><li>A single species which is transported from one compartment to an adjacent one.</li></ul><p>At the occurrence of a transport reaction, the specific species moves to the adjacent compartment. Many common spatial models can be represented using transport reactions only. These can model phenomena such as diffusion or constant flux. A transportation reaction can be created using the <code>@transportation_reaction</code> macro. E.g. above we used</p><pre><code class="language-julia hljs">diffusion_rx = @transport_reaction D X1</code></pre><p>to create a reaction where species <span>$X$</span> moves at a constant rate <span>$D$</span> between adjacent compartments (in the ODE this creates terms <span>$D\cdot X1_i$</span>, where <span>$X1_i$</span> is the concentration of <span>$X1$</span> in compartment <span>$i$</span>). Transport reactions may have rates depending on several parameters. E.g. to model a system with two species <span>$X1$</span> and <span>$X2$</span>, where both species are transported at a rate which depends both on the species, but also on some non-uniform parameter which is unique to each connection (e.g. representing the area connecting two cells in a tissue) we could do:</p><pre><code class="language-julia hljs">dr_X1 = @transport_reaction D1*a X1
dr_X2 = @transport_reaction D2*a X2</code></pre><div class="admonition is-info" id="Note-182551a47e8f664b"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-182551a47e8f664b" title="Permalink"></a></header><div class="admonition-body"><p>Any species which occurs is occurs in a transport reaction that is used to construct a <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a> must also occur in the corresponding non-spatial <a href="../../api/core_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a>.</p></div></div><h3 id="spatial_dspace_modelling_intro_spatial_reactions_programmatic"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_spatial_reactions_programmatic">Creating transport reactions programmatically</a><a id="spatial_dspace_modelling_intro_spatial_reactions_programmatic-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_spatial_reactions_programmatic" title="Permalink"></a></h3><p>If models are created <a href="../../model_creation/programmatic_CRN_construction/#programmatic_CRN_construction">programmatically</a> it is also possible to create transportation reactions programmatically. To do so, use the <code>TransportReaction</code> constructor, providing first the rate and then the transported species:</p><pre><code class="language-julia hljs">@variables t
@species X1(t) X2(t)
@parameters k1 k2 D [edgeparameter=true]
tr_X = TransportReaction(D, X1)</code></pre><p>Note that in this example, we specifically designate <span>$D$</span> as an <a href="#spatial_dspace_modelling_intro_simulation_edge_parameters">edge parameter</a>.</p><h2 id="spatial_dspace_modelling_intro_dspaces"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_dspaces">Defining discrete spatial domains</a><a id="spatial_dspace_modelling_intro_dspaces-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_dspaces" title="Permalink"></a></h2><p>Discrete spatial domains can represent:</p><ol><li>Systems which are composed of a (finite number of) compartments, where each compartment can be considered well-mixed (e.g. can be modelled non-spatially) and where (potentially) species can move between adjacent compartments. Tissues, where each compartment corresponds to a biological cell, are examples of such systems.</li><li>Systems that are continuous in nature, but have been approximated as a discrete domain. Future Catalyst updates will include the ability for the definition, and automatic discretisation, of continuous domains. Currently, however, the user has to perform this discretisation themselves.</li></ol><p>Catalyst supports three distinct types of discrete spaces:</p><ul><li><a href="#spatial_dspace_modelling_intro_dspaces_cartesian">Cartesian spaces</a>. These are grids where each grid point corresponds to a compartment. Spatial transportation is permitted between adjacent compartments.</li><li><a href="#spatial_dspace_modelling_intro_dspaces_masked">Masked spaces</a>. In these grids, only a subset of the grid point actually corresponds to compartments. Spatial transportation is permitted between adjacent compartments.</li><li><a href="#spatial_dspace_modelling_intro_dspaces_graph">Unstructured (or graph) spaces</a>. These are defined by graphs, where vertices correspond to compartments and edges connect adjacent compartments.</li></ul><p>Here, Cartesian spaces are a subset of the masked spaces, which are a subset of the unstructured spaces. If possible, it is advantageous to use as narrow a space definition as possible (this may both improve simulation performance and simplify syntax). Cartesian and masked spaces can be defined as one, two, and three-dimensional. By default, these spaces assume that diagonally neighbouring compartments are non-adjacent (do not permit direct movement of species in between themselves). To change this, provide the <code>diagonally_adjacent = true</code> argument to your <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a> when it is created.</p><h3 id="spatial_dspace_modelling_intro_dspaces_cartesian"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_dspaces_cartesian">Defining Cartesian spaces</a><a id="spatial_dspace_modelling_intro_dspaces_cartesian-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_dspaces_cartesian" title="Permalink"></a></h3><p>A Cartesian space is defined using the <code>CartesianGrid</code> function, which takes a single argument. For a 1d grid, simply provide the length of the grid as a single argument:</p><pre><code class="language-julia hljs">cgrid_1d = CartesianGrid(5)</code></pre><p>For 2d and 3d grids, we instead provide a Tuple with the length of the grid in each dimension:</p><pre><code class="language-julia hljs">cgrid_2d = CartesianGrid((3, 9))
cgrid_3d = CartesianGrid((2, 4, 8))</code></pre><h3 id="spatial_dspace_modelling_intro_dspaces_masked"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_dspaces_masked">Defining masked spaces</a><a id="spatial_dspace_modelling_intro_dspaces_masked-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_dspaces_masked" title="Permalink"></a></h3><p>Masked spaces are defined through 1d, 2d, or 3d Boolean arrays. Each position in the array is <code>true</code> if it corresponds to a compartment, and <code>false</code> if it does not. E.g. to define a 1d grid corresponding to two disjoint sets, each with 3 compartments, use:</p><pre><code class="language-julia hljs">rgrid_1d = [true, true, true, false, true, true, true]</code></pre><p>To define a 2d grid corresponding to the shape of an (laying) &quot;8&quot;, we can use:</p><pre><code class="language-julia hljs">rgrid_2d = [
    true  true  true  true  true;
    true  false true  false true;
    true  true  true  true  true
]</code></pre><p>Finally, a 4x5x6 3d grid of randomly distributed compartments can be created using:</p><pre><code class="language-julia hljs">rgrid_3d = rand([true, false], 4, 5, 6)</code></pre><h3 id="spatial_dspace_modelling_intro_dspaces_graph"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_dspaces_graph">Defining unstructured spaces</a><a id="spatial_dspace_modelling_intro_dspaces_graph-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_dspaces_graph" title="Permalink"></a></h3><p>To define unstructured spaces, we must first import the <a href="https://github.com/JuliaGraphs/Graphs.jl">Graphs.jl</a> package. Next, we can either use some <a href="https://juliagraphs.org/Graphs.jl/stable/core_functions/simplegraphs_generators/#Generators-for-common-graphs">pre-defined formula for building graphs</a>, or <a href="https://juliagraphs.org/Graphs.jl/stable/first_steps/construction/">build a graph from scratch</a>. Here we create a cyclic graph (where each compartment is connected to exactly two other compartments):</p><pre><code class="language-julia hljs">using Graphs
cycle_graph(7)</code></pre><p>Since graphs can represent any network of connected compartments, they do not have dimensions (like Cartesian or masked spaces). Another feature of graph spaces is that they can have non-symmetric connections, i.e. pairs of compartments where spatial movement of species is only permitted in one direction (in practice, this can be done for Cartesian and masked spaces as well, by <a href="#spatial_dspace_modelling_intro_simulation_inputs">defining non-uniform spatial rates</a> and setting them to zero in one direction). This can be done by using a <a href="https://juliagraphs.org/Graphs.jl/dev/algorithms/digraph/"><em>directed graph</em></a> as input. E.g. here we define a directed cyclic graph, where movement is only allowed in one direction of the cycle:</p><pre><code class="language-julia hljs">cycle_digraph(7)</code></pre><h2 id="spatial_dspace_modelling_intro_simulation_inputs"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_simulation_inputs">Non-uniform initial conditions and parameter values</a><a id="spatial_dspace_modelling_intro_simulation_inputs-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_simulation_inputs" title="Permalink"></a></h2><p>For spatial models, initial conditions and parameter values are provided similarly as for non-spatial models. Wherever a single value is provided, it is used <em>uniformly</em> across the space. E.g. if we, for our <a href="#spatial_dspace_modelling_intro_example">previous two-state model</a>, set</p><pre><code class="language-julia hljs">u0 = [:X1 =&gt; 1.0, :X2 =&gt; 2.0]
ps = [:k1 =&gt; 1.0, :k2 =&gt; 2.0, :D =&gt; 0.2]</code></pre><p>The initial condition will be <span>$1.0$</span> for <span>$X1$</span> across compartments, and <span>$2.0$</span> for <span>$X2$</span>. Furthermore, for each simulation, in each compartment, the value of <span>$1.0$</span> will be used for <span>$k1$</span> and <span>$2.0$</span> for <span>$k2$</span>. Finally, the transportation rate of <span>$X1$</span> (set by the parameter <span>$D$</span>) will be <span>$0.2$</span> across all connections. To set non-uniform values, non-scalar values must be provided in the map. How to do this depends on how the <a href="#spatial_dspace_modelling_intro_dspaces">space was defined</a>. Furthermore, some parameters that are part of spatial reactions may have their value tied to <em>connections between compartments</em>, rather than compartments (we call these <em>edge parameters</em>). These are handled slightly differently. How to designate parameters as either <em>edge parameters</em> or <em>compartment parameters</em> is described <a href="#spatial_dspace_modelling_intro_simulation_edge_parameters">here</a>.</p><p>Below we describe how to set non-uniform values in the various cases.</p><h3 id="spatial_dspace_modelling_intro_simulation_inputs_cartesian"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_simulation_inputs_cartesian">Non-uniform compartment values for Cartesian spaces</a><a id="spatial_dspace_modelling_intro_simulation_inputs_cartesian-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_simulation_inputs_cartesian" title="Permalink"></a></h3><p>To provide non-uniform values across a Cartesian space, simply provide the values in an array of the same dimension and size as the Cartesian space. E.g. for a 5x10 Cartesian space:</p><pre><code class="language-julia hljs">ccart_dspaces = CartesianGrid((5, 10))</code></pre><p>random values (uniformly distributed between <span>$0$</span> and <span>$1$</span>) can be provided using</p><pre><code class="language-julia hljs">[:X1 =&gt; rand(5, 10), :X2 =&gt; 10.0]</code></pre><p>Non-uniform values for parameters (which values are tied to compartments) are provided similarly.</p><h3 id="spatial_dspace_modelling_intro_simulation_inputs_masked"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_simulation_inputs_masked">Non-uniform compartment values for masked spaces</a><a id="spatial_dspace_modelling_intro_simulation_inputs_masked-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_simulation_inputs_masked" title="Permalink"></a></h3><p>Non-uniform values for masked spaces are provided in the same manner as for Cartesian spaces (however, values at coordinates that do not hold compartments are ignored). E.g. To provide random values for a masked space contained within a 5x10 Cartesian space we can again set:</p><pre><code class="language-julia hljs">[:X1 =&gt; rand(5, 10), :X2 =&gt; 10.0]</code></pre><p>If we want, it is also possible to provide the values as a <a href="https://github.com/JuliaSparse/SparseArrays.jl"><em>sparse array</em></a> with values only in the coordinates that corresponds to compartments.</p><h3 id="spatial_dspace_modelling_intro_simulation_inputs_graphs"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_simulation_inputs_graphs">Non-uniform compartment values for unstructured spaces</a><a id="spatial_dspace_modelling_intro_simulation_inputs_graphs-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_simulation_inputs_graphs" title="Permalink"></a></h3><p>In graphs (which are used to represent unstructured spaces) each vertex (i.e. compartment) has a specific index. To set non-uniform values for unstructured spaces, provide a vector where the <span>$i$</span>&#39;th value corresponds to the value in the compartment with index <span>$i$</span> in the graph. E.g. for a graph with 5 vertices, where we want <span>$X$</span> to be zero in all compartments bar one (where it is <span>$1.0$</span>) we use:</p><pre><code class="language-julia hljs">[:X1 =&gt; [0.0, 0.0, 0.0, 0.0, 1.0], :X2 =&gt; 10.0]</code></pre><h3 id="spatial_dspace_modelling_intro_simulation_inputs_edge_parameters"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_simulation_inputs_edge_parameters">Non-uniform values for edge-parameters</a><a id="spatial_dspace_modelling_intro_simulation_inputs_edge_parameters-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_simulation_inputs_edge_parameters" title="Permalink"></a></h3><p>Adjacent compartments are connected by edges (with which compartments are connected by edges being defined by the space). For unstructured spaces, it is possible (if a directed graph was used) to have edges from one compartment to another, but not in the opposite direction. For a space with <span>$N$</span> compartments, edge values are set by a <span>$NxN$</span> matrix, where value <span>$(i,j)$</span> corresponds to the parameter&#39;s values in the edge going <em>from</em> compartment <span>$i$</span> <em>to</em> compartment <span>$j$</span>. This matrix can be either <a href="https://docs.julialang.org/en/v1/stdlib/SparseArrays/">sparse or non-sparse</a>. In the latter cases, values corresponding to non-existing edges are ignored. </p><p>Let&#39;s consider a 1d Cartesian space with 4 compartments. Here, an edge parameter&#39;s values are provided in a 4x4 matrix. For <a href="#spatial_dspace_modelling_intro_example">the Brusselator model described previously</a>, <span>$D$</span>&#39;s value was tied to edges. If we wish to set the value of <span>$D$</span> to various values between <span>$0.1$</span> and <span>$0.4$</span> we can do:</p><pre><code class="language-julia hljs">ps = [:k1 =&gt; 1.0, :k2 =&gt; 2.0,
      :D =&gt; [
        0.0 0.1 0.0 0.0;
        0.1 0.0 0.2 0.0;
        0.0 0.2 0.0 0.3;
        0.0 0.0 0.3 0.0]
]</code></pre><p>Here, the value at index <span>$i,j$</span> corresponds to <span>$D$</span>&#39;s value in the edge from compartment <span>$i$</span> to compartment <span>$j$</span>. <code>0.0</code> is used for elements that do not correspond to an edge. The <a href="../../api/core_api/#Catalyst.make_edge_p_values"><code>make_edge_p_values</code></a> and <a href="../../api/core_api/#Catalyst.make_directed_edge_values"><code>make_directed_edge_values</code></a> provide convenient interfaces for generating non-uniform edge parameter values.</p><h2 id="spatial_dspace_modelling_intro_simulation_edge_parameters"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_simulation_edge_parameters">Edge parameters and compartment parameters</a><a id="spatial_dspace_modelling_intro_simulation_edge_parameters-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_simulation_edge_parameters" title="Permalink"></a></h2><p>Parameters can be divided into <em>edge parameters</em> and <em>compartment parameters</em> (initial condition values are always tied to compartments). Here, edge parameters have their values tied to edges, while compartment parameters have their values tied to compartments. All parameters that are part of the rates (or stoichiometries) of non-spatial reactions must be compartment parameters. Parameters that are part of spatial reactions can be either compartment parameters or edge parameters. When a spatial reaction&#39;s rate is computed, edge parameters fetch their values for from the edge of the transition, and compartment parameters from the compartment <em>from which the edge originates</em>.</p><p>When a <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a> is created, its parameters is the union of all parameters occurring in the (non-spatial) <a href="../../api/core_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a> and in all spatial reactions. By default, parameters occurring only in spatial reactions are considered edge parameters (and if they occur in the non-spatial <a href="../../api/core_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a> they are considered compartment parameters). It is, however, possible to designate a parameter specifically as an edge parameter (or not), by using the <code>edgeparameter</code> <a href="../../model_creation/dsl_advanced/#dsl_advanced_options_species_and_parameters_metadata">metadata</a>. E.g. to designate that <code>D</code> (when declared in a non-spatial <a href="../../api/core_api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a> using the DSL) is an edge parameter, not a compartment parameter, we use:</p><pre><code class="language-julia hljs">two_state_model = @reaction_network begin
    @parameters D [edgeparameter=true]
    (k1,k2), X1 &lt;--&gt; X2
end</code></pre><p>To learn the compartment and edge parameters of a <code>DiscreteSpaceReactionSystem</code>, the <a href="../../api/core_api/#Catalyst.vertex_parameters"><code>vertex_parameters</code></a> and <a href="../../api/core_api/#Catalyst.edge_parameters"><code>edge_parameters</code></a> functions can be used:</p><pre><code class="language-julia hljs">two_state_model = @reaction_network begin
    (k1,k2), X1 &lt;--&gt; X2
end
diffusion_rx = @transport_reaction D X1
space = CartesianGrid((20,20))
dsrs = DiscreteSpaceReactionSystem(two_state_model, [diffusion_rx], space)
edge_parameters(dsrs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Any}:
 D</code></pre><h2 id="spatial_dspace_modelling_intro_limitations"><a class="docs-heading-anchor" href="#spatial_dspace_modelling_intro_limitations">Spatial modelling limitations</a><a id="spatial_dspace_modelling_intro_limitations-1"></a><a class="docs-heading-anchor-permalink" href="#spatial_dspace_modelling_intro_limitations" title="Permalink"></a></h2><p>Many features which are supported for non-spatial <code>ReactionSystem</code>s are currently unsupported for <a href="../../api/core_api/#Catalyst.DiscreteSpaceReactionSystem"><code>DiscreteSpaceReactionSystem</code></a>s. This includes <a href="../../model_creation/dsl_advanced/#dsl_advanced_options_observables">observables</a>, <a href="@ref constraint_equations">algebraic and differential equations</a>, <a href="../../model_creation/compositional_modeling/#compositional_modeling">hierarchical models</a>, and <a href="../../model_creation/events/#events">events</a>. It is possible that these features will be supported in the future. Furthermore, <a href="../../model_creation/conservation_laws/#conservation_laws">removal of conserved quantities</a> is not supported when creating spatial <code>ODEProblem</code>s.</p><p>If you are using Catalyst&#39;s features for spatial modelling, please give us feedback on how we can improve these features. Additionally, just letting us know that you use these features is useful, as it helps inform us whether continued development of spatial modelling features is worthwhile. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../inverse_problems/global_sensitivity_analysis/">« Global Sensitivity Analysis</a><a class="docs-footer-nextpage" href="../discrete_space_simulation_structure_interaction/">Interfacing with Lattice Problems, Integrators, and Solutions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 18 February 2026 15:31">Wednesday 18 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
