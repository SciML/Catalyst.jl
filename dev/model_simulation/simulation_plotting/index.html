<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation plotting · Catalyst.jl</title><meta name="title" content="Simulation plotting · Catalyst.jl"/><meta property="og:title" content="Simulation plotting · Catalyst.jl"/><meta property="twitter:title" content="Simulation plotting · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/model_simulation/simulation_plotting/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/model_simulation/simulation_plotting/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/model_simulation/simulation_plotting/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with conservation laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing model properties</a></li><li><a class="tocitem" href="../../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../simulation_introduction/">Model Simulation Introduction</a></li><li class="is-active"><a class="tocitem" href>Simulation plotting</a><ul class="internal"><li><a class="tocitem" href="#simulation_plotting_options"><span>Common plotting options</span></a></li><li><a class="tocitem" href="#simulation_plotting_options_subplots"><span>Multi-plot plots</span></a></li><li><a class="tocitem" href="#simulation_plotting_options_saving"><span>Saving plots</span></a></li><li><a class="tocitem" href="#simulation_plotting_options_phasespace"><span>Phase-space plots</span></a></li></ul></li><li><a class="tocitem" href="../simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../sde_simulation_performance/">Advice for performant SDE simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Model simulation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/periodic_events_simulation/">Modelling a periodic event during ODE and jump simulations</a></li></ul></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><span class="tocitem">Spatial Modelling</span><ul><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model simulation</a></li><li class="is-active"><a href>Simulation plotting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulation plotting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/model_simulation/simulation_plotting.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="simulation_plotting"><a class="docs-heading-anchor" href="#simulation_plotting">Simulation plotting</a><a id="simulation_plotting-1"></a><a class="docs-heading-anchor-permalink" href="#simulation_plotting" title="Permalink"></a></h1><p>Catalyst uses the <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> package for performing all plots. This section provides a brief summary of some useful plotting options, while <a href="https://docs.juliaplots.org/stable/">Plots.jl&#39;s documentation</a> provides a more throughout description of how to tune your plots.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="https://github.com/MakieOrg/Makie.jl">Makie.jl</a> is a popular alternative to the Plots.jl package. While it is not used within Catalyst&#39;s documentation, it is worth considering (especially for users interested in interactivity, or increased control over their plots).</p></div></div><h2 id="simulation_plotting_options"><a class="docs-heading-anchor" href="#simulation_plotting_options">Common plotting options</a><a id="simulation_plotting_options-1"></a><a class="docs-heading-anchor-permalink" href="#simulation_plotting_options" title="Permalink"></a></h2><p>Let us consider the oscillating <a href="../../model_creation/examples/basic_CRN_library/#basic_CRN_library_brusselator">Brusselator</a> model. We have previously shown how model simulation solutions can be plotted using the <code>plot</code> function. Here we plot an ODE simulation from the Brusselator:</p><pre><code class="language-julia hljs">using Catalyst, OrdinaryDiffEq, Plots

brusselator = @reaction_network begin
    A, ∅ --&gt; X
    1, 2X + Y --&gt; 3X
    B, X --&gt; Y
    1, X --&gt; ∅
end
u0 = [:X =&gt; 1.0, :Y =&gt; 0.0]
tspan = (0.0, 50.0)
ps = [:A =&gt; 1.0, :B =&gt; 4.0]

oprob = ODEProblem(brusselator, u0, tspan, ps)
sol = solve(oprob)
plot(sol)</code></pre><img src="35ab4635.svg" alt="Example block output"/><p>Various plotting options can be provided as optional arguments to the <code>plot</code> command. Common options include:</p><ul><li><code>lw</code>: Determine plot line widths.</li><li><code>la</code>: Determine plot line&#39;s transparency (at <code>la = 0.0</code> lines are fully transparent, i.e. not visible).</li><li><code>linestyle</code>: Determines plot line style.</li><li><code>color</code>: Determines the line colours.</li><li><code>legend</code>: Determines the position of the legend/labels.</li><li><code>label</code>: Determines label texts.</li><li><code>xguide</code>, <code>yguide</code>: Determines x and y axis labels.</li><li><code>title</code>: Determines plot title.</li><li><code>legendfontsize</code>, <code>guidefontsize</code>, <code>titlefontsize</code>: Determines the font size of the labels, x and y guides, and title, respectively.</li></ul><p>Here, we re-plot our simulations, utilising some of these options (<code>legend = :none</code> is used to disable the legends).</p><pre><code class="language-julia hljs">plot(sol; lw = 4, linestyle = :dash, color = :green, xguide = &quot;Time&quot;, yguide = &quot;Concentration&quot;, guidefontsize = 14)</code></pre><img src="487c192e.svg" alt="Example block output"/><p>Note that, by default, Catalyst uses <code>xguide = &quot;t&quot;</code>. Here, however, we modify this to <code>xguide = &quot;Time&quot;</code>. We also note that the <code>color = :green</code> change both lines&#39; colours to green. To set different colours for each line, we provide these as <em>a vector without <code>,</code> in-between elements</em> (in Julia interpreted as a matrix with its first dimension equal to <code>1</code>):</p><pre><code class="language-julia hljs">plot(sol; lw = 4, color = [:green :purple])</code></pre><img src="bd48d960.svg" alt="Example block output"/><p>A full list of available colours can be found <a href="https://juliagraphics.github.io/Colors.jl/stable/namedcolors/">here</a>. A full list of possible plotting options can be found <a href="https://docs.juliaplots.org/stable/attributes/">here</a> (look at the list of various plot attributes, e.g. &quot;Series Attributes&quot;). if there is some option(s) you intend to use multiple times, you can call the <code>default</code> function using these, in which case they will be used for all subsequent plots. E.g. here:</p><pre><code class="language-julia hljs">default(framestyle = :box, grid = false)</code></pre><p>we designate a box-style frame, and remove the faint background grid, for all subsequent plots in this tutorial.</p><p>A useful option unique to Catalyst (and other DifferentialEquations.jl-based) plots is <code>idxs</code>. Its input is a vector, listing all the species (or quantities) that should be plotted. I.e.</p><pre><code class="language-julia hljs">plot(sol; idxs = [:X])</code></pre><img src="1fe2b7e4.svg" alt="Example block output"/><p>can be used to plot <code>X</code> only. When only a single argument is given, the vector form is unnecessary (e.g. <code>idxs = :X</code> could have been used instead). If symbolic species representation is used, this can be used to designate any algebraic expression(s) that should be plotted. E.g. here we plot the total concentration of <span>$X + Y$</span> throughout the simulation:</p><pre><code class="language-julia hljs">plot(sol; idxs = brusselator.X + brusselator.Y)</code></pre><img src="8ee1843b.svg" alt="Example block output"/><h2 id="simulation_plotting_options_subplots"><a class="docs-heading-anchor" href="#simulation_plotting_options_subplots">Multi-plot plots</a><a id="simulation_plotting_options_subplots-1"></a><a class="docs-heading-anchor-permalink" href="#simulation_plotting_options_subplots" title="Permalink"></a></h2><p>It is possible to save plots in variables. These can then be used as input to the <code>plot</code> command. Here, the plot command can be used to create plots containing multiple plots (by providing multiple inputs). E.g. here we plot the concentration of <code>X</code> and <code>Y</code> in separate subplots:</p><pre><code class="language-julia hljs">plt_X = plot(sol; idxs = [:X])
plt_Y = plot(sol; idxs = [:Y])
plot(plt_X, plt_Y)</code></pre><img src="2d2ac4ac.svg" alt="Example block output"/><p>When working with subplots, the <a href="https://docs.juliaplots.org/latest/layouts/"><code>layout</code></a> and <a href="https://docs.juliaplots.org/latest/generated/attributes_plot/"><code>size</code></a> options are typically useful. Here we use <code>layout</code> to put the first plot above the second one, and <code>size</code> to reshape the plot size:</p><pre><code class="language-julia hljs">plot(plt_X, plt_Y; layout = (2,1), size = (700,500))</code></pre><img src="bd740465.svg" alt="Example block output"/><h2 id="simulation_plotting_options_saving"><a class="docs-heading-anchor" href="#simulation_plotting_options_saving">Saving plots</a><a id="simulation_plotting_options_saving-1"></a><a class="docs-heading-anchor-permalink" href="#simulation_plotting_options_saving" title="Permalink"></a></h2><p>Once a plot has been saved to a variable, the <code>savefig</code> function can be used to save it to a file. Here we save our Brusselator plot simulation (the first argument) to a file called &quot;saved_plot.png&quot; (the second argument):</p><pre><code class="language-julia hljs">plt = plot(sol)
savefig(plt, &quot;saved_plot.png&quot;)</code></pre><p>The plot file type is automatically determined from the extension (if none is given, a .png file is created).</p><h2 id="simulation_plotting_options_phasespace"><a class="docs-heading-anchor" href="#simulation_plotting_options_phasespace">Phase-space plots</a><a id="simulation_plotting_options_phasespace-1"></a><a class="docs-heading-anchor-permalink" href="#simulation_plotting_options_phasespace" title="Permalink"></a></h2><p>By default, simulations are plotted as species concentrations over time. However, <a href="https://en.wikipedia.org/wiki/Phase_space#:~:text=In%20dynamical%20systems%20theory%20and,point%20in%20the%20phase%20space.">phase space</a> plots are also possible. This is done by designating the axis arguments using the <code>idxs</code> option, but providing them as a tuple. E.g. here we plot our simulation in <span>$X-Y$</span> space:</p><pre><code class="language-julia hljs">plot(sol; idxs = (:X, :Y))</code></pre><img src="84b51073.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simulation_introduction/">« Model Simulation Introduction</a><a class="docs-footer-nextpage" href="../simulation_structure_interfacing/">Interfacing problems, integrators, and solutions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Wednesday 21 August 2024 23:14">Wednesday 21 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
