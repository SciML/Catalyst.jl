<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl · Catalyst.jl</title><meta name="title" content="Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl · Catalyst.jl"/><meta property="og:title" content="Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl · Catalyst.jl"/><meta property="twitter:title" content="Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/examples/bifurcationkit_codim2/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/examples/bifurcationkit_codim2/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/examples/bifurcationkit_codim2/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../../model_creation/constraint_equations/">Coupled ODEs, Algebraic Equations, and Events</a></li><li><a class="tocitem" href="../../../model_creation/conservation_laws/">Working with Conservation Laws</a></li><li><a class="tocitem" href="../../../model_creation/parametric_stoichiometry/">Symbolic Stoichiometries</a></li><li><a class="tocitem" href="../../../model_creation/functional_parameters/">Inputs and time-dependent (or functional) parameters</a></li><li><a class="tocitem" href="../../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../../model_creation/reactionsystem_content_accessing/">Accessing Model Properties</a></li><li><a class="tocitem" href="../../../model_creation/chemistry_related_functionality/">Chemistry-related Functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, Generative, Modelling of a Linear Pathway</a></li><li><a class="tocitem" href="../../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li><li><a class="tocitem" href="../../../model_creation/examples/noise_modelling_approaches/">Approaches for modelling system noise</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../../model_simulation/simulation_plotting/">Simulation Plotting</a></li><li><a class="tocitem" href="../../../model_simulation/simulation_structure_interfacing/">Interfacing Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../../model_simulation/ode_simulation_performance/">Advice for Performant ODE Simulations</a></li><li><a class="tocitem" href="../../../model_simulation/sde_simulation_performance/">Advice for Performant SDE Simulations</a></li><li><a class="tocitem" href="../../../model_simulation/finite_state_projection_simulation/">Solving the chemical master equation using FiniteStateProjection.jl</a></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_simulation/examples/periodic_events_simulation/">Modelling a Periodic Event During ODE and Jump Simulations</a></li><li><a class="tocitem" href="../../../model_simulation/examples/activation_time_distribution_measurement/">Measuring the Distribution of System Activation Times</a></li><li><a class="tocitem" href="../../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Network Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../network_analysis/odes/">Decomposing the Reaction Network ODEs</a></li><li><a class="tocitem" href="../../../network_analysis/crn_theory/">Chemical Reaction Network Theory</a></li><li><a class="tocitem" href="../../../network_analysis/network_properties/">Caching of Network Properties in <code>ReactionSystems</code></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../dynamical_systems/">Analysing Model Steady State Properties with DynamicalSystems.jl</a></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../nullcline_plotting/">Plotting Nullclines and Steady States in Phase Space</a></li><li><a class="tocitem" href="../bifurcationkit_periodic_orbits/">Computing Periodic Orbits (Oscillations) Using BifurcationKit.jl</a></li><li class="is-active"><a class="tocitem" href>Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a><ul class="internal"><li><a class="tocitem" href="#bifurcationkit_codim2_bifdia"><span>Computing the bifurcation diagram for the Repressilator</span></a></li><li><a class="tocitem" href="#bifurcationkit_codim2_2ndpar_cont"><span>Tracking the bifurcation point w.r.t. a second parameter</span></a></li><li><a class="tocitem" href="#bifurcationkit_periodic_orbits_citation"><span>Citation</span></a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li><li><a class="tocitem" href="../../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li><a class="tocitem" href="../../../inverse_problems/behaviour_optimisation/">Optimization for Non-data Fitting Purposes</a></li><li><a class="tocitem" href="../../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../../spatial_modelling/spatial_jump_simulations/">Spatial Jump Simulations</a></li></ul></li><li><a class="tocitem" href="../../../faqs/">FAQs</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/core_api/">Catalyst.jl API</a></li><li><a class="tocitem" href="../../../api/network_analysis_api/">Network analysis and representations</a></li></ul></li><li><a class="tocitem" href="../../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Steady state analysis</a></li><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/steady_state_functionality/examples/bifurcationkit_codim2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="bifurcationkit_codim2"><a class="docs-heading-anchor" href="#bifurcationkit_codim2">Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a><a id="bifurcationkit_codim2-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcationkit_codim2" title="Permalink"></a></h1><p>Previously, we have shown how to <a href="../../bifurcation_diagrams/#bifurcation_diagrams">compute bifurcation diagrams</a> using <a href="https://github.com/bifurcationkit/BifurcationKit.jl">BifurcationKit.jl</a>. In this example, we will show how, after computing the initial diagram, we can track how the position of a bifurcation point moves as a secondary parameter is changed (so-called codimensional 2 bifurcation analysis). More information on how to track bifurcation points along secondary parameters can be found in the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/tutorials/ode/tutorialCO/#CO-oxidation-(codim-2)">BifurcationKit documentation</a>.</p><h2 id="bifurcationkit_codim2_bifdia"><a class="docs-heading-anchor" href="#bifurcationkit_codim2_bifdia">Computing the bifurcation diagram for the Repressilator</a><a id="bifurcationkit_codim2_bifdia-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcationkit_codim2_bifdia" title="Permalink"></a></h2><p>We will first compute the bifurcation diagram, using the same approach as in the <a href="../../bifurcation_diagrams/#bifurcation_diagrams">corresponding tutorial</a>. For this example, we will use the oscillating <a href="../../../model_creation/examples/basic_CRN_library/#basic_CRN_library_repressilator">Repressilator</a> model.</p><pre><code class="language-julia hljs">using Catalyst
repressilator = @reaction_network begin
    hillr(Z,v,K,n), ∅ --&gt; X
    hillr(X,v,K,n), ∅ --&gt; Y
    hillr(Y,v,K,n), ∅ --&gt; Z
    d, (X, Y, Z) --&gt; ∅
end</code></pre><p class="math-container">\[ \begin{align*}
\varnothing &amp;\xrightarrow{\frac{K^{n} v}{K^{n} + Z^{n}}} \mathrm{X} \\
\varnothing &amp;\xrightarrow{\frac{K^{n} v}{K^{n} + X^{n}}} \mathrm{Y} \\
\varnothing &amp;\xrightarrow{\frac{K^{n} v}{K^{n} + Y^{n}}} \mathrm{Z} \\
\mathrm{X} &amp;\xrightarrow{d} \varnothing \\
\mathrm{Y} &amp;\xrightarrow{d} \varnothing \\
\mathrm{Z} &amp;\xrightarrow{d} \varnothing  
 \end{align*}
 \]</p><p>Next, we create a <code>BifurcationProblem</code> for our model. We will compute the bifurcation diagram with respect to the parameter <span>$v$</span>, and plot the species <span>$X$</span> in the diagram.</p><pre><code class="language-julia hljs">using BifurcationKit
bif_par = :v
u_guess = [:X =&gt; 20.0, :Y =&gt; 15.0, :Z =&gt; 15.0]
p_start = [:v =&gt; 10.0, :K =&gt; 15.0, :n =&gt; 3, :d =&gt; 0.2]
plot_var = :X
bprob = BifurcationProblem(repressilator, u_guess, p_start, bif_par; plot_var)</code></pre><p>We compute the bifurcation diagram using the <code>bifurcationdiagram</code> function. We will compute it across the interval <span>$v \in (0,20)$</span>.</p><pre><code class="language-julia hljs">v_span = (0.0, 20.0)
opts_br = ContinuationPar(p_min = v_span[1], p_max = v_span[2])
bifdia = bifurcationdiagram(bprob, PALC(), 3, opts_br; bothside = true)</code></pre><p>Finally, we plot the bifurcation diagram.</p><pre><code class="language-julia hljs">using Plots
plot(bifdia; xguide = bif_par, yguide = plot_var, branchlabel = &quot;Continuation of steady state w.r.t. v&quot;,
    linewidthstable = 6, linewidthunstable = 3, markersize = 5)</code></pre><img src="0acdcadd.svg" alt="Example block output"/><p>We note that for small values of <span>$v$</span> the system&#39;s single steady state is stable (where the line is thicker). After a <a href="https://en.wikipedia.org/wiki/Hopf_bifurcation">Hopf</a> bifurcation (the red point), the state turns unstable (where the line is thinner). For chemical reaction networks (which mostly are well-behaved) a single unstable steady state typically corresponds to an oscillation. We can confirm that the system oscillates in the unstable region (while it reaches a stable steady state in the stable region) using simulations:</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault
p_nosc = [:v =&gt; 5.0, :K =&gt; 15.0, :n =&gt; 3, :d =&gt; 0.2]
p_osc = [:v =&gt; 15.0, :K =&gt; 15.0, :n =&gt; 3, :d =&gt; 0.2]
prob_nosc = ODEProblem(repressilator, u_guess, 80.0, p_nosc)
prob_osc = ODEProblem(repressilator, u_guess, 80.0, p_osc)
sol_nosc = OrdinaryDiffEqDefault.solve(prob_nosc)
sol_osc = OrdinaryDiffEqDefault.solve(prob_osc)
plot(plot(sol_nosc; title = &quot;v = 5&quot;), plot(sol_osc; title = &quot;v = 15&quot;), size = (1000,400), lw = 4)</code></pre><img src="d61a597c.svg" alt="Example block output"/><h2 id="bifurcationkit_codim2_2ndpar_cont"><a class="docs-heading-anchor" href="#bifurcationkit_codim2_2ndpar_cont">Tracking the bifurcation point w.r.t. a second parameter</a><a id="bifurcationkit_codim2_2ndpar_cont-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcationkit_codim2_2ndpar_cont" title="Permalink"></a></h2><p>Next, we will investigate how the Hopf bifurcation point moves (in <span>$v$</span>-<span>$X$</span> space) as a second parameter (<span>$K$</span>) is changed. To do this we will use BifurcationKit.jl&#39;s <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/library/#BifurcationKit.continuation"><code>continuation</code> function</a> (the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/dev/library/#BifurcationKit.bifurcationdiagram"><code>bifurcationdiagram</code> function</a>, which we previously have used, works by calling <code>continuation</code> recursively). We will call it on the Hopf bifurcation point. First we need to retrieve some indexes that are required to make Catalyst (which primarily indexes through symbols) work with BifurcationKit (which primarily indexes through numbers). A smoother interface for this will hopefully be added in the future.</p><pre><code class="language-julia hljs">K_idx = findfirst(isequal(repressilator.K), parameters(complete(convert(NonlinearSystem, repressilator))))
v_idx = findfirst(isequal(repressilator.v), parameters(complete(convert(NonlinearSystem, repressilator))))
K_sym = Symbol(:p, K_idx)
v_sym = Symbol(:p, v_idx)</code></pre><p>Next we designate the interval over which we wish to change <span>$K$</span>, and from this create a new <code>ContinuationPar</code>.</p><pre><code class="language-julia hljs">K_span = (0.01, 27.0)
opts_br_2 = ContinuationPar(p_min = K_span[1], p_max = K_span[2])</code></pre><p>Now we can compute the continuation of the Hopf bifurcation. First we must extract a branch from our bifurcation diagram (using <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/library/#BifurcationKit.get_branch"><code>get_branch</code></a>), as <code>continuation</code> cannot work on bifurcation diagrams directly (our bifurcation diagram consists of a single branch, which we here extract). Next, we can call <code>continuation</code> on it, designating that we wish to perform continuation from the second point on the branch (which corresponds to the Hopf bifurcation, the first point is one of the branch&#39;s two endpoints).</p><pre><code class="language-julia hljs">branch = get_branch(bifdia, ()).γ
cont_hopf = continuation(branch, 2, (@optic _[K_idx]), opts_br_2; start_with_eigen = true, bothside = true)</code></pre><p>We can now plot how the position of the bifurcation point changes with <span>$K$</span>. Here, we use <code>vars = (v_sym, :x)</code> to designate that we wish to plot (across the continuation branch) the plotting variable (<span>$X$</span>, which we designated when we created our <code>BifurcationProblem</code>) against the first parameter (<span>$v$</span>).</p><pre><code class="language-julia hljs">plot(bifdia; branchlabel = &quot;Continuation of steady state w.r.t. v, (K = 15)&quot;, linewidthstable = 6,
    linewidthunstable = 3, markersize = 5)
plot!(cont_hopf; vars = (v_sym, :x), xlimit = v_span, xguide = bif_par, yguide = plot_var,
    branchlabel = &quot;Continuation of Hopf bifurcation w.r.t. K&quot;)</code></pre><img src="3960bc4c.svg" alt="Example block output"/><p>In this case we cannot see directly which part of the <span>$K$</span> continuation branch corresponds to low values, however, for low <span>$K$</span> the Hopf bifurcation occurs for much lower values of <span>$v$</span> (and corresponds to lower steady state values of <span>$X$</span>). We can check this by e.g. re-computing the Hopf branch for <code>K_span = (0.01, 20.0)</code> and see that the rightmost part of the branch is shortened. </p><p>We can confirm that the new line corresponds to the Hopf Bifurcation point by recomputing the initial bifurcation diagram, but for a lower <span>$K$</span> value.</p><pre><code class="language-julia hljs">p_start_2 = [:v =&gt; 10.0, :K =&gt; 10.0, :n =&gt; 3, :d =&gt; 0.2]
bprob_2 = BifurcationProblem(repressilator, u_guess, p_start_2, bif_par; plot_var)
bifdia_2 = bifurcationdiagram(bprob_2, PALC(), 3, opts_br; bothside = true)
plot!(bifdia_2; xguide = bif_par, yguide = plot_var, branchlabel = &quot;Continuation of steady state w.r.t. v, (K = 10)&quot;,
    linewidthstable = 6, linewidthunstable = 3, markersize = 5)</code></pre><img src="db530e4a.svg" alt="Example block output"/><p>Here we see that the Hopf bifurcation point of the new diagram also lies on the Hopf continuation line.</p><p>Finally, we have already noted that the Hopf bifurcation splits parameter space into one part where the system oscillates and one where it doesn&#39;t. Previously we plotted the Hopf continuation in <span>$v$</span>-<span>$X$</span> space, however, it is also possible to plot it in <span>$v$</span>-<span>$K$</span> space using the <code>vars = (v_sym, K_sym)</code> argument:</p><pre><code class="language-julia hljs">xlimit = extrema(getfield.(cont_hopf.branch, v_sym))
ylimit = extrema(getfield.(cont_hopf.branch, K_sym))
plot(cont_hopf; vars = (v_sym, K_sym), xlimit, ylimit, branchlabel = &quot;Hopf bifurcation&quot;,
    xguide = &quot;v&quot;, yguide = &quot;K&quot;, lw = 6)</code></pre><img src="00f4b417.svg" alt="Example block output"/><p>Next, we colour parameter space according to whether the steady state is stable (blue) or unstable (red). We also mark two sample values (one in each region).</p><pre><code class="language-julia hljs">sample1 = (15.0, 10.0)
sample2 = (5.0, 15.0)
plot(cont_hopf; vars = (v_sym, K_sym), fillrange = ylimit[2], xguide = &quot;v&quot;, yguide = &quot;K&quot;)
plot!(cont_hopf; vars = (v_sym, K_sym), fillrange = ylimit[1], xlimit, ylimit)
scatter!(sample1; label = &quot;Oscillatory parameter set&quot;, markersize = 7)
scatter!(sample2; label = &quot;Non-oscillatory parameter set&quot;, markersize = 7)</code></pre><img src="b5705362.svg" alt="Example block output"/><p>Finally, we can perform one simulation using each of the parameter samples, confirming that one corresponds to an oscillation, while the other one does not.</p><pre><code class="language-julia hljs">ps_nosc = [:v =&gt; sample2[1], :K =&gt; sample2[2], :n =&gt; 3, :d =&gt; 0.2]
ps_osc = [:v =&gt; sample1[1], :K =&gt; sample1[2], :n =&gt; 3, :d =&gt; 0.2]
oprob_nosc = ODEProblem(repressilator, u_guess, 100.0, ps_nosc)
oprob_osc = ODEProblem(repressilator, u_guess, 100.0, ps_osc)
sol_nosc = OrdinaryDiffEqDefault.solve(oprob_nosc)
sol_osc = OrdinaryDiffEqDefault.solve(oprob_osc)
plot(plot(sol_nosc; title = &quot;No oscillation&quot;), plot(sol_osc; title = &quot;Oscillation&quot;); size = (1000, 400), lw = 4)</code></pre><img src="6cf0d1fb.svg" alt="Example block output"/><hr/><h2 id="bifurcationkit_periodic_orbits_citation"><a class="docs-heading-anchor" href="#bifurcationkit_periodic_orbits_citation">Citation</a><a id="bifurcationkit_periodic_orbits_citation-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcationkit_periodic_orbits_citation" title="Permalink"></a></h2><p>If you use BifurcationKit.jl for your work, we ask that you <strong>cite</strong> the following paper!! Open source development strongly depends on this. It is referenced on <a href="https://hal.archives-ouvertes.fr/hal-02902346">HAL-Inria</a> with <em>bibtex</em> entry <a href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/master/CITATION.bib">CITATION.bib</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bifurcationkit_periodic_orbits/">« Computing Periodic Orbits (Oscillations) Using BifurcationKit.jl</a><a class="docs-footer-nextpage" href="../../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 12 June 2025 01:29">Thursday 12 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
