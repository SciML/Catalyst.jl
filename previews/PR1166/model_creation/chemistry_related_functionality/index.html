<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Chemistry-related functionality · Catalyst.jl</title><meta name="title" content="Chemistry-related functionality · Catalyst.jl"/><meta property="og:title" content="Chemistry-related functionality · Catalyst.jl"/><meta property="twitter:title" content="Chemistry-related functionality · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/model_creation/chemistry_related_functionality/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/model_creation/chemistry_related_functionality/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/model_creation/chemistry_related_functionality/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../conservation_laws/">Working with conservation laws</a></li><li><a class="tocitem" href="../parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../reactionsystem_content_accessing/">Accessing model properties</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis in Catalyst</a></li><li class="is-active"><a class="tocitem" href>Chemistry-related functionality</a><ul class="internal"><li><a class="tocitem" href="#chemistry_functionality_compounds"><span>Modelling with compound species</span></a></li><li><a class="tocitem" href="#Balancing-chemical-reactions"><span>Balancing chemical reactions</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for performant SDE simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a periodic event during ODE and jump simulations</a></li><li><a class="tocitem" href="../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model creation and properties</a></li><li class="is-active"><a href>Chemistry-related functionality</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Chemistry-related functionality</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/model_creation/chemistry_related_functionality.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="chemistry_functionality"><a class="docs-heading-anchor" href="#chemistry_functionality">Chemistry-related functionality</a><a id="chemistry_functionality-1"></a><a class="docs-heading-anchor-permalink" href="#chemistry_functionality" title="Permalink"></a></h1><p>While Catalyst has primarily been designed around the modelling of biological systems, reaction network models are also common in chemistry. This section describes two types of functionality, that while of general interest, should be especially useful in the modelling of chemical systems.</p><ul><li>The <code>@compound</code> option, which enables the user to designate that a specific species is composed of certain subspecies.</li><li>The <code>balance_reaction</code> function, which enables the user to balance a reaction so the same number of components occur on both sides.</li></ul><h2 id="chemistry_functionality_compounds"><a class="docs-heading-anchor" href="#chemistry_functionality_compounds">Modelling with compound species</a><a id="chemistry_functionality_compounds-1"></a><a class="docs-heading-anchor-permalink" href="#chemistry_functionality_compounds" title="Permalink"></a></h2><h3 id="Creating-compound-species-programmatically"><a class="docs-heading-anchor" href="#Creating-compound-species-programmatically">Creating compound species programmatically</a><a id="Creating-compound-species-programmatically-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-compound-species-programmatically" title="Permalink"></a></h3><p>We will first show how to create compound species through <a href="../programmatic_CRN_construction/#programmatic_CRN_construction">programmatic model construction</a>, and then demonstrate using the DSL. To create a compound species, use the <code>@compound</code> macro, first designating the compound, followed by its components (and their stoichiometries). In this example, we will create a CO₂ molecule, consisting of one C atom and two O atoms. First, we create species corresponding to the components:</p><pre><code class="language-julia hljs">using Catalyst
t = default_t()
@species C(t) O(t)</code></pre><p>Next, we create the <code>CO2</code> compound species:</p><pre><code class="language-julia hljs">@compound CO2 ~ C + 2O</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{CO2}\left( t \right)
\end{equation}
 \]</p><p>Here, the compound is the first argument to the macro, followed by its component (with the left-hand and right-hand sides separated by a <code>~</code> sign). While non-compound species (such as <code>C</code> and <code>O</code>) have their independent variable (in this case <code>t</code>) designated, independent variables are generally not designated for compounds (these are instead directly inferred from their components). Components with non-unitary stoichiometries have this value written before the component (generally, the rules for designating the components of a compound are identical to those of designating the substrates or products of a reaction). The created compound, <code>CO2</code>, is also a species, and can be used wherever e.g. <code>C</code> can be used:</p><pre><code class="language-julia hljs">isspecies(CO2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>In its metadata, however, is stored information of its components, which can be retrieved using the <code>components</code> (returning a vector of its component species) and <code>coefficients</code> (returning a vector with each component&#39;s stoichiometry) functions:</p><pre><code class="language-julia hljs">components(CO2)</code></pre><p class="math-container">\[ \begin{equation}
\left[
\begin{array}{c}
C\left( t \right) \\
O\left( t \right) \\
\end{array}
\right]
\end{equation}
 \]</p><pre><code class="language-julia hljs">coefficients(CO2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Int64}:
 1
 2</code></pre><p>Alternatively, we can retrieve the components and their stoichiometric coefficients as a single vector using the <code>component_coefficients</code> function:</p><pre><code class="language-julia hljs">component_coefficients(CO2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Pair{Num, Int64}}:
 C(t) =&gt; 1
 O(t) =&gt; 2</code></pre><p>Finally, it is possible to check whether a species is a compound using the <code>iscompound</code> function:</p><pre><code class="language-julia hljs">iscompound(CO2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Compound components that are also compounds are allowed, e.g. we can create a carbonic acid compound (H₂CO₃) that consists of CO₂ and H₂O:</p><pre><code class="language-julia hljs">@species H(t)
@compound H2O ~ 2H + O
@compound H2CO3 ~ CO2 + H2O</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{H2CO3}\left( t \right)
\end{equation}
 \]</p><p>When multiple compounds are created, they can be created simultaneously using the <code>@compounds</code> macro, e.g. the previous code-block can be re-written as:</p><pre><code class="language-julia hljs">@species H(t)
@compounds begin
    H2O ~ 2H + O
    H2CO3 ~ CO2 + H2O
end</code></pre><p class="math-container">\[ \begin{equation}
\left[
\begin{array}{c}
\mathtt{H2O}\left( t \right) \\
\mathtt{H2CO3}\left( t \right) \\
\end{array}
\right]
\end{equation}
 \]</p><h3 id="Creating-compound-species-within-the-DSL"><a class="docs-heading-anchor" href="#Creating-compound-species-within-the-DSL">Creating compound species within the DSL</a><a id="Creating-compound-species-within-the-DSL-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-compound-species-within-the-DSL" title="Permalink"></a></h3><p>It is also possible to declare species as compound species within the <code>@reaction_network</code> DSL, using the <code>@compounds</code> options:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
    @species C(t) H(t) O(t)
    @compounds begin
        C2O ~ C + 2O
        H2O ~ 2H + O
        H2CO3 ~ CO2 + H2O
    end
    (k1,k2), H2O + CO2 &lt;--&gt; H2CO3
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{\mathtt{H2O}} + \mathrm{\mathtt{CO2}} &amp;\xrightleftharpoons[\mathtt{k2}]{\mathtt{k1}} \mathrm{\mathtt{H2CO3}}  
 \end{align*}
 \]</p><p>When creating compound species using the DSL, it is important to note that <em>every component must be known to the system as a species, either by being declared using the <code>@species</code> or <code>@compound</code> options, or by appearing in a reaction</em>. E.g. the following is not valid</p><pre><code class="language-julia hljs">rn = @reaction_network begin
    @compounds begin
        C2O ~ C + 2O
        H2O ~ 2H + O
        H2CO3 ~ CO2 + H2O
    end
    (k1,k2), H2O+ CO2 &lt;--&gt; H2CO3
end</code></pre><p>as the components <code>C</code>, <code>H</code>, and <code>O</code> are not declared as species anywhere. Please also note that only <code>@compounds</code> can be used as an option in the DSL, not <code>@compound</code>.</p><h3 id="Designating-metadata-and-default-values-for-compounds"><a class="docs-heading-anchor" href="#Designating-metadata-and-default-values-for-compounds">Designating metadata and default values for compounds</a><a id="Designating-metadata-and-default-values-for-compounds-1"></a><a class="docs-heading-anchor-permalink" href="#Designating-metadata-and-default-values-for-compounds" title="Permalink"></a></h3><p>Just like for normal species, it is possible to designate metadata and default values for compounds. Metadata is provided after the compound name, but separated from it by a <code>,</code>:</p><pre><code class="language-julia hljs">@compound (CO2, [unit=&quot;mol&quot;]) ~ C + 2O</code></pre><p>Default values are designated using <code>=</code>, and provided directly after the compound name.:</p><pre><code class="language-julia hljs">@compound (CO2 = 2.0) ~ C + 2O</code></pre><p>If both default values and meta data are provided, the metadata is provided after the default value:</p><pre><code class="language-julia hljs">@compound (CO2 = 2.0, [unit=&quot;mol&quot;]) ~ C + 2O</code></pre><p>In all of these cases, the left-hand side must be enclosed within <code>()</code>.</p><h3 id="Compounds-with-multiple-independent-variables"><a class="docs-heading-anchor" href="#Compounds-with-multiple-independent-variables">Compounds with multiple independent variables</a><a id="Compounds-with-multiple-independent-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Compounds-with-multiple-independent-variables" title="Permalink"></a></h3><p>While we generally do not need to specify independent variables for compound, if the components (together) have more than one independent variable, this <em>must be done</em>:</p><pre><code class="language-julia hljs">t = default_t()
@parameters s
@species N(s) O(t)
@compound NO2(t,s) ~ N + 2O</code></pre><p class="math-container">\[ \begin{equation}
\mathtt{NO2}\left( t, s \right)
\end{equation}
 \]</p><p>Here, <code>NO2</code> depend both on a spatial independent variable (<code>s</code>) and a time one (<code>t</code>). This is required since, while multiple independent variables can be inferred, their internal order cannot (and must hence be provided by the user).</p><h2 id="Balancing-chemical-reactions"><a class="docs-heading-anchor" href="#Balancing-chemical-reactions">Balancing chemical reactions</a><a id="Balancing-chemical-reactions-1"></a><a class="docs-heading-anchor-permalink" href="#Balancing-chemical-reactions" title="Permalink"></a></h2><p>One use of defining a species as a compound is that they can be used to balance reactions so that the number of components are the same on both sides. Catalyst provides the <code>balance_reaction</code> function, which takes a reaction, and returns a balanced version. E.g. let us consider a reaction when carbon dioxide is formed from carbon and oxide <code>C + O --&gt; CO2</code>. Here, <code>balance_reaction</code> enables us to find coefficients creating a balanced reaction (in this case, where the number of carbon and oxygen atoms are the same on both sides). To demonstrate, we first created the unbalanced reactions:</p><pre><code class="language-julia hljs">rx = @reaction k, C + O --&gt; $CO2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">k, C + O --&gt; CO2</code></pre><p>Here, the reaction rate (<code>k</code>) is not involved in the reaction balancing. We use interpolation for <code>CO2</code>, ensuring that the <code>CO2</code> used in the reaction is the same one we previously defined as a compound of <code>C</code> and <code>O</code>. Next, we call the <code>balance_reaction</code> function</p><pre><code class="language-julia hljs">balance_reaction(rx)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Reaction}:
 k, C + 2*O --&gt; CO2</code></pre><p>which correctly finds the (rather trivial) solution <code>C + 2O --&gt; CO2</code>. Here we note that <code>balance_reaction</code> actually returns a vector. The reason is that, in some cases, the reaction balancing problem does not have a single obvious solution. Typically, a single solution is the obvious candidate (in which case this is the vector&#39;s only element). However, when this is not the case, the vector instead contain several reactions (from which a balanced reaction cab be generated).</p><p>Let us consider a more elaborate example, the reaction between ammonia (NH₃) and oxygen (O₂) to form nitrogen monoxide (NO) and water (H₂O). Let us first create the components and the unbalanced reaction:</p><pre><code class="language-julia hljs">t = default_t()
@species N(t) H(t) O(t)
@compounds begin
    NH3 ~ N + 3H
    O2 ~ 2O
    NO ~ N + O
    H2O ~ 2H + O
end
unbalanced_reaction = @reaction k, $NH3 + $O2 --&gt; $NO + $H2O</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">k, NH3 + O2 --&gt; NO + H2O</code></pre><p>We can now create a balanced version (where the amount of H, N, and O is the same on both sides):</p><pre><code class="language-julia hljs">balanced_reaction = balance_reaction(unbalanced_reaction)[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">k, 4*NH3 + 5*O2 --&gt; 4*NO + 6*H2O</code></pre><p>Reactions declared as a part of a <code>ReactionSystem</code> (e.g. using the DSL) can be retrieved for balancing using the <a href="../../api/#Catalyst.reactions"><code>reactions</code></a> function. Please note that balancing these will not mutate the <code>ReactionSystem</code>, but a new reaction system will need to be created using the balanced reactions.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Reaction balancing is currently not supported for reactions involving compounds of compounds.</p></div></div><h3 id="Balancing-full-systems"><a class="docs-heading-anchor" href="#Balancing-full-systems">Balancing full systems</a><a id="Balancing-full-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Balancing-full-systems" title="Permalink"></a></h3><p>It is possible to balance all the reactions of a reaction system simultaneously using the <code>balance_system</code> function. Here, the output is a new system, where all reactions are balanced. E.g. We can use it to balance this system of methane formation/combustion:</p><pre><code class="language-julia hljs">rs = @reaction_network begin
    @species C(t) O(t) H(t)
    @compounds begin
        H2(t) ~ 2H
        CH4(t) ~ C + 4H
        O2(t) ~ 2O
        CO2(t) ~ C + 2O
        H2O(t) ~ 2H + O
    end
    1.0, C + H2 --&gt; CH4
    2.0, CH4 + O2 --&gt; CO2 + H2O
end
rs_balanced = balance_system(rs)</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{C} + 2 \mathrm{\mathtt{H2}} &amp;\xrightarrow{1.0} \mathrm{\mathtt{CH4}} \\
\mathrm{\mathtt{CH4}} + 2 \mathrm{\mathtt{O2}} &amp;\xrightarrow{2.0} \mathrm{\mathtt{CO2}} + 2 \mathrm{\mathtt{H2O}}  
 \end{align*}
 \]</p><p>Except for the modified reaction stoichiometries, the new system is identical to the previous one.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../network_analysis/">« Network Analysis in Catalyst</a><a class="docs-footer-nextpage" href="../examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 9 January 2025 01:02">Thursday 9 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
