<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analysing model steady state properties with DynamicalSystems.jl · Catalyst.jl</title><meta name="title" content="Analysing model steady state properties with DynamicalSystems.jl · Catalyst.jl"/><meta property="og:title" content="Analysing model steady state properties with DynamicalSystems.jl · Catalyst.jl"/><meta property="twitter:title" content="Analysing model steady state properties with DynamicalSystems.jl · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/dynamical_systems/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/dynamical_systems/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/steady_state_functionality/dynamical_systems/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with conservation laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing model properties</a></li><li><a class="tocitem" href="../../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for performant SDE simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a periodic event during ODE and jump simulations</a></li><li><a class="tocitem" href="../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../bifurcation_diagrams/">Bifurcation Diagrams</a></li><li class="is-active"><a class="tocitem" href>Analysing model steady state properties with DynamicalSystems.jl</a><ul class="internal"><li><a class="tocitem" href="#dynamical_systems_basins_of_attraction"><span>Finding basins of attraction</span></a></li><li><a class="tocitem" href="#dynamical_systems_lyapunov_exponents"><span>Computing Lyapunov exponents</span></a></li><li><a class="tocitem" href="#dynamical_systems_citations"><span>Citations</span></a></li><li><a class="tocitem" href="#Learning-more"><span>Learning more</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Steady state analysis</a></li><li class="is-active"><a href>Analysing model steady state properties with DynamicalSystems.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/steady_state_functionality/dynamical_systems.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="dynamical_systems"><a class="docs-heading-anchor" href="#dynamical_systems">Analysing model steady state properties with DynamicalSystems.jl</a><a id="dynamical_systems-1"></a><a class="docs-heading-anchor-permalink" href="#dynamical_systems" title="Permalink"></a></h1><p>The <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl">DynamicalSystems.jl package</a> implements a wide range of methods for analysing dynamical systems<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>. This includes both continuous-time systems (i.e. ODEs) and discrete-times ones (difference equations, however, these are not relevant to chemical reaction network modelling). Here we give two examples of how DynamicalSystems.jl can be used, with the package&#39;s <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/tutorial/">documentation describing many more features</a>. Finally, it should also be noted that DynamicalSystems.jl contain several tools for <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/contents/#Exported-submodules">analysing data measured from dynamical systems</a>.</p><h2 id="dynamical_systems_basins_of_attraction"><a class="docs-heading-anchor" href="#dynamical_systems_basins_of_attraction">Finding basins of attraction</a><a id="dynamical_systems_basins_of_attraction-1"></a><a class="docs-heading-anchor-permalink" href="#dynamical_systems_basins_of_attraction" title="Permalink"></a></h2><p>Given enough time, an ODE will eventually reach a so-called <a href="https://en.wikipedia.org/wiki/Attractor"><em>attractor</em></a>. For chemical reaction networks (CRNs), this will typically be either a <em>steady state</em> or a <em>limit cycle</em>. Since ODEs are deterministic, which attractor a simulation will reach is uniquely determined by the initial condition (assuming parameter values are fixed). Conversely, each attractor is associated with a set of initial conditions such that model simulations originating in these will tend to that attractor. These sets are called <em>basins of attraction</em>. Here, phase space (the space of all possible states of the system) can be divided into a number of basins of attraction equal to the number of attractors. </p><p>DynamicalSystems.jl provides a simple interface for finding an ODE&#39;s basins of attraction across any given subspace of phase space. In this example we will use the bistable <a href="https://bmcsystbiol.biomedcentral.com/articles/10.1186/1752-0509-3-90">Wilhelm model</a> (which steady states we have previous <a href="../homotopy_continuation/#homotopy_continuation">computed using homotopy continuation</a>). As a first step, we create an <code>ODEProblem</code> corresponding to the model which basins of attraction we wish to compute. For this application, <code>u0</code> and <code>tspan</code> is unused, and their values are of little importance (the only exception is than <code>tspan</code>, for implementation reason, must provide a not too small interval, we recommend minimum <code>(0.0, 1.0)</code>). </p><pre><code class="language-julia hljs">using Catalyst
wilhelm_model = @reaction_network begin
    k1, Y --&gt; 2X
    k2, 2X --&gt; X + Y
    k3, X + Y --&gt; Y
    k4, X --&gt; 0
end

u0 = [:X =&gt; 0.0, :Y =&gt; .0]
tspan = (0.0, 10.0)
ps = [:k1 =&gt; 8.0, :k2 =&gt; 2.0, :k3 =&gt; 1.0, :k4 =&gt; 1.5]
oprob = ODEProblem(wilhelm_model, u0, tspan, ps)</code></pre><p>Next, for any application of DynamicalSystems.jl, our <code>ODEProblem</code> must be converted into a so-called <code>CoupledODEs</code> structure. This is done by combining the ODE with the solver (and potential solver options) with which we wish to simulate it (just like when it is simulated using <code>solve</code>). Here, we will simply designate the <code>Tsit5</code> numeric solver (but provide no other options).</p><pre><code class="language-julia hljs">using DynamicalSystems, OrdinaryDiffEqTsit5
ds = CoupledODEs(oprob, (alg = Tsit5(),))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-dimensional CoupledODEs
 deterministic: true
 discrete time: false
 in-place:      true
 dynamic rule:  f
 ODE solver:    Tsit5
 ODE kwargs:    NamedTuple()
 parameters:    MTKParameters{Vector{Float64}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}([2.0, 8.0, 1.0, 1.5], (), (), (), ())
 time:          0.0
 state:         [0.0, 0.0]
</code></pre><p>We can now compute the basins of attraction. This is done by first creating a grid that designates which subspace of phase-space we wish to investigate (here, the corresponding basin of attraction is found for every point on the grid). Next, we create a <code>AttractorsViaRecurrences</code> struct, that maps initial conditions to attractors, and then use that as input to the <code>basins_of_attraction</code> function.</p><pre><code class="language-julia hljs"># We provide one grid of values for each species. These are then bundled into a tuple.
x_grid = 0.0:0.03:6.0
y_grid = 0.0:0.03:9.0
grid = (x_grid, y_grid)
avr = AttractorsViaRecurrences(ds, grid)
basins, attractors = basins_of_attraction(avr, grid; show_progress = false)
attractors</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Int64, StateSpaceSets.StateSpaceSet{2, Float64, StaticArraysCore.SVector{2, Float64}}} with 2 entries:
  2 =&gt; 2-dimensional StateSpaceSet{Float64} with 1 points
  1 =&gt; 2-dimensional StateSpaceSet{Float64} with 1 points</code></pre><p>Here, <code>attractors</code> is a dictionary that maps attractor labels (integers) to attractors. In this case we have two fixed points, one at <span>$(0.0,0.0)$</span> and one at <span>$(4.5,6.0)$</span>. Next, <code>basins</code> is a matrix of equal size to <code>grid</code>, where each value is an integer describing to which attractor&#39;s basin that state belongs.</p><p>DynamicalSystems.jl also provides a simple interface for plotting the resulting basins. This uses <a href="https://docs.makie.org/stable/">Makie.jl</a>, an alternative plotting package to <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> (which is typically the preferred plotting package within the context of Catalyst). Generally, Makie is good at creating animations or interactive graphics (however, it is also a <a href="https://juliapackagecomparisons.github.io/pages/plotting/">popular competitor to Plots.jl for general-purpose plotting</a>). </p><pre><code class="language-julia hljs">using CairoMakie
heatmap_basins_attractors(grid, basins, attractors)</code></pre><img src="6e22f27b.png" alt="Example block output"/><p>Here, in addition to the basins of attraction, the system&#39;s three steady states are marked (the one at the intersection of the two basins is unstable).</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Both Makie and Plots.jl exports a function called <code>plot</code>. Hence, if both these packages are imported into the same session, calls to <code>plot</code> must be prepended with the package one wishes to use (e.g. <code>Plots.plot(sol)</code>).</p></div></div><p>More information on how to compute basins of attractions for ODEs using DynamicalSystems.jl can be found <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/attractors/stable/basins/">here</a>.</p><h2 id="dynamical_systems_lyapunov_exponents"><a class="docs-heading-anchor" href="#dynamical_systems_lyapunov_exponents">Computing Lyapunov exponents</a><a id="dynamical_systems_lyapunov_exponents-1"></a><a class="docs-heading-anchor-permalink" href="#dynamical_systems_lyapunov_exponents" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/Lyapunov_exponent"><em>Lyapunov exponents</em></a> are scalar values that can be computed for any attractor of an ODE. For an ODE with <span>$n$</span> variables, for each state, a total of <span>$n$</span> Lyapunov exponents can be computed (and these are collectively called the <em>Lyapunov spectrum</em>). Positive Lyapunov exponents indicate that trajectories initially infinitesimally close diverge from each other. Conversely, negative Lyapunov exponents suggests that trajectories converge to each others. </p><p>While Lyapunov exponents can be used for other purposes, they are primarily used to characterise <a href="https://en.wikipedia.org/wiki/Chaos_theory"><em>chaotic behaviours</em></a> (where small changes in initial conditions has large effect on the resulting trajectories). Generally, an ODE exhibit chaotic behaviour if its attractor(s) have <em>at least one</em> positive Lyapunov exponent. Practically, Lyapunov exponents can be computed using DynamicalSystems.jl&#39;s <code>lyapunovspectrum</code> function. Here we will use it to investigate two models, one which exhibits chaos and one which do not.</p><p>First, let us consider the <a href="../../model_creation/examples/basic_CRN_library/#basic_CRN_library_wr">Willamowski–Rössler model</a>, which is known to exhibit chaotic behaviour.</p><pre><code class="language-julia hljs">using Catalyst
wr_model = @reaction_network begin
    k1, 2X --&gt; 3X
    k2, X --&gt; 2X
    k3, Z + 2X --&gt; 2Z
    k4, Y + X --&gt; 2Y
    k5, Y --&gt; ∅
    k6, 2Z --&gt; ∅
    k7, Z --&gt; ∅
end</code></pre><p class="math-container">\[ \begin{align*}
2 \mathrm{X} &amp;\xrightleftharpoons[\mathtt{k2}]{\mathtt{k1}} 3 \mathrm{X} \\
\mathrm{Z} + 2 \mathrm{X} &amp;\xrightarrow{\mathtt{k3}} 2 \mathrm{Z} \\
\mathrm{Y} + \mathrm{X} &amp;\xrightarrow{\mathtt{k4}} 2 \mathrm{Y} \\
\mathrm{Y} &amp;\xrightarrow{\mathtt{k5}} \varnothing \\
2 \mathrm{Z} &amp;\xrightarrow{\mathtt{k6}} \varnothing \\
\mathrm{Z} &amp;\xrightarrow{\mathtt{k7}} \varnothing  
 \end{align*}
 \]</p><p>We can simulate the model, noting that its behaviour seems chaotic.</p><pre><code class="language-julia hljs">using OrdinaryDiffEqRosenbrock, Plots

u0 = [:X =&gt; 1.5, :Y =&gt; 1.5, :Z =&gt; 1.5]
tspan = (0.0, 100.0)
p = [:k1 =&gt; 2.1, :k2 =&gt; 0.7, :k3 =&gt; 2.9, :k4 =&gt; 1.1, :k5 =&gt; 1.0, :k6 =&gt; 0.5, :k7 =&gt; 2.7]

oprob = ODEProblem(wr_model, u0, tspan, p)
sol = solve(oprob, Rodas5P())
plot(sol; idxs=(:X, :Y, :Z))</code></pre><img src="2fe7e9cc.svg" alt="Example block output"/><p>Next, like when we <a href="#dynamical_systems_basins_of_attraction">computed basins of attraction</a>, we create a <code>CoupledODEs</code> corresponding to the model and state for which we wish to compute our Lyapunov spectrum. Lke previously, <code>tspan</code> must provide some small interval (at least <code>(0.0, 1.0)</code> is recommended), but else have no impact on the computed Lyapunov spectrum.</p><pre><code class="language-julia hljs">using DynamicalSystems
ds = CoupledODEs(oprob, (alg = Rodas5P(autodiff = false),))</code></pre><p>Here, the <code>autodiff = false</code> argument is required when Lyapunov spectrums are computed. We can now provide our <code>CoupledODEs</code> (<code>ds</code>) to <code>lyapunovspectrum</code> to compute the lyapunov spectrum. This function requires a second argument (here set to <code>100</code>). Generally setting this to a higher value will increase accuracy, but also increase runtime (since <code>lyapunovspectrum</code> is fast for most systems, setting this to a large value is recommended).</p><pre><code class="language-julia hljs">lyapunovspectrum(ds, 100)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
  0.00668773198860342
 -0.05322654332171767
 -0.09150189431548257</code></pre><p>Here, the largest exponent is positive, suggesting that the model is chaotic (or, more accurately, it has at least one chaotic attractor, to which is approached from the initial condition <span>$(1.5,1.5,1.5)$</span>).</p><p>Next, we consider the [Brusselator] model. First we simulate the model for two similar initial conditions, confirming that they converge to the same limit cycle:</p><pre><code class="language-julia hljs">using OrdinaryDiffEqTsit5
brusselator = @reaction_network begin
    A, ∅ --&gt; X
    1, 2X + Y --&gt; 3X
    B, X --&gt; Y
    1, X --&gt; ∅
end

u0_1 = [:X =&gt; 1.0, :Y =&gt; 1.0]
u0_2 = [:X =&gt; 1.2, :Y =&gt; 1.0]
tspan = (0., 25.)
ps = [:A =&gt; 1.0, :B =&gt; 4.0]

oprob1 = ODEProblem(brusselator, u0_1, tspan, ps)
oprob2 = ODEProblem(brusselator, u0_2, tspan, ps)
osol1  = solve(oprob1, Tsit5())
osol2  = solve(oprob2, Tsit5())
plot(osol1; idxs = (:X, :Y))
plot!(osol2; idxs = (:X, :Y))</code></pre><img src="a7290b97.svg" alt="Example block output"/><p>Next, we compute the Lyapunov spectrum at one of the initial conditions:</p><pre><code class="language-julia hljs">ds = CoupledODEs(oprob1, (alg = Rodas5P(autodiff = false),))
lyapunovspectrum(ds, 100)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 -0.004193807229248127
 -3.6149854936834243</code></pre><p>Here, all Lyapunov exponents are negative, confirming that the brusselator is non-chaotic.</p><p>More details on how to compute Lyapunov exponents using DynamicalSystems.jl can be found <a href="https://juliadynamics.github.io/ChaosTools.jl/stable/lyapunovs/">here</a>. A full overview of tools for analysing chaotic behaviours (using the &quot;ChaosTools.jl subpackage) can be found <a href="https://juliadynamics.github.io/ChaosTools.jl/stable/">here</a>.</p><hr/><h2 id="dynamical_systems_citations"><a class="docs-heading-anchor" href="#dynamical_systems_citations">Citations</a><a id="dynamical_systems_citations-1"></a><a class="docs-heading-anchor-permalink" href="#dynamical_systems_citations" title="Permalink"></a></h2><p>If you use this functionality in your research, <a href="../../#doc_index_citation">in addition to Catalyst</a>, please cite the following paper to support the author of the DynamicalSystems.jl package:</p><pre><code class="nohighlight hljs">@article{DynamicalSystems.jl-2018,
  doi = {10.21105/joss.00598},
  url = {https://doi.org/10.21105/joss.00598},
  year  = {2018},
  month = {mar},
  volume = {3},
  number = {23},
  pages = {598},
  author = {George Datseris},
  title = {DynamicalSystems.jl: A Julia software library for chaos and nonlinear dynamics},
  journal = {Journal of Open Source Software}
}</code></pre><hr/><h2 id="Learning-more"><a class="docs-heading-anchor" href="#Learning-more">Learning more</a><a id="Learning-more-1"></a><a class="docs-heading-anchor-permalink" href="#Learning-more" title="Permalink"></a></h2><p>If you want to learn more about analysing dynamical systems, including chaotic behaviour, see the textbook <a href="https://link.springer.com/book/10.1007/978-3-030-91032-7">Nonlinear Dynamics</a>. It utilizes DynamicalSystems.jl and provides a concise, hands-on approach to learning nonlinear dynamics and analysing dynamical systems <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>.</p><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="http://users.uoa.gr/~pjioannou/nonlin/Strogatz,%20S.%20H.%20-%20Nonlinear%20Dynamics%20And%20Chaos.pdf">S. H. Strogatz, <em>Nonlinear Dynamics and Chaos</em>, Westview Press (1994).</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://www.tandfonline.com/doi/abs/10.1080/00207179208934253">A. M. Lyapunov, <em>The general problem of the stability of motion</em>, International Journal of Control (1992).</a></li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a><a href="https://link.springer.com/book/10.1007/978-3-030-91032-7">G. Datseris, U. Parlitz, <em>Nonlinear dynamics: A concise introduction interlaced with code</em>, Springer (2022).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bifurcation_diagrams/">« Bifurcation Diagrams</a><a class="docs-footer-nextpage" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 9 January 2025 01:02">Thursday 9 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
