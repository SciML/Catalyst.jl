<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Global Sensitivity Analysis · Catalyst.jl</title><meta name="title" content="Global Sensitivity Analysis · Catalyst.jl"/><meta property="og:title" content="Global Sensitivity Analysis · Catalyst.jl"/><meta property="twitter:title" content="Global Sensitivity Analysis · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/inverse_problems/global_sensitivity_analysis/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/inverse_problems/global_sensitivity_analysis/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/inverse_problems/global_sensitivity_analysis/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with conservation laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing model properties</a></li><li><a class="tocitem" href="../../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for performant SDE simulations</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Model simulation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a periodic event during ODE and jump simulations</a></li></ul></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../structural_identifiability/">Structural Identifiability Analysis</a></li><li class="is-active"><a class="tocitem" href>Global Sensitivity Analysis</a><ul class="internal"><li><a class="tocitem" href="#global_sensitivity_analysis_basic_example"><span>Basic example</span></a></li><li><a class="tocitem" href="#global_sensitivity_analysis_sobol"><span>Sobol&#39;s method-based global sensitivity analysis</span></a></li><li><a class="tocitem" href="#global_sensitivity_analysis_morris"><span>Morris&#39;s method-based global sensitivity analysis</span></a></li><li><a class="tocitem" href="#global_sensitivity_analysis_other_methods"><span>Other global sensitivity analysis methods</span></a></li><li><a class="tocitem" href="#global_sensitivity_analysis_nonscalars"><span>Global sensitivity analysis for non-scalar outputs</span></a></li><li><a class="tocitem" href="#global_sensitivity_analysis_citations"><span>Citations</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><span class="tocitem">Spatial Modelling</span><ul><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inverse Problems</a></li><li class="is-active"><a href>Global Sensitivity Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Global Sensitivity Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/inverse_problems/global_sensitivity_analysis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="global_sensitivity_analysis"><a class="docs-heading-anchor" href="#global_sensitivity_analysis">Global Sensitivity Analysis</a><a id="global_sensitivity_analysis-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis" title="Permalink"></a></h1><p><em>Global sensitivity analysis</em> (GSA) is used to study the sensitivity of a function&#39;s outputs with respect to its input<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. Within the context of chemical reaction network modelling it is primarily used for two purposes:</p><ul><li>When fitting a model&#39;s parameters to data, it can be applied to the cost function of the optimisation problem. Here, GSA helps determine which parameters do, and do not, affect the model&#39;s fit to the data. This can be used to identify parameters that are less relevant to the observed data.</li><li><a href="../behaviour_optimisation/#behaviour_optimisation">When measuring some system behaviour or property</a>, it can help determine which parameters influence that property. E.g. for a model of a biofuel-producing circuit in a synthetic organism, GSA could determine which system parameters have the largest impact on the total rate of biofuel production.</li></ul><p>GSA can be carried out using the <a href="https://github.com/SciML/GlobalSensitivity.jl">GlobalSensitivity.jl</a> package. This tutorial contains a brief introduction of how to use it for GSA on Catalyst models, with <a href="https://docs.sciml.ai/GlobalSensitivity/stable/">GlobalSensitivity providing a more complete documentation</a>.</p><h3 id="global_sensitivity_analysis_global_vs_local_sensitivity"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_global_vs_local_sensitivity">Global vs local sensitivity</a><a id="global_sensitivity_analysis_global_vs_local_sensitivity-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_global_vs_local_sensitivity" title="Permalink"></a></h3><p>A related concept to global sensitivity is <em>local sensitivity</em>. This, rather than measuring a function&#39;s sensitivity (with regards to its inputs) across its entire (or large part of its) domain, measures it at a specific point. This is equivalent to computing the function&#39;s gradients at a specific point in phase space, which is an important routine for most gradient-based optimisation methods (typically carried out through <a href="https://en.wikipedia.org/wiki/Automatic_differentiation"><em>automatic differentiation</em></a>). For most Catalyst-related functionalities, local sensitivities are computed using the <a href="https://github.com/SciML/SciMLSensitivity.jl">SciMLSensitivity.jl</a> package. While certain GSA methods can utilise local sensitivities, this is not necessarily the case.</p><p>While local sensitivities are primarily used as a subroutine of other methodologies (such as optimisation schemes), it also has direct uses. E.g., in the context of fitting parameters to data, local sensitivity analysis can be used to, at the parameter set of the optimal fit, determine the cost function&#39;s sensitivity to the system parameters.</p><h2 id="global_sensitivity_analysis_basic_example"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_basic_example">Basic example</a><a id="global_sensitivity_analysis_basic_example-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_basic_example" title="Permalink"></a></h2><p>We will consider a simple <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology">SEIR model of an infectious disease</a>. This is an expansion of the classic <a href="../../model_creation/examples/basic_CRN_library/#basic_CRN_library_sir">SIR model</a> with an additional <em>exposed</em> state, <span>$E$</span>, denoting individuals who are latently infected but currently unable to transmit their infection to others.</p><pre><code class="language-julia hljs">using Catalyst
seir_model = @reaction_network begin
    10^β, S + I --&gt; E + I
    10^a, E --&gt; I
    10^γ, I --&gt; R
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{S} + \mathrm{I} &amp;\xrightarrow{10^{\beta}} \mathrm{E} + \mathrm{I} \\
\mathrm{E} &amp;\xrightarrow{10^{a}} \mathrm{I} \\
\mathrm{I} &amp;\xrightarrow{10^{\gamma}} \mathrm{R}  
 \end{align*}
 \]</p><p>We will study the peak number of infected cases&#39;s (<span>$max(I(t))$</span>) sensitivity to the system&#39;s three parameters. We create a function which simulates the system from a given initial condition and measures this property:</p><pre><code class="language-julia hljs">using OrdinaryDiffEq

u0 = [:S =&gt; 999.0, :I =&gt; 1.0, :E =&gt; 0.0, :R =&gt; 0.0]
p_dummy = [:β =&gt; 0.0, :a =&gt; 0.0, :γ =&gt; 0.0]
oprob_base = ODEProblem(seir_model, u0, (0.0, 10000.0), p_dummy)

function peak_cases(p)
    ps = [:β =&gt; p[1], :a =&gt; p[2], :γ =&gt; p[3]]
    oprob = remake(oprob_base; p = ps)
    sol = solve(oprob; maxiters = 100000, verbose = false)
    SciMLBase.successful_retcode(sol) || return Inf
    return maximum(sol[:I])
end</code></pre><p>Now, GSA can be applied to our <code>peak_cases</code> function using GlobalSensitivity&#39;s <code>gsa</code> function. It takes 3 mandatory inputs:</p><ul><li>The function for which we wish to carry out GSA.</li><li>A method with which we wish to carry out GSA.</li><li>A domain on which we carry out GSA. This is defined by a vector, which contains one two-valued Tuple for each parameter. These Tuples contain a lower and an upper bound for their respective parameter&#39;s value.</li></ul><p>E.g., here we carry out GSA using <a href="https://en.wikipedia.org/wiki/Morris_method">Morris&#39;s method</a>:</p><pre><code class="language-julia hljs">using GlobalSensitivity
global_sens = gsa(peak_cases, Morris(), [(-3.0,-1.0), (-2.0,0.0), (-2.0,0.0)])</code></pre><p>on the domain <span>$10^β ∈ (-3.0,-1.0)$</span>, <span>$10^a ∈ (-2.0,0.0)$</span>, <span>$10^γ ∈ (-2.0,0.0)$</span> (which corresponds to <span>$β ∈ (0.001,0.1)$</span>, <span>$a ∈ (0.01,1.0)$</span>, <span>$γ ∈ (0.01,1.0)$</span>). The output of <code>gsa</code> varies depending on which GSA approach is used. GlobalSensitivity implements a range of methods for GSA. Below, we will describe the most common ones, as well as how to apply them and interpret their outputs.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We should make a couple of notes about the example above:</p><ul><li>Here, we write our parameters on the forms <span>$10^β$</span>, <span>$10^a$</span>, and <span>$10^γ$</span>, which transforms them into log-space. As <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_log_scale">previously described</a>, this is advantageous in the context of inverse problems such as this one.</li><li>For GSA, where a function is evaluated a large number of times, it is ideal to write it as performant as possible. Hence, we initially create a base <code>ODEProblem</code>, and then apply the <a href="../../model_simulation/simulation_structure_interfacing/#simulation_structure_interfacing_problems_remake"><code>remake</code></a> function to it in each evaluation of <code>peak_cases</code> to generate a problem which is solved for that specific parameter set.</li><li>Again, as <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_basics">previously described in other inverse problem tutorials</a>, when exploring a function over large parameter spaces, we will likely simulate our model for unsuitable parameter sets. To reduce time spent on these, and to avoid excessive warning messages, we provide the <code>maxiters = 100000</code> and <code>verbose = false</code> arguments to <code>solve</code>.</li><li>As we have encountered in <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_basics">a few other cases</a>, the <code>gsa</code> function is not able to take parameter inputs of the map form usually used for Catalyst. Hence, as a first step in <code>peak_cases</code> we convert the parameter vector to this form. Next, we remember that the order of the parameters when we e.g. evaluate the GSA output, or set the parameter bounds, corresponds to the order used in <code>ps = [:β =&gt; p[1], :a =&gt; p[2], :γ =&gt; p[3]]</code>.</li></ul></div></div><h2 id="global_sensitivity_analysis_sobol"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_sobol">Sobol&#39;s method-based global sensitivity analysis</a><a id="global_sensitivity_analysis_sobol-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_sobol" title="Permalink"></a></h2><p>The most common method for GSA is <a href="https://en.wikipedia.org/wiki/Variance-based_sensitivity_analysis">Sobol&#39;s method</a>. This can be carried out using:</p><pre><code class="language-julia hljs">global_sens = gsa(peak_cases, Sobol(), [(-3.0,-1.0), (-2.0,0.0), (-2.0,0.0)]; samples = 500)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Warning: The `generate_design_matrices(n, d, sampler, R = NoRand(), num_mats)` method does not produces true and independent QMC matrices, see [this doc warning](https://docs.sciml.ai/QuasiMonteCarlo/stable/design_matrix/) for more context.
│     Prefer using randomization methods such as `R = Shift()`, `R = MatousekScrambling()`, etc., see [documentation](https://docs.sciml.ai/QuasiMonteCarlo/stable/randomization/)
└ @ QuasiMonteCarlo ~/.julia/packages/QuasiMonteCarlo/KvLfb/src/RandomizedQuasiMonteCarlo/iterators.jl:255</code></pre><p>Note: when <code>Sobol()</code> is used as the method, the <code>samples</code> argument must also be used.</p><p>Sobol&#39;s method computes so-called <em>Sobol indices</em>, each measuring some combination of input&#39;s effect on the output. Here, when <code>Sobol()</code> is used, the <em>first order</em>, <em>second order</em>, and <em>total order</em> Sobol indices are computed. These can be accessed through the following fields:</p><ul><li><code>global_sens.S1</code>: A vector where the i&#39;th element is the output&#39;s sensitivity to variations in the i&#39;th input.</li><li><code>global_sens.S2</code>: A matrix where element i-j contains the output&#39;s sensitivity to simultaneous variations in the i&#39;th and j&#39;th inputs.</li><li><code>global_sens.ST</code>: A vector where the i&#39;th element is the output&#39;s sensitivity to any simultaneous variation of any combination of inputs that contain the i&#39;th input. While only the first and second-order (and the total) Sobol indices are computed, the total order index compounds the information contained in Sobol indices across all orders.</li></ul><p>We can plot the first-order Sobol indices to analyse their content:</p><pre><code class="language-julia hljs">using Plots
bar([&quot;β&quot;, &quot;a&quot;, &quot;γ&quot;], global_sens.S1; group = [&quot;β&quot;, &quot;a&quot;, &quot;γ&quot;], fillrange = 1e-3)</code></pre><img src="d1c322bf.svg" alt="Example block output"/><p>Here, we see that <span>$β$</span> has a relatively low effect on the peak in infected cases, as compared to <span>$a$</span> and <span>$γ$</span>. Plotting the total order indices suggests the same:</p><pre><code class="language-julia hljs">bar([&quot;β&quot;, &quot;a&quot;, &quot;γ&quot;], global_sens.ST; group = [&quot;β&quot;, &quot;a&quot;, &quot;γ&quot;], fillrange = 1e-3)</code></pre><img src="d0662979.svg" alt="Example block output"/><p>GlobalSensitivity implements several versions of Sobol&#39;s method, and also provides several options. These are described <a href="https://docs.sciml.ai/GlobalSensitivity/stable/methods/sobol/">here</a>. Specifically, it is often recommended to, due to its quick computation time, use the related extended Fourier amplitude sensitivity test (EFAST) version. We can run this using:</p><pre><code class="language-julia hljs">global_sens = gsa(peak_cases, eFAST(), [(-3.0,-1.0), (-2.0,0.0), (-2.0,0.0)]; samples = 500)</code></pre><p>It should be noted that when EFAST is used, only the first and total-order Sobol indices are computed (and not the second-order ones).</p><h2 id="global_sensitivity_analysis_morris"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_morris">Morris&#39;s method-based global sensitivity analysis</a><a id="global_sensitivity_analysis_morris-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_morris" title="Permalink"></a></h2><p>An alternative to using Sobol&#39;s method is to use <a href="https://en.wikipedia.org/wiki/Morris_method">Morris&#39;s method</a>. The syntax is similar to previously (however, the <code>samples</code> argument is no longer required):</p><pre><code class="language-julia hljs">global_sens = gsa(peak_cases, Morris(), [(-3.0,-1.0), (-2.0,0.0), (-2.0,0.0)])</code></pre><p>Morris&#39;s method computes, for parameter samples across parameter space, their <em>elementary effect</em> on the output. Next, the output&#39;s sensitivity with respect to each parameter is assessed through various statistics on these elementary effects. In practice, the following two fields are considered:</p><ul><li><code>global_sens.means_star</code> (called <span>$μ*$</span>): Measures each parameter&#39;s influence on the output. A large <span>$μ*$</span> indicates a parameter to which the output is sensitive. </li><li><code>global_sens.variances</code>: Measures the variance of each parameter&#39;s influence on the output. A large variance suggests that a parameter&#39;s influence on the output is highly dependent on other parameter values.</li></ul><p>We can check these values for our example:</p><pre><code class="language-julia hljs">mean_star_plot = bar([&quot;β&quot; &quot;a&quot; &quot;γ&quot;], global_sens.means_star; labels=[&quot;β&quot; &quot;a&quot; &quot;γ&quot;], title=&quot;μ*&quot;)
variances_plot = bar([&quot;β&quot; &quot;a&quot; &quot;γ&quot;], global_sens.variances; labels=[&quot;β&quot; &quot;a&quot; &quot;γ&quot;], title=&quot;σ²&quot;)
plot(mean_star_plot, variances_plot)</code></pre><img src="b23a9ac4.svg" alt="Example block output"/><p>As previously, we note that the peak number of infected cases is more sensitive to <span>$a$</span> and <span>$γ$</span> than to <span>$β$</span>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The syntax for plotting the output using Sobol&#39;s and Morris&#39;s methods is slightly different. The reason is that <code>global_sens.means_star</code> and <code>global_sens.variances</code> (for Morris&#39;s method) are 1x3 Matrices, while for Sobol&#39;s method, <code>global_sens.S1</code> and <code>global_sens.ST</code> are length-3 vectors.</p></div></div><p>Generally, Morris&#39;s method is computationally less intensive, and has easier to interpret output, as compared to Sobol&#39;s method. However, if computational resources are available, Sobol&#39;s method is more comprehensive.</p><h2 id="global_sensitivity_analysis_other_methods"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_other_methods">Other global sensitivity analysis methods</a><a id="global_sensitivity_analysis_other_methods-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_other_methods" title="Permalink"></a></h2><p>GlobalSensitivity also implements additional methods for GSA, more details on these can be found in the <a href="https://docs.sciml.ai/GlobalSensitivity/stable/">package&#39;s documentation</a>.</p><h2 id="global_sensitivity_analysis_nonscalars"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_nonscalars">Global sensitivity analysis for non-scalar outputs</a><a id="global_sensitivity_analysis_nonscalars-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_nonscalars" title="Permalink"></a></h2><p>Previously, we have demonstrated GSA on functions with scalar outputs. However, it is also possible to apply it to functions with vector outputs. Let us consider our previous function, but where it provides both the peak number of exposed <em>and</em> infected individuals:</p><pre><code class="language-julia hljs">function peak_cases_2(p)
    ps = [:β =&gt; p[1], :a =&gt; p[2], :γ =&gt; p[3]]
    oprob = remake(oprob_base; p = ps)
    sol = solve(oprob; maxiters = 100000, verbose = false)
    SciMLBase.successful_retcode(sol) || return Inf
    return [maximum(sol[:E]), maximum(sol[:I])]
end</code></pre><p>We can apply <code>gsa</code> to this function as previously:</p><pre><code class="language-julia hljs">global_sens = gsa(peak_cases_2, Morris(), [(-3.0,-1.0), (-2.0,0.0), (-2.0,0.0)])</code></pre><p>however, each output field is now a multi-row matrix, containing one row for each of the outputs. E.g., we have</p><pre><code class="language-julia hljs">global_sens.means_star</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×3 Matrix{Float64}:
 230.876   187.005   29.993
  15.9248  313.183  329.578</code></pre><p>Here, the function&#39;s sensitivity is evaluated with respect to each output independently. Hence, GSA on <code>peak_cases_2</code> is equivalent to first carrying out GSA on a function returning the peak number of exposed individuals, and then on one returning the peak number of infected individuals.</p><hr/><h2 id="global_sensitivity_analysis_citations"><a class="docs-heading-anchor" href="#global_sensitivity_analysis_citations">Citations</a><a id="global_sensitivity_analysis_citations-1"></a><a class="docs-heading-anchor-permalink" href="#global_sensitivity_analysis_citations" title="Permalink"></a></h2><p>If you use this functionality in your research, <a href="../../#doc_index_citation">in addition to Catalyst</a>, please cite the following paper to support the authors of the GlobalSensitivity.jl package:</p><pre><code class="nohighlight hljs">@article{dixit2022globalsensitivity,
  title={GlobalSensitivity. jl: Performant and Parallel Global Sensitivity Analysis with Julia},
  author={Dixit, Vaibhav Kumar and Rackauckas, Christopher},
  journal={Journal of Open Source Software},
  volume={7},
  number={76},
  pages={4561},
  year={2022}
}</code></pre><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="http://www.andreasaltelli.eu/file/repository/A_Saltelli_Marco_Ratto_Terry_Andres_Francesca_Campolongo_Jessica_Cariboni_Debora_Gatelli_Michaela_Saisana_Stefano_Tarantola_Global_Sensitivity_Analysis_The_Primer_Wiley_Interscience_2008_.pdf">Saltelli, A et al. <em>Global Sensitivity Analysis. The Primer</em>, Wiley (2008).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../structural_identifiability/">« Structural Identifiability Analysis</a><a class="docs-footer-nextpage" href="../examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Monday 2 September 2024 18:17">Monday 2 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
