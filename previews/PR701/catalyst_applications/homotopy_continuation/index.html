<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Finding Steady States through Homotopy Continuation · Catalyst.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/catalyst_applications/homotopy_continuation/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Catalyst Functionality</span><ul><li><a class="tocitem" href="../../catalyst_functionality/dsl_description/">The Reaction DSL</a></li><li><a class="tocitem" href="../../catalyst_functionality/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../catalyst_functionality/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../catalyst_functionality/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../catalyst_functionality/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../catalyst_functionality/network_analysis/">Network Analysis in Catalyst</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../catalyst_functionality/example_networks/basic_CRN_examples/">Basic Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../../catalyst_functionality/example_networks/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../catalyst_functionality/example_networks/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Catalyst Applications</span><ul><li><a class="tocitem" href="../simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../advanced_simulations/">Advanced Simulation Options</a></li><li class="is-active"><a class="tocitem" href>Finding Steady States through Homotopy Continuation</a><ul class="internal"><li><a class="tocitem" href="#Basic-example"><span>Basic example</span></a></li><li><a class="tocitem" href="#Systems-with-conservation-laws"><span>Systems with conservation laws</span></a></li><li><a class="tocitem" href="#Final-notes"><span>Final notes</span></a></li><li><a class="tocitem" href="#homotopy_continuation_citation"><span>Citation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../bifurcation_diagrams/">Bifurcation Diagrams</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../inverse_problems/parameter_estimation/">Parameter Estimation</a></li><li><a class="tocitem" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/catalyst_api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Catalyst Applications</a></li><li class="is-active"><a href>Finding Steady States through Homotopy Continuation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Finding Steady States through Homotopy Continuation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/catalyst_applications/homotopy_continuation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="homotopy_continuation"><a class="docs-heading-anchor" href="#homotopy_continuation">Finding Steady States through Homotopy Continuation</a><a id="homotopy_continuation-1"></a><a class="docs-heading-anchor-permalink" href="#homotopy_continuation" title="Permalink"></a></h1><p>The steady states of a dynamical system <span>${dx \over dt} = f(x)$</span> can be found by solving <span>$0 = f(x)$</span>. This is typically a hard problem, and generally, there is no method guaranteed to find all steady states for a system that has multiple ones. However, many chemical reaction networks generate polynomial systems (for example those which are purely mass action or have only have Hill functions with integer Hill exponents). The roots of these can reliably be found through a <em>homotopy continuation</em> algorithm. This is implemented in Julia through the <a href="https://www.juliahomotopycontinuation.org/">HomotopyContinuation.jl</a> package.</p><p>Catalyst contains a special homotopy continuation extension that is loaded whenever HomotopyContinuation.jl is. This exports a single function, <code>hc_steady_states</code>, that can be used to find the steady states of any <code>ReactionSystem</code> structure. If you use this in your research, please <a href="#homotopy_continuation_citation">cite the HomotopyContinuation.jl</a> and <a href="../../#catalyst_citation">Catalyst.jl</a> publications.</p><h2 id="Basic-example"><a class="docs-heading-anchor" href="#Basic-example">Basic example</a><a id="Basic-example-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-example" title="Permalink"></a></h2><p>For this tutorial, we will use a model from Wilhelm (2009)<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> (which demonstrates bistability in a small chemical reaction network). We declare the model and the parameter set for which we want to find the steady states:</p><pre><code class="language-julia hljs">using Catalyst
import HomotopyContinuation

wilhelm_2009_model = @reaction_network begin
    k1, Y --&gt; 2X
    k2, 2X --&gt; X + Y
    k3, X + Y --&gt; Y
    k4, X --&gt; 0
end
ps = [:k1 =&gt; 8.0, :k2 =&gt; 2.0, :k3 =&gt; 1.0, :k4 =&gt; 1.5]</code></pre><p>Here, we only run <code>import HomotopyContinuation</code> as we do not require any of its functions, and just need it to be present in the current scope for the extension to be activated.</p><p>Now we can find the steady states using:</p><pre><code class="language-julia hljs">hc_steady_states(wilhelm_2009_model, ps)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Vector{Float64}}:
 [0.5000000000000003, 2.0000000000000004]
 [0.0, 0.0]
 [4.500000000000003, 6.000000000000002]</code></pre><p>The order of the species in the output vectors are the same as in <code>species(wilhelm_2009_model)</code>.</p><p>It should be noted that the steady state multivariate polynomials produced by reaction systems may have both imaginary and negative roots, which are filtered away by <code>hc_steady_states</code>. If you want the negative roots, you can use the <code>hc_steady_states(wilhelm_2009_model, ps; filter_negative=false)</code> argument.</p><h2 id="Systems-with-conservation-laws"><a class="docs-heading-anchor" href="#Systems-with-conservation-laws">Systems with conservation laws</a><a id="Systems-with-conservation-laws-1"></a><a class="docs-heading-anchor-permalink" href="#Systems-with-conservation-laws" title="Permalink"></a></h2><p>Some systems are under-determined, and have an infinite number of possible steady states. These are typically systems containing a conservation law, e.g.</p><pre><code class="language-julia hljs">using Catalyst
import HomotopyContinuation

two_state_model = @reaction_network begin
    (k1,k2), X1 &lt;--&gt; X2
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{X1} &amp;\xrightleftharpoons[k2]{k1} \mathrm{X2}  
 \end{align*}
 \]</p><p>Catalyst allows the conservation laws of such systems to be computed using the <code>conservationlaws</code> function. By using these to reduce the dimensionality of the system, as well specifying the initial amount of each species, HomotopyContinuation can again be used to find steady states. To find the steady states using the Catalyst interface to HomotopyContinuation, an initial condition must be provided (which is used to compute the system&#39;s conserved quantities, in this case <code>X1+X2</code>):</p><pre><code class="language-julia hljs">ps = [:k1 =&gt; 2.0, :k2 =&gt; 1.0]
u0 = [:X1 =&gt; 1.0, :X2 =&gt; 1.0]
hc_steady_states(two_state_model, ps; u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Vector{Float64}}:
 [0.6666666666666666, 1.3333333333333335]</code></pre><h2 id="Final-notes"><a class="docs-heading-anchor" href="#Final-notes">Final notes</a><a id="Final-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Final-notes" title="Permalink"></a></h2><ul><li><code>hc_steady_states</code> supports any systems where all rates are systems of rational polynomials (such as Hill functions with integer Hill coefficients).</li><li>When providing initial conditions to compute conservation laws, values are only required for those species that are part of conserved quantities. If this set of species is unknown, it is recommended to provide initial conditions for all species. </li><li>Additional arguments provided to <code>hc_steady_states</code> are automatically passed to HomotopyContinuation&#39;s <code>solve</code> command. Use e.g. <code>show_progress=false</code> to disable the progress bar.</li></ul><hr/><h2 id="homotopy_continuation_citation"><a class="docs-heading-anchor" href="#homotopy_continuation_citation">Citation</a><a id="homotopy_continuation_citation-1"></a><a class="docs-heading-anchor-permalink" href="#homotopy_continuation_citation" title="Permalink"></a></h2><p>If you use this functionality in your research, please cite the following paper to support the authors of the HomotopyContinuation package:</p><pre><code class="nohighlight hljs">@inproceedings{HomotopyContinuation.jl,
  title={{H}omotopy{C}ontinuation.jl: {A} {P}ackage for {H}omotopy {C}ontinuation in {J}ulia},
  author={Breiding, Paul and Timme, Sascha},
  booktitle={International Congress on Mathematical Software},
  pages={458--465},
  year={2018},
  organization={Springer}
}</code></pre><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://bmcsystbiol.biomedcentral.com/articles/10.1186/1752-0509-3-90">Thomas Wilhelm, <em>The smallest chemical reaction system with bistability</em>, BMC Systems Biology (2009).</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://link.springer.com/chapter/10.1007/978-3-319-96418-8_54">Paul Breiding, Sascha Timme, <em>HomotopyContinuation.jl: A Package for Homotopy Continuation in Julia</em>, International Congress on Mathematical Software (2018).</a></li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a><a href="https://www.worldscientific.com/worldscibooks/10.1142/5763#t=aboutBook">Andrew J Sommese, Charles W Wampler <em>The Numerical Solution of Systems of Polynomials Arising in Engineering and Science</em>, World Scientific (2005).</a></li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a><a href="https://arxiv.org/abs/2302.08585">Daniel J. Bates, Paul Breiding, Tianran Chen, Jonathan D. Hauenstein, Anton Leykin, Frank Sottile, <em>Numerical Nonlinear Algebra</em>, arXiv (2023).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../advanced_simulations/">« Advanced Simulation Options</a><a class="docs-footer-nextpage" href="../bifurcation_diagrams/">Bifurcation Diagrams »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 2 November 2023 23:19">Thursday 2 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
