<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization for Non-data Fitting Purposes · Catalyst.jl</title><meta name="title" content="Optimization for Non-data Fitting Purposes · Catalyst.jl"/><meta property="og:title" content="Optimization for Non-data Fitting Purposes · Catalyst.jl"/><meta property="twitter:title" content="Optimization for Non-data Fitting Purposes · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/inverse_problems/behaviour_optimisation/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/inverse_problems/behaviour_optimisation/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/inverse_problems/behaviour_optimisation/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Introduction to Catalyst</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/math_models_intro/">Mathematical Models Catalyst can Generate</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Model creation and properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Coupled ODEs, Algebraic Equations, and Events</a></li><li><a class="tocitem" href="../../model_creation/conservation_laws/">Working with Conservation Laws</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stoichiometries</a></li><li><a class="tocitem" href="../../model_creation/functional_parameters/">Inputs and time-dependent (or functional) parameters</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/reactionsystem_content_accessing/">Accessing Model Properties</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related Functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-13" type="checkbox"/><label class="tocitem" for="menuitem-3-13"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, Generative, Modelling of a Linear Pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/noise_modelling_approaches/">Approaches for modelling system noise</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model simulation and visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation Plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for Performant ODE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for Performant SDE Simulations</a></li><li><a class="tocitem" href="../../model_simulation/finite_state_projection_simulation/">Solving the chemical master equation using FiniteStateProjection.jl</a></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_simulation/examples/periodic_events_simulation/">Modelling a Periodic Event During ODE and Jump Simulations</a></li><li><a class="tocitem" href="../../model_simulation/examples/activation_time_distribution_measurement/">Measuring the Distribution of System Activation Times</a></li><li><a class="tocitem" href="../../model_simulation/examples/interactive_brusselator_simulation/">Interactive Simulation and Plotting</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Network Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../network_analysis/odes/">Decomposing the Reaction Network ODEs</a></li><li><a class="tocitem" href="../../network_analysis/crn_theory/">Chemical Reaction Network Theory</a></li><li><a class="tocitem" href="../../network_analysis/network_properties/">Caching of Network Properties in <code>ReactionSystems</code></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Steady state analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing Model Steady State Properties with DynamicalSystems.jl</a></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../steady_state_functionality/examples/nullcline_plotting/">Plotting Nullclines and Steady States in Phase Space</a></li><li><a class="tocitem" href="../../steady_state_functionality/examples/bifurcationkit_periodic_orbits/">Computing Periodic Orbits (Oscillations) Using BifurcationKit.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/examples/bifurcationkit_codim2/">Tracking Bifurcation Point w.r.t. Secondary Parameters using BifurcationKit.jl</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Inverse problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li><li><a class="tocitem" href="../optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl</a></li><li class="is-active"><a class="tocitem" href>Optimization for Non-data Fitting Purposes</a><ul class="internal"><li><a class="tocitem" href="#behaviour_optimisation_IFFL_example"><span>Maximising the pulse amplitude of an incoherent feed forward loop</span></a></li><li><a class="tocitem" href="#behaviour_optimisation_options"><span>Other optimisation options</span></a></li><li><a class="tocitem" href="#structural_identifiability_citation"><span>Citation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../global_sensitivity_analysis/">Global Sensitivity Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Spatial modelling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../spatial_modelling/lattice_reaction_systems/">Introduction to Spatial Modelling with Catalyst</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_structure_ interaction/">Interfacing with Lattice Problems, Integrators, and Solutions</a></li><li><a class="tocitem" href="../../spatial_modelling/lattice_simulation_plotting/">Plotting Spatial Simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../../spatial_modelling/spatial_jump_simulations/">Spatial Jump Simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/core_api/">Catalyst.jl API</a></li><li><a class="tocitem" href="../../api/network_analysis_api/">Network analysis and representations</a></li></ul></li><li><a class="tocitem" href="../../devdocs/dev_guide/">Developer Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inverse problems</a></li><li class="is-active"><a href>Optimization for Non-data Fitting Purposes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimization for Non-data Fitting Purposes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/inverse_problems/behaviour_optimisation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="behaviour_optimisation"><a class="docs-heading-anchor" href="#behaviour_optimisation">Optimization for Non-data Fitting Purposes</a><a id="behaviour_optimisation-1"></a><a class="docs-heading-anchor-permalink" href="#behaviour_optimisation" title="Permalink"></a></h1><p>In previous tutorials we have described how to use <a href="https://github.com/sebapersson/PEtab.jl">PEtab.jl</a> and <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting">Optimization.jl</a> for parameter fitting. This involves solving an optimisation problem (to find the parameter set yielding the best model-to-data fit). There are, however, other situations that require solving optimisation problems. Typically, these involve the creation of a custom objective function, which minimizer can then be found using Optimization.jl. In this tutorial we will describe this process, demonstrating how parameter space can be searched to find values that achieve a desired system behaviour. Many options used here are described in more detail in <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting">the tutorial on using Optimization.jl for parameter fitting</a>. A more throughout description of how to solve these problems is provided by <a href="https://docs.sciml.ai/Optimization/stable/">Optimization.jl&#39;s documentation</a> and the literature<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><h2 id="behaviour_optimisation_IFFL_example"><a class="docs-heading-anchor" href="#behaviour_optimisation_IFFL_example">Maximising the pulse amplitude of an incoherent feed forward loop</a><a id="behaviour_optimisation_IFFL_example-1"></a><a class="docs-heading-anchor-permalink" href="#behaviour_optimisation_IFFL_example" title="Permalink"></a></h2><p>Incoherent feedforward loops (network motifs where a single component both activates and deactivates a downstream component) are able to generate pulses in response to step inputs<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>. In this tutorial we will consider such an incoherent feedforward loop, attempting to generate a system with as prominent a response pulse as possible.</p><p>Our model consists of 3 species: <span>$X$</span> (the input node), <span>$Y$</span> (an intermediary), and <span>$Z$</span> (the output node). In it, <span>$X$</span> activates the production of both <span>$Y$</span> and <span>$Z$</span>, with <span>$Y$</span> also deactivating <span>$Z$</span>. When <span>$X$</span> is activated, there will be a brief time window where <span>$Y$</span> is still inactive, and <span>$Z$</span> is activated. However, as <span>$Y$</span> becomes active, it will turn <span>$Z$</span> off. This creates a pulse of <span>$Z$</span> activity. To trigger the system, we create <a href="../../model_creation/constraint_equations/#constraint_equations_events">an event</a>, which increases the production rate of <span>$X$</span> (<span>$pX$</span>) by a factor of <span>$10$</span> at time <span>$t = 10$</span>.</p><pre><code class="language-julia hljs">using Catalyst
incoherent_feed_forward = @reaction_network begin
    @discrete_events [10.0] =&gt; [pX ~ 10*pX]
    pX, 0 --&gt; X
    pY*X, 0 --&gt; Y
    pZ*X/Y, 0 --&gt; Z
    1.0, (X,Y,Z) --&gt; 0
end</code></pre><p class="math-container">\[ \begin{align*}
\varnothing &amp;\xrightarrow{\mathtt{pX}} \mathrm{X} \\
\varnothing &amp;\xrightarrow{X \mathtt{pY}} \mathrm{Y} \\
\varnothing &amp;\xrightarrow{\frac{X \mathtt{pZ}}{Y}} \mathrm{Z} \\
\mathrm{X} &amp;\xrightarrow{1.0} \varnothing \\
\mathrm{Y} &amp;\xrightarrow{1.0} \varnothing \\
\mathrm{Z} &amp;\xrightarrow{1.0} \varnothing  
 \end{align*}
 \]</p><p>To demonstrate this pulsing behaviour we will simulate the system for an example parameter set. We select an initial condition (<code>u0</code>) so the system begins in a steady state.</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault, Plots
example_p = [:pX =&gt; 0.1, :pY =&gt; 1.0, :pZ =&gt; 1.0]
tspan = (0.0, 50.0)
example_u0 = [:X =&gt; 0.1, :Y =&gt; 0.1, :Z =&gt; 1.0]

oprob = ODEProblem(incoherent_feed_forward, example_u0, tspan, example_p)
sol = solve(oprob)
plot(sol)</code></pre><img src="e992599a.svg" alt="Example block output"/><p>Here we note that, while <span>$X$</span> and <span>$Y$</span> reach new steady state levels in response to the increase in <span>$pX$</span>, <span>$Z$</span> resumes to its initial concentration after the pulse.</p><p>We will now attempt to find the parameter set <span>$(pX,pY,pZ)$</span> which maximises the response pulse amplitude (defined by the maximum activity of <span>$Z$</span> subtracted by its steady state activity). To do this, we create a custom objective function:</p><pre><code class="language-julia hljs">function pulse_amplitude(p, _)
    p = Dict([:pX =&gt; p[1], :pY =&gt; p[2], :pZ =&gt; p[2]])
    u0 = [:X =&gt; p[:pX], :Y =&gt; p[:pX]*p[:pY], :Z =&gt; p[:pZ]/p[:pY]^2]
    oprob_local = remake(oprob; u0, p)
    sol = solve(oprob_local; verbose = false, maxiters = 10000)
    SciMLBase.successful_retcode(sol) || return Inf
    return -(maximum(sol[:Z]) - sol[:Z][1])
end</code></pre><p>This objective function takes two arguments (a parameter value <code>p</code>, and an additional one which we will ignore but is discussed in a note <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_basics">here</a>). It first calculates the new initial steady state concentration for the given parameter set. Next, it creates an updated <code>ODEProblem</code> using the steady state as initial conditions and the, to the objective function provided, input parameter set.  Finally, Optimization.jl finds the function&#39;s <em>minimum value</em>, so to find the <em>maximum</em> relative pulse amplitude, we make our objective function return the negative pulse amplitude.</p><p>As described <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_basics">in our tutorial on parameter fitting using Optimization.jl</a> we use <code>remake</code>, <code>verbose = false</code>, <code>maxiters = 10000</code>, and a check on the simulations return code, all providing various advantages to the optimisation procedure (as explained in that tutorial).</p><p>Just like for <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_basics">parameter fitting</a>, we create an <code>OptimizationProblem</code> using our objective function, and some initial guess of the parameter values. We also <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_constraints">set upper and lower bounds</a> for each parameter using the <code>lb</code> and <code>ub</code> optional arguments (in this case limiting each parameter&#39;s value to the interval <span>$(0.1,10.0)$</span>).</p><pre><code class="language-julia hljs">using Optimization
initial_guess = [1.0, 1.0, 1.0]
opt_prob = OptimizationProblem(pulse_amplitude, initial_guess; lb = [1e-1, 1e-1, 1e-1], ub = [1e1, 1e1, 1e1])</code></pre><div class="admonition is-info" id="Note-20ecbc8bd1bb450e"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-20ecbc8bd1bb450e" title="Permalink"></a></header><div class="admonition-body"><p>As described in a <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting">previous section on Optimization.jl</a>, <code>OptimizationProblem</code>s do not support setting parameter values using maps. We must instead set <code>initial_guess</code> values using a vector. Next, in the first line of our objective function, we reshape the parameter values to the common form used across Catalyst (e.g. <code>[:pX =&gt; p[1], :pY =&gt; p[2], :pZ =&gt; p[2]]</code>, however, here we use a dictionary to easier compute the steady state initial condition). We also note that the order used in this array corresponds to the order we give each parameter&#39;s bounds in <code>lb</code> and <code>ub</code>, and the order in which their values occur in the output solution.</p></div></div><p>As <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting">previously described</a>, Optimization.jl supports a wide range of optimisation algorithms. Here we use one from <a href="https://github.com/robertfeldt/BlackBoxOptim.jl">BlackBoxOptim.jl</a>:</p><pre><code class="language-julia hljs">using OptimizationBBO
opt_sol = solve(opt_prob, BBO_adaptive_de_rand_1_bin_radiuslimited())</code></pre><p>Finally, we plot a simulation using the found parameter set (stored in <code>opt_sol.u</code>):</p><pre><code class="language-julia hljs">ps_res = Dict([:pX =&gt; opt_sol.u[1], :pY =&gt; opt_sol.u[2], :pZ =&gt; opt_sol.u[2]])
u0_res = [:X =&gt; ps_res[:pX], :Y =&gt; ps_res[:pX]*ps_res[:pY], :Z =&gt; ps_res[:pZ]/ps_res[:pY]^2]
oprob_res = remake(oprob; u0 = u0_res, p = ps_res)
sol_res = solve(oprob_res)
plot(sol_res; idxs = :Z)</code></pre><img src="24b980d1.svg" alt="Example block output"/><p>For this model, it turns out that <span>$Z$</span>&#39;s maximum pulse amplitude is equal to twice its steady state concentration. Hence, the maximisation of its pulse amplitude is equivalent to maximising its steady state concentration.</p><h2 id="behaviour_optimisation_options"><a class="docs-heading-anchor" href="#behaviour_optimisation_options">Other optimisation options</a><a id="behaviour_optimisation_options-1"></a><a class="docs-heading-anchor-permalink" href="#behaviour_optimisation_options" title="Permalink"></a></h2><p>How to use Optimization.jl is discussed in more detail in <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting">this tutorial</a>. This includes options such as using <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_AD">automatic differentiation</a>, <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_constraints">setting constraints</a>, and setting <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_solver_options">optimisation solver options</a>. Finally, it discusses the advantages of <a href="../optimization_ode_param_fitting/#optimization_parameter_fitting_log_scale">carrying out the fitting in logarithmic space</a>, something which can be advantageous for the problem described above as well.</p><hr/><h2 id="structural_identifiability_citation"><a class="docs-heading-anchor" href="#structural_identifiability_citation">Citation</a><a id="structural_identifiability_citation-1"></a><a class="docs-heading-anchor-permalink" href="#structural_identifiability_citation" title="Permalink"></a></h2><p>If you use this functionality in your research, please cite the following paper to support the authors of the Optimization.jl package:</p><pre><code class="nohighlight hljs">@software{vaibhav_kumar_dixit_2023_7738525,
	author = {Vaibhav Kumar Dixit and Christopher Rackauckas},
	month = mar,
	publisher = {Zenodo},
	title = {Optimization.jl: A Unified Optimization Package},
	version = {v3.12.1},
	doi = {10.5281/zenodo.7738525},
  	url = {https://doi.org/10.5281/zenodo.7738525},
	year = 2023
}</code></pre><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://algorithmsbook.com/optimization/files/optimization.pdf">Mykel J. Kochenderfer, Tim A. Wheeler <em>Algorithms for Optimization</em>, The MIT Press (2019).</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2896310/">Lea Goentoro, Oren Shoval, Marc W Kirschner, Uri Alon <em>The incoherent feedforward loop can provide fold-change detection in gene regulation</em>, Molecular Cell (2009).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../optimization_ode_param_fitting/">« Parameter Fitting for ODEs using Optimization.jl</a><a class="docs-footer-nextpage" href="../structural_identifiability/">Structural Identifiability Analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 29 July 2025 10:16">Tuesday 29 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
