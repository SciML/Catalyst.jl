<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Programmatic, generative, modelling of a linear pathway · Catalyst.jl</title><meta name="title" content="Programmatic, generative, modelling of a linear pathway · Catalyst.jl"/><meta property="og:title" content="Programmatic, generative, modelling of a linear pathway · Catalyst.jl"/><meta property="twitter:title" content="Programmatic, generative, modelling of a linear pathway · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/model_creation/examples/programmatic_generative_linear_pathway/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/model_creation/examples/programmatic_generative_linear_pathway/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/model_creation/examples/programmatic_generative_linear_pathway/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../../dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-11" type="checkbox" checked/><label class="tocitem" for="menuitem-3-11"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li class="is-active"><a class="tocitem" href>Programmatic, generative, modelling of a linear pathway</a><ul class="internal"><li><a class="tocitem" href="#programmatic_generative_linear_pathway_intro"><span>Linear pathways</span></a></li><li><a class="tocitem" href="#programmatic_generative_linear_pathway_dsl"><span>Modelling linear pathways using the DSL</span></a></li><li><a class="tocitem" href="#programmatic_generative_linear_pathway_generative"><span>Modelling linear pathways using programmatic, generative, modelling</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../../steady_state_functionality/dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Creation and Properties</a></li><li><a class="is-disabled">Model creation examples</a></li><li class="is-active"><a href>Programmatic, generative, modelling of a linear pathway</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Programmatic, generative, modelling of a linear pathway</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/model_creation/examples/programmatic_generative_linear_pathway.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="programmatic_generative_linear_pathway"><a class="docs-heading-anchor" href="#programmatic_generative_linear_pathway">Programmatic, generative, modelling of a linear pathway</a><a id="programmatic_generative_linear_pathway-1"></a><a class="docs-heading-anchor-permalink" href="#programmatic_generative_linear_pathway" title="Permalink"></a></h1><p>This example will show how to use programmatic, generative, modelling to model a system implicitly. I.e. rather than listing all system reactions explicitly, the reactions are implicitly generated from a simple set of rules. This example is specifically designed to show how <a href="../../programmatic_CRN_construction/#programmatic_CRN_construction">programmatic modelling</a> enables <em>generative workflows</em> (demonstrating one of its advantages as compared to <a href="../../dsl_basics/#dsl_description">DSL-based modelling</a>). In our example, we will model linear pathways, so we will first introduce these. Next, we will model them first using the DSL, and then using a generative programmatic workflow.</p><h2 id="programmatic_generative_linear_pathway_intro"><a class="docs-heading-anchor" href="#programmatic_generative_linear_pathway_intro">Linear pathways</a><a id="programmatic_generative_linear_pathway_intro-1"></a><a class="docs-heading-anchor-permalink" href="#programmatic_generative_linear_pathway_intro" title="Permalink"></a></h2><p>Linear pathways consists of a series of species (<span>$X_0$</span>, <span>$X_1$</span>, <span>$X_2$</span>, ..., <span>$X_n$</span>) where each activates the subsequent one<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. These are often modelled through the following reaction system:</p><p class="math-container">\[X_{i-1}/\tau,\hspace{0.33cm} ∅ \to X_{i}\\
1/\tau,\hspace{0.33cm} X_{i} \to ∅\]</p><p>for <span>$i = 1, ..., n$</span>, where the activation of <span>$X_1$</span> depends on some input species <span>$X_0$</span>. </p><p>A common use of these linear pathways is the implementation of <em>time delays</em>. Consider a species <span>$X(t)$</span> which is activated by species <span>$X_0(t)$</span>. This can be modelled by making the production rate of <span>$X(t)$</span> a function of the <em>time-delayed</em> value of <span>$X_0(t)$</span>:</p><p class="math-container">\[f(X_0(t-\tau)),\hspace{0.33cm} ∅ \to X\]</p><p>This is a so-called <em>discrete-delay</em> (which will generate a <em>delay differential equation</em>). However, in reality, <span>$X(t)$</span> probably does not depend on only <span>$f(X_0(t-\tau))$</span>, but rather <em>a distribution of previous <span>$X_0(t)$</span> values</em>. This can be modelled through a <em>distributed delay</em>s</p><p class="math-container">\[f(\int_{0}^{\inf} X_0(t-\tau)g(\tau) d\tau),\hspace{0.33cm} ∅ \to X\]</p><p>for some kernel <span>$g(\tau)$</span>. Here, a common kernel is a <a href="https://en.wikipedia.org/wiki/Gamma_distribution">gamma distribution</a>, which generates a gamma-distributed delay:</p><p class="math-container">\[g(\tau; \alpha, \beta) = \frac{\beta^{\alpha}\tau^{\alpha-1}}{\Gamma(\alpha)}e^{-\beta\tau}\]</p><p>When this is converted to an ODE, this generates an integro-differential equation. These (as well as the simpler delay differential equations) can be difficult to solve and analyse (especially when SDE or jump simulations are desired). Here, <em>the linear chain trick</em> can be used to instead model the delay as a linear pathway of the form described above<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>. A result by Fargue shows that this is equivalent to a gamma-distributed delay, where <span>$\alpha$</span> is equivalent to <span>$n$</span> (the number of species in our linear pathway) and <span>$\beta$</span> to %\tau$ (the delay length term)<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>. While modelling time delays using the linear chain trick introduces additional system species, it is often advantageous as it enables simulations using standard ODE, SDE, and Jump methods.</p><h2 id="programmatic_generative_linear_pathway_dsl"><a class="docs-heading-anchor" href="#programmatic_generative_linear_pathway_dsl">Modelling linear pathways using the DSL</a><a id="programmatic_generative_linear_pathway_dsl-1"></a><a class="docs-heading-anchor-permalink" href="#programmatic_generative_linear_pathway_dsl" title="Permalink"></a></h2><p>It is known that two linear pathways have similar delays if the following equality holds:</p><p class="math-container">\[\frac{1}{\tau_1 n_1} = \frac{1}{\tau_2 n_2}\]</p><p>However, the shape of the delay depends on the number of intermediaries (<span>$n$</span>). Here we wish to investigate this shape for two choices of <span>$n$</span> (<span>$n = 3$</span> and <span>$n = 10$</span>). We do so by implementing two models using the DSL, one for each <span>$n$</span>. </p><pre><code class="language-julia hljs">using Catalyst

lp_n3 = @reaction_network begin
    1/τ, X0 --&gt; 0
    (X0/τ, 1/τ), 0 &lt;--&gt; X1
    (X1/τ, 1/τ), 0 &lt;--&gt; X2
    (X2/τ, 1/τ), 0 &lt;--&gt; X3
end

lp_n10 = @reaction_network begin
    1/τ, X0 --&gt; 0
    (X0/τ, 1/τ), 0 &lt;--&gt; X1
    (X1/τ, 1/τ), 0 &lt;--&gt; X2
    (X2/τ, 1/τ), 0 &lt;--&gt; X3
    (X3/τ, 1/τ), 0 &lt;--&gt; X4
    (X4/τ, 1/τ), 0 &lt;--&gt; X5
    (X5/τ, 1/τ), 0 &lt;--&gt; X6
    (X6/τ, 1/τ), 0 &lt;--&gt; X7
    (X7/τ, 1/τ), 0 &lt;--&gt; X8
    (X8/τ, 1/τ), 0 &lt;--&gt; X9
    (X9/τ, 1/τ), 0 &lt;--&gt; X10
end</code></pre><p>Next, we prepare an ODE for each model (scaling the initial concentration of <span>$X_0$</span> and the value of <span>$\tau$</span> appropriately for each model).</p><pre><code class="language-julia hljs">using OrdinaryDiffEq, Plots
u0_n3 = [:X0 =&gt; 3*1.0, :X1 =&gt; 0.0, :X2 =&gt; 0.0, :X3 =&gt; 0.0]
ps_n3 = [:τ =&gt; 1.0/3]
oprob_n3 = ODEProblem(lp_n3, u0_n3, (0.0, 5.0), ps_n3)

u0_n10 = [:X0 =&gt; 10*1.0, :X1 =&gt; 0.0, :X2 =&gt; 0.0, :X3 =&gt; 0.0, :X4 =&gt; 0.0, :X5 =&gt; 0.0, :X6 =&gt; 0.0, :X7 =&gt; 0.0, :X8 =&gt; 0.0, :X9 =&gt; 0.0, :X10 =&gt; 0.0]
ps_n10 = [:τ =&gt; 1.0/10.0]
oprob_n10 = ODEProblem(lp_n10, u0_n10, (0.0, 5.0), ps_n10)</code></pre><p>Finally, we plot the concentration of the final species in each linear pathway, noting that while the two pulses both peak at <span>$t = 1.0$</span>, their shapes depend on <span>$n$</span>.</p><pre><code class="language-julia hljs">sol_n3 = solve(oprob_n3)
sol_n10 = solve(oprob_n10)
plot(sol_n3; idxs = :X3, label = &quot;n = 3&quot;)
plot!(sol_n10; idxs = :X10, label = &quot;n = 10&quot;)</code></pre><img src="24861653.svg" alt="Example block output"/><h2 id="programmatic_generative_linear_pathway_generative"><a class="docs-heading-anchor" href="#programmatic_generative_linear_pathway_generative">Modelling linear pathways using programmatic, generative, modelling</a><a id="programmatic_generative_linear_pathway_generative-1"></a><a class="docs-heading-anchor-permalink" href="#programmatic_generative_linear_pathway_generative" title="Permalink"></a></h2><p>Above, we investigated the impact of linear pathways&#39; lengths on their behaviours. Since the models were implemented using the DSL, we had to implement a new model for each pathway (in each case writing out all reactions). Here, we will instead show how <a href="../../programmatic_CRN_construction/#programmatic_CRN_construction">programmatic modelling</a> can be used to generate pathways of arbitrary lengths.</p><p>First, we create a function, <code>generate_lp</code>, which creates a linear pathway model of length <code>n</code>. It utilises <em>vector variables</em> to create an arbitrary number of species, and also creates an observable for the final species of the chain.</p><pre><code class="language-julia hljs">t = default_t()
@parameters τ
function generate_lp(n)
    # Creates a vector `X` with n+1 species.
    @species X(t)[1:n+1]
    @species Xend(t)

    # Generate
    #     (1) A degradation reaction for the input species.
    #     (2) Production reactions for all intermediary species.
    #     (2) Degradation reactions for all intermediary species.
    rxs = [
        Reaction(1/τ, [X[1]], []);
        [Reaction(X[i]/τ, [], [X[i+1]]) for i in 1:n];
        [Reaction(1/τ, [X[i+1]], []) for i in 1:n]
    ]

    # Assembly and return a complete `ReactionSystem` (including an observable for the final species).
    @named lp_n = ReactionSystem(rxs, t; observed = [Xend ~ X[end]])
    return complete(lp_n)
end</code></pre><p>Next, we create a function that generates an <code>ODEProblem</code> (with appropriate initial conditions and parameter values) for arbitrarily lengthed linear pathway models.</p><pre><code class="language-julia hljs">function generate_oprob(n)
    lp = generate_lp(n)
    X_init = fill(0.0, n + 1)
    X_init[1] = n * 1.0
    u0 = [lp.X =&gt; X_init]
    ps = [τ =&gt; 1.0 / n]
    return ODEProblem(lp, u0, (0.0, 5.0), ps)
end</code></pre><p>We can now simulate linear pathways of arbitrary lengths using a simple syntax. We use this to recreate our previous result from the DSL:</p><pre><code class="language-julia hljs">sol_n3 = solve(generate_oprob(3))
sol_n10 = solve(generate_oprob(10))
plot(sol_n3; idxs = :Xend, label = &quot;n = 3&quot;)
plot!(sol_n10; idxs = :Xend, label = &quot;n = 10&quot;)</code></pre><img src="a5b7917e.svg" alt="Example block output"/><p>If we wish to investigate the behaviour of a pathway with a different length, we can easily add this to the plot</p><pre><code class="language-julia hljs">sol_n20 = solve(generate_oprob(20))
plot!(sol_n20; idxs = :Xend, label = &quot;n = 20&quot;)</code></pre><img src="8a83d386.svg" alt="Example block output"/><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007982">N. Korsbo, H. Jönsson <em>It’s about time: Analysing simplifying assumptions for modelling multi-step pathways in systems biology</em>, PLoS Computational Biology (2020).</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://ir.cwi.nl/pub/1559/1559D.pdf">J. Metz, O. Diekmann <em>The Abstract Foundations of Linear Chain Trickery</em> (1991).</a></li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>D. Fargue <em>Reductibilite des systemes hereditaires a des systemes dynamiques (regis par des equations differentielles aux derivees partielles)</em>, Comptes rendus de l&#39;Académie des Sciences (1973).</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../basic_CRN_library/">« Library of Basic Chemical Reaction Network Models</a><a class="docs-footer-nextpage" href="../hodgkin_huxley_equation/">Hodgkin-Huxley Equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 11 June 2024 14:46">Tuesday 11 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
